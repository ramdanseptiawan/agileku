(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4409:(e,s,t)=>{Promise.resolve().then(t.bind(t,34574))},34574:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>sz});var a=t(95155),r=t(12115),l=t(9465),n=t(71007),i=t(32919),o=t(78749),d=t(92657);let c=e=>{let{size:s="medium",showPoweredBy:t=!0,className:r=""}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-3 ".concat(r),children:[(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsx)("img",{src:"/mindshift.png",alt:"Mindshift Learning",className:"".concat({small:"h-8",medium:"h-12",large:"h-16"}[s]," w-auto object-contain")})}),t&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 opacity-75",children:[(0,a.jsx)("span",{className:"text-gray-600 ".concat("small"===s?"text-xs":"text-sm")}),(0,a.jsx)("span",{className:"font-semibold text-gray-700 ".concat("small"===s?"text-xs":"text-sm")})]})]})},m=()=>{let[e,s]=(0,r.useState)(""),[t,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(""),[p,b]=(0,r.useState)(!1),{login:j}=(0,l.A)(),f=async s=>{s.preventDefault(),h(""),b(!0);try{let s=await j(e,t);s.success||h(s.error)}catch(e){h("Terjadi kesalahan saat login")}finally{b(!1)}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"max-w-md w-full space-y-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(c,{size:"medium",className:"mb-6"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Sign in to your learning platform"})]}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[g&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:g}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(n.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"username",type:"text",value:e,onChange:e=>s(e.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 text-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your username",required:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(i.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"password",type:x?"text":"password",value:t,onChange:e=>m(e.target.value),className:"block w-full pl-10 pr-12 py-3 border border-gray-300 text-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your password",required:!0}),(0,a.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!x),children:x?(0,a.jsx)(o.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign In"})]}),(0,a.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 opacity-75",children:[(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Powered by"}),(0,a.jsx)("img",{src:"/shinka.png",alt:"Shinka",className:"h-12 w-auto object-contain rounded px-1 py-0.5"})]})})]})})})};var x=t(54416),u=t(74783),g=t(23861),h=t(85339),p=t(81284),b=t(40646),j=t(13062),f=t(14186),y=t(39360);let N=e=>{let{announcements:s,readAnnouncements:t,markAsRead:r,formatDate:l,getPriorityIcon:i,getPriorityColor:o,getPriorityText:d,getAudienceText:c}=e;return 0===s.length?(0,a.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,a.jsx)(g.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{className:"text-lg",children:"Belum ada pengumuman"}),(0,a.jsx)("p",{className:"text-sm",children:"Pengumuman terbaru akan muncul di sini"})]}):(0,a.jsx)("div",{className:"space-y-6",children:s.map(e=>{let s=t.has(e.id);return(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer transform hover:-translate-y-1 ".concat(s?"opacity-75":"border-l-4"," ").concat(s||"high"!==e.priority?s||"medium"!==e.priority?s?"":"border-l-blue-500":"border-l-yellow-500":"border-l-red-500"),onClick:()=>!s&&r(e.id),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full ".concat("high"===e.priority?"bg-red-100":"medium"===e.priority?"bg-yellow-100":"bg-blue-100"),children:i(e.priority)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold ".concat(s?"text-gray-600":"text-gray-800"),children:e.title}),!s&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white text-xs px-3 py-1 rounded-full font-semibold",children:"✨ Baru"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-semibold ".concat("high"===e.priority?"text-red-700 bg-red-100 border border-red-200":"medium"===e.priority?"text-yellow-700 bg-yellow-100 border border-yellow-200":"text-blue-700 bg-blue-100 border border-blue-200"),children:d(e.priority)}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-semibold bg-gray-100 text-gray-700 border border-gray-200",children:c(e.target_audience||e.targetAudience)})]})]}),(0,a.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat(s?"bg-gray-50 text-gray-600":"bg-blue-50 text-gray-800"),children:(0,a.jsx)("p",{className:"whitespace-pre-wrap leading-relaxed text-base",children:e.content})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.A,{size:16,className:"text-blue-500"}),(0,a.jsx)("span",{className:"font-medium",children:e.author||"Admin"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.A,{size:16,className:"text-green-500"}),(0,a.jsx)("span",{children:l(e.created_at||e.createdAt)})]})]}),(e.updated_at||e.updatedAt)!==(e.created_at||e.createdAt)&&(0,a.jsxs)("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:["Diperbarui: ",l(e.updated_at||e.updatedAt)]})]})]})},e.id)})})},v=e=>{let{isModal:s=!1,onClose:t}=e,[n,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(new Set),{currentUser:m}=(0,l.A)(),u=(0,r.useCallback)(async()=>{try{let e=await y.Ay.announcement.getUserAnnouncements();if(e.success){let s=(e.announcements||[]).sort((e,s)=>{let t=new Date(e.created_at||e.createdAt);return new Date(s.created_at||s.createdAt)-t});i(s)}else console.error("Failed to load announcements:",e.message),i([])}catch(e){console.error("Error loading announcements:",e),i([])}},[]),g=(0,r.useCallback)(()=>{let e=(null==m?void 0:m.id)||"guest",s=localStorage.getItem("readAnnouncements_".concat(e));s&&c(new Set(JSON.parse(s)))},[null==m?void 0:m.id]);(0,r.useEffect)(()=>{u(),g()},[u,g]);let f=e=>{let s=(null==m?void 0:m.id)||"guest",t=new Set([...o,e]);c(t),localStorage.setItem("readAnnouncements_".concat(s),JSON.stringify([...t]))},v=()=>{let e=(null==m?void 0:m.id)||"guest",s=n.map(e=>e.id);c(new Set(s)),localStorage.setItem("readAnnouncements_".concat(e),JSON.stringify(s))},w=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=e=>{switch(e){case"high":return(0,a.jsx)(h.A,{size:16,className:"text-red-500"});case"medium":return(0,a.jsx)(p.A,{size:16,className:"text-yellow-500"});default:return(0,a.jsx)(b.A,{size:16,className:"text-blue-500"})}},A=e=>{switch(e){case"high":return"border-l-red-500 bg-red-50";case"medium":return"border-l-yellow-500 bg-yellow-50";default:return"border-l-blue-500 bg-blue-50"}},S=e=>{switch(e){case"high":return"Tinggi";case"medium":return"Sedang";default:return"Normal"}},C=e=>{switch(e){case"users":return"Pengguna";case"admins":return"Admin";default:return"Semua"}},D=n.filter(e=>!o.has(e.id)).length;return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden shadow-2xl",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-opacity-20 p-3 rounded-full",children:(0,a.jsx)(j.A,{className:"text-white",size:28})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Pusat Pengumuman"}),(0,a.jsx)("p",{className:"text-blue-100 text-sm",children:"Informasi terbaru untuk Anda"})]}),D>0&&(0,a.jsxs)("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),(0,a.jsxs)("span",{className:"font-semibold",children:[D," baru"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[D>0&&(0,a.jsxs)("button",{onClick:v,className:"bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2",children:[(0,a.jsx)(d.A,{size:16}),"Tandai Semua Dibaca"]}),(0,a.jsx)("button",{onClick:t,className:"bg-opacity-20 hover:bg-opacity-30 p-2 rounded-lg transition-all duration-200",children:(0,a.jsx)(x.A,{size:20})})]})]})}),(0,a.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(95vh-140px)] bg-gray-50",children:(0,a.jsx)(N,{announcements:n,readAnnouncements:o,markAsRead:f,formatDate:w,getPriorityIcon:k,getPriorityColor:A,getPriorityText:S,getAudienceText:C})})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-6",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-opacity-20 p-4 rounded-full",children:(0,a.jsx)(j.A,{className:"text-white",size:32})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Pusat Pengumuman"}),(0,a.jsx)("p",{className:"text-blue-100 text-lg",children:"Informasi terbaru dan penting untuk Anda"})]}),D>0&&(0,a.jsxs)("div",{className:"bg-red-500 text-white px-4 py-2 rounded-full flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-white rounded-full animate-pulse"}),(0,a.jsxs)("span",{className:"font-semibold text-lg",children:[D," baru"]})]})]}),D>0&&(0,a.jsxs)("button",{onClick:v,className:"bg-opacity-20 hover:bg-opacity-30 text-white px-6 py-3 rounded-lg transition-all duration-200 flex items-center gap-2 font-semibold",children:[(0,a.jsx)(d.A,{size:20}),"Tandai Semua Dibaca"]})]})}),(0,a.jsx)("div",{className:"p-8 bg-gray-50",children:(0,a.jsx)(N,{announcements:n,readAnnouncements:o,markAsRead:f,formatDate:w,getPriorityIcon:k,getPriorityColor:A,getPriorityText:S,getAudienceText:C})})]})})})},w=e=>{let{onClick:s}=e,[t,n]=(0,r.useState)(0),[i,o]=(0,r.useState)(!1),{currentUser:d}=(0,l.A)(),c=(0,r.useCallback)(()=>{if(!d)return void n(0);let e=localStorage.getItem("announcements");if(!e)return void n(0);let s=JSON.parse(e).filter(e=>"all"===e.targetAudience||"students"===e.targetAudience&&(null==d?void 0:d.role)==="user"||"instructors"===e.targetAudience&&(null==d?void 0:d.role)==="admin"),t=d.id||"guest",a=localStorage.getItem("readAnnouncements_".concat(t)),r=a?new Set(JSON.parse(a)):new Set;n(s.filter(e=>!r.has(e.id)).length)},[null==d?void 0:d.id,null==d?void 0:d.role]);return(0,r.useEffect)(()=>{c();let e=()=>{c()};window.addEventListener("storage",e);let s=setInterval(c,3e4);return()=>{window.removeEventListener("storage",e),clearInterval(s)}},[c]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{s?s():o(!0)},className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Pengumuman",children:[(0,a.jsx)(g.A,{size:20}),t>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:t>99?"99+":t})]}),i&&(0,a.jsx)(v,{isModal:!0,onClose:()=>{o(!1),setTimeout(c,100)}})]})},k=e=>{let{isSidebarOpen:s,setIsSidebarOpen:t}=e;return(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 lg:hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Modern LMS"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w,{}),(0,a.jsx)("button",{onClick:()=>t(!s),className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors",children:s?(0,a.jsx)(x.A,{size:24}):(0,a.jsx)(u.A,{size:24})})]})]})})};var A=t(57340),S=t(5040),C=t(72713),D=t(59947),P=t(81497),z=t(75525),I=t(69037),T=t(57434),M=t(381),E=t(13717),L=t(92749),F=t(17580),U=t(87949),R=t(34835);let q=e=>{var s;let{currentView:t,setCurrentView:r,isSidebarOpen:i,setIsSidebarOpen:o,userRole:d,onAnnouncementClick:c}=e,{currentUser:m,logout:h}=(0,l.A)(),p=[{id:"dashboard",label:"Home",icon:A.A,badge:null},{id:"courses",label:"Courses",icon:S.A,badge:null},{id:"profile",label:"Profile",icon:n.A,badge:null},{id:"menu",label:"Menu",icon:u.A,badge:null}],b=(()=>{let e=[{id:"profile",label:"Profile",icon:n.A,badge:null}];return"admin"===d?[{id:"overview",label:"Overview",icon:C.A,badge:null},{id:"courses",label:"Courses",icon:S.A,badge:null},{id:"quizzes",label:"Quiz Manager",icon:D.A,badge:null},{id:"surveys",label:"Survey Manager",icon:P.A,badge:null},{id:"stage-management",label:"Stage Management",icon:z.A,badge:null},{id:"announcements",label:"Announcements",icon:g.A,badge:null},{id:"certificates",label:"Certificates",icon:I.A,badge:null},{id:"project-instructions",label:"Project Instructions",icon:T.A,badge:null},{id:"course-instructions",label:"Course Instructions",icon:M.A,badge:null},{id:"course-config",label:"Course Configuration",icon:E.A,badge:null},{id:"users",label:"User Management",icon:L.A,badge:null},{id:"test-results",label:"Test Results",icon:C.A,badge:null},{id:"students",label:"Students",icon:F.A,badge:null},...e]:[{id:"dashboard",label:"Dashboard",icon:A.A,badge:null},{id:"courses",label:"My Courses",icon:S.A,badge:null},{id:"announcements",label:"Announcements",icon:g.A,badge:null},{id:"achievements",label:"Achievements",icon:I.A,badge:null},...e]})(),j=e=>{if(console.log("Sidebar: Menu clicked, viewId =",e),"menu"===e)return void o(!0);console.log("Sidebar: Setting currentView to",e),r(e),window.innerWidth<1024&&o(!1)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 lg:hidden",children:(0,a.jsx)("div",{className:"flex items-center justify-around py-1",children:p.map(e=>{let s=e.icon,r=t===e.id;return(0,a.jsxs)("button",{onClick:()=>j(e.id),className:"flex flex-col items-center justify-center p-3 min-w-0 flex-1 relative touch-manipulation transition-colors ".concat(r?"text-blue-600":"text-gray-500"),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(s,{size:22,className:"transition-all duration-200 ".concat(r?"text-blue-600 scale-110":"text-gray-500")}),e.badge&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center font-medium",children:e.badge})]}),(0,a.jsx)("span",{className:"text-xs mt-1 font-medium truncate transition-colors ".concat(r?"text-blue-600":"text-gray-500"),children:e.label})]},e.id)})})}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden backdrop-blur-sm",onClick:()=>o(!1)}),(0,a.jsxs)("div",{className:"\n        fixed left-0 top-0 min-h-screen w-72 bg-white border-r border-gray-200 shadow-lg z-50 transform transition-all duration-300 ease-in-out\n        lg:relative lg:translate-x-0 lg:z-10 lg:flex-shrink-0 lg:min-h-screen\n        ".concat(i?"translate-x-0":"-translate-x-full lg:translate-x-0","\n      "),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(U.A,{className:"text-white",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"Modern LMS"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Learning Platform"})]})]}),(0,a.jsx)("button",{onClick:()=>o(!1),className:"p-2 rounded-lg text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition-colors lg:hidden touch-manipulation",children:(0,a.jsx)(x.A,{size:20})})]}),(0,a.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-semibold text-base",children:(null==m||null==(s=m.username)?void 0:s.charAt(0).toUpperCase())||"U"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-gray-900 font-semibold text-sm",children:(null==m?void 0:m.username)||"User"}),(0,a.jsx)("p",{className:"text-gray-500 text-xs capitalize",children:d||"Student"})]}),(0,a.jsx)(w,{onClick:()=>{c&&c()}})]})}),(0,a.jsx)("nav",{className:"flex-1 p-4 overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-1",children:b.map(e=>{let s=e.icon,r=t===e.id;return(0,a.jsxs)("button",{onClick:()=>j(e.id),className:"w-full flex items-center justify-between px-4 py-3 rounded-lg transition-all duration-200 group touch-manipulation ".concat(r?"bg-blue-50 text-blue-600 border border-blue-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(s,{size:20,className:"transition-all duration-200 ".concat(r?"text-blue-600":"text-gray-500 group-hover:text-gray-700")}),(0,a.jsx)("span",{className:"font-medium text-sm ".concat(r?"text-blue-600":"text-gray-700"),children:e.label})]}),e.badge&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full font-medium ".concat(r?"bg-blue-100 text-blue-600":"bg-red-500 text-white"),children:e.badge})]},e.id)})})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-100",children:(0,a.jsxs)("button",{onClick:()=>{h(),o(!1)},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors touch-manipulation",children:[(0,a.jsx)(R.A,{size:20}),(0,a.jsx)("span",{className:"font-medium text-sm",children:"Logout"})]})})]})]})};var _=t(92138),O=t(66766);let B=e=>{var s;let{course:t,onStartLearning:n}=e,{currentUser:i,enrollInCourse:o,isEnrolledInCourse:d,getUserProgressSync:c,refreshUserProgress:m}=(0,l.A)(),[x,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(null),p=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={intro:15,pretest:10,lessons:50,posttest:15,postwork:10,finalproject:10};s&&s.stepWeights&&(t={...t,...s.stepWeights});let a=0;return e.forEach(e=>{t[e]&&(a+=t[e])}),Math.min(a,100)},j=!!i&&d(t.id),N=null!==g?g:i?c(t.id):0;(0,r.useEffect)(()=>{(async()=>{if(i&&j)try{let[e,s]=await Promise.all([(0,y.Hb)(t.id),fetch("".concat("https://api.mindshiftlearning.id","/api/public/courses/").concat(t.id)).then(e=>e.json())]);if(e&&e.data){let t={};s&&s.success&&s.data&&(t={hasPostWork:s.data.hasPostWork,hasFinalProject:s.data.hasFinalProject,stepWeights:s.data.stepWeights});let a=[];if(e.data.completedSteps)if(Array.isArray(e.data.completedSteps))a=e.data.completedSteps;else if("string"==typeof e.data.completedSteps)try{a=e.data.completedSteps.startsWith("[")?JSON.parse(e.data.completedSteps):e.data.completedSteps.split(",").map(e=>e.trim()).filter(e=>e)}catch(s){console.error("Failed to parse completedSteps:",s,"Raw data:",e.data.completedSteps),a=e.data.completedSteps.split(",").map(e=>e.trim()).filter(e=>e)}else console.warn("Unexpected completedSteps format:",e.data.completedSteps);let r=p(a,t);h(r)}}catch(e){console.error("Failed to fetch course progress:",e),await m()}})()},[i,j,t.id]);let v=async()=>{if(i)if(j)n(t);else{var e,s;u(!0);try{let s=await o(t.id);s.success?n(t):(console.error("Failed to enroll:",s.error),(null==(e=s.error)?void 0:e.includes("Already enrolled"))?n(t):alert(s.error||"Gagal mendaftar course"))}catch(e){console.error("Failed to enroll:",e),(null==(s=e.message)?void 0:s.includes("Already enrolled"))?n(t):alert("Terjadi kesalahan saat mendaftar course")}finally{u(!1)}}};return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(O.default,{src:t.image,alt:t.title,width:400,height:192,className:"w-full h-48 object-cover"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),(0,a.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-2 line-clamp-2",children:t.title}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm sm:text-base line-clamp-3",children:t.description}),(0,a.jsx)("div",{className:"flex items-center mb-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[(0,a.jsx)(f.A,{size:16}),(0,a.jsxs)("span",{children:[(null==(s=t.lessons)?void 0:s.length)||0," Lessons"]})]})}),i&&j&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-green-600 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.A,{size:16}),(0,a.jsx)("span",{children:"Enrolled"})]}),(0,a.jsxs)("span",{children:[N,"% Complete"]})]}),N>0&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(N,"%")}})})]}),(0,a.jsx)("button",{onClick:v,disabled:x,className:"w-full px-4 py-2 rounded-lg transition-colors flex items-center justify-center space-x-2 text-sm sm:text-base ".concat(!i?"bg-gray-300 text-gray-600 cursor-not-allowed":j?"bg-green-600 text-white hover:bg-green-700":"bg-blue-600 text-white hover:bg-blue-700"," ").concat(x?"opacity-50 cursor-not-allowed":""),children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Enrolling..."})]}):i?j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Continue Learning"}),(0,a.jsx)(_.A,{size:16})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Enroll Now"}),(0,a.jsx)(_.A,{size:16})]}):(0,a.jsx)("span",{children:"Login to Enroll"})})]})]})},W=e=>{let{onStartLearning:s}=e,{courses:t,enrollments:n,currentUser:i}=(0,l.A)(),o=(0,r.useMemo)(()=>{let e=Array.isArray(t)?t:[],s=Array.isArray(n)?n:[];if(!i||!s.length)return{totalCourses:e.length,enrolledCourses:0,completedCourses:0,inProgressCourses:0,averageProgress:0};let a=s.filter(e=>e.progress>=100).length,r=s.filter(e=>e.progress>0&&e.progress<100).length,l=s.reduce((e,s)=>e+(s.progress||0),0),o=s.length>0?Math.round(l/s.length):0;return{totalCourses:e.length,enrolledCourses:s.length,completedCourses:a,inProgressCourses:r,averageProgress:o}},[t,n,i]);return(0,a.jsxs)("div",{className:"space-y-6 sm:space-y-8",children:[(0,a.jsxs)("div",{className:"text-center px-4",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:i?"Welcome back, ".concat(i.full_name||i.username,"!"):"Welcome to Modern LMS"}),(0,a.jsx)("p",{className:"text-lg sm:text-xl text-gray-600 max-w-3xl mx-auto",children:i?"Continue your learning journey and achieve your goals":"Tingkatkan skill programming Anda dengan pembelajaran yang terstruktur"})]}),(0,a.jsxs)("div",{className:"px-4",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-6",children:"Available Courses"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:Array.isArray(t)&&t.length>0?t.map(e=>(0,a.jsx)(B,{course:e,onStartLearning:s},e.id)):(0,a.jsx)("div",{className:"col-span-full text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No courses available at the moment."})})})]}),(0,a.jsx)("div",{className:"px-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-4",children:i?"Your Learning Progress":"Platform Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:i?o.enrolledCourses:o.totalCourses}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:i?"Enrolled Courses":"Available Courses"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:o.completedCourses}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Completed"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-yellow-600",children:o.inProgressCourses}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"In Progress"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-purple-600",children:i?"".concat(o.averageProgress,"%"):o.totalCourses}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:i?"Avg Progress":"Total Courses"})]})]}),i&&o.enrolledCourses>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[(0,a.jsx)("span",{children:"Overall Progress"}),(0,a.jsxs)("span",{children:[o.averageProgress,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-green-500 h-3 rounded-full transition-all duration-500",style:{width:"".concat(o.averageProgress,"%")}})})]})]})})]})};var J=t(84616),G=t(99245),K=t(35169),V=t(62525),Q=t(29869),Y=t(9803),H=t(34869),X=t(4229);let Z=e=>{let{lesson:s,onSave:t,onCancel:l}=e,[n,i]=(0,r.useState)({id:(null==s?void 0:s.id)||Date.now().toString(),title:(null==s?void 0:s.title)||"",type:(null==s?void 0:s.type)||"mixed",content:(null==s?void 0:s.content)||[]}),o=e=>{let s={id:Date.now().toString(),type:e};switch(e){case"text":s.content="";break;case"pdf":s.title="",s.description="",s.filename="",s.embedUrl="",s.downloadUrl="";break;case"video":s.title="",s.description="",s.src="",s.duration="";break;case"external_link":s.title="",s.description="",s.url=""}i(e=>({...e,content:[...e.content,s]}))},d=(e,s,t)=>{let a=[...n.content];a[e]={...a[e],[s]:t},i(e=>({...e,content:a}))},c=e=>{i(s=>({...s,content:s.content.filter((s,t)=>t!==e)}))},m=(e,s)=>{switch(e.type){case"text":return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4 text-gray-900",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.A,{className:"text-purple-600",size:20}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Teks"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>c(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:16})})]}),(0,a.jsx)("textarea",{value:e.content||"",onChange:e=>d(s,"content",e.target.value),placeholder:"Masukkan konten teks (mendukung Markdown)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:6})]});case"pdf":return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(T.A,{className:"text-red-600",size:20}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"PDF Document"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>c(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:16})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>d(s,"title",e.target.value),placeholder:"Judul PDF",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("input",{type:"text",value:e.filename||"",onChange:e=>d(s,"filename",e.target.value),placeholder:"Nama file (contoh: document.pdf)",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsx)("textarea",{value:e.description||"",onChange:e=>d(s,"description",e.target.value),placeholder:"Deskripsi PDF",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-4",rows:2}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,a.jsx)("input",{type:"url",value:e.embedUrl||"",onChange:e=>d(s,"embedUrl",e.target.value),placeholder:"URL untuk embed PDF (opsional)",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("input",{type:"url",value:e.downloadUrl||"",onChange:e=>d(s,"downloadUrl",e.target.value),placeholder:"URL untuk download PDF",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]});case"video":return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Y.A,{className:"text-blue-600",size:20}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Video"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>c(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:16})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>d(s,"title",e.target.value),placeholder:"Judul Video",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("input",{type:"text",value:e.duration||"",onChange:e=>d(s,"duration",e.target.value),placeholder:"Durasi (contoh: 10:30)",className:"p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsx)("textarea",{value:e.description||"",onChange:e=>d(s,"description",e.target.value),placeholder:"Deskripsi Video",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-4",rows:2}),(0,a.jsx)("input",{type:"url",value:e.src||"",onChange:e=>d(s,"src",e.target.value),placeholder:"URL Video (YouTube embed, Vimeo, dll)",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mt-4"})]});case"external_link":return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(H.A,{className:"text-green-600",size:20}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Link Eksternal"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>c(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:16})})]}),(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>d(s,"title",e.target.value),placeholder:"Judul Link",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4"}),(0,a.jsx)("textarea",{value:e.description||"",onChange:e=>d(s,"description",e.target.value),placeholder:"Deskripsi Link",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4",rows:2}),(0,a.jsx)("input",{type:"url",value:e.url||"",onChange:e=>d(s,"url",e.target.value),placeholder:"URL Link Eksternal",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]});default:return null}};return(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6 text-gray-900",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:s?"Edit Lesson":"Tambah Lesson Baru"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(n)},className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Lesson"}),(0,a.jsx)("input",{type:"text",value:n.title,onChange:e=>i(s=>({...s,title:e.target.value})),placeholder:"Masukkan judul lesson",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipe Lesson"}),(0,a.jsxs)("select",{value:n.type,onChange:e=>i(s=>({...s,type:e.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"mixed",children:"Mixed Content (Rekomendasi)"}),(0,a.jsx)("option",{value:"reading",children:"Reading Only"}),(0,a.jsx)("option",{value:"video",children:"Video Only"})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Konten Lesson"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>o("text"),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Teks"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>o("pdf"),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(T.A,{className:"mr-2 h-4 w-4"}),"PDF"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>o("video"),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(Y.A,{className:"mr-2 h-4 w-4"}),"Video"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>o("external_link"),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(H.A,{className:"mr-2 h-4 w-4"}),"Link"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[n.content.map((e,s)=>(0,a.jsx)("div",{children:m(e,s)},e.id||"content-".concat(s))),0===n.content.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Belum ada konten. Klik tombol di atas untuk menambah konten."})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,a.jsxs)("button",{type:"button",onClick:l,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Batal"]}),(0,a.jsxs)("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),"Simpan Lesson"]})]})]})]})})},$="files";class ee{async init(){return new Promise((e,s)=>{let t=indexedDB.open("AgilekuLMS",1);t.onerror=()=>s(t.error),t.onsuccess=()=>{this.db=t.result,e(this.db)},t.onupgradeneeded=e=>{let s=e.target.result;if(!s.objectStoreNames.contains($)){let e=s.createObjectStore($,{keyPath:"id"});e.createIndex("type","type",{unique:!1}),e.createIndex("courseId","courseId",{unique:!1})}}})}async saveFile(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"general";return this.db||await this.init(),new Promise((a,r)=>{let l=new FileReader;l.onload=()=>{let n={id:"".concat(s,"_").concat(t,"_").concat(Date.now(),"_").concat(e.name),name:e.name,type:t,mimeType:e.type,size:e.size,courseId:s,data:l.result,uploadedAt:new Date().toISOString()},i=this.db.transaction([$],"readwrite").objectStore($).add(n);i.onsuccess=()=>a({id:n.id,name:n.name,url:this.createBlobURL(n),downloadUrl:this.createBlobURL(n)}),i.onerror=()=>r(i.error)},l.onerror=()=>r(l.error),l.readAsArrayBuffer(e)})}async getFile(e){return this.db||await this.init(),new Promise((s,t)=>{let a=this.db.transaction([$],"readonly").objectStore($).get(e);a.onsuccess=()=>{let e=a.result;e?s({...e,url:this.createBlobURL(e),downloadUrl:this.createBlobURL(e)}):s(null)},a.onerror=()=>t(a.error)})}async getFilesByType(e,s){return this.db||await this.init(),new Promise((t,a)=>{let r=this.db.transaction([$],"readonly").objectStore($).index("courseId").getAll(e);r.onsuccess=()=>{t(r.result.filter(e=>e.type===s).map(e=>({...e,url:this.createBlobURL(e),downloadUrl:this.createBlobURL(e)})))},r.onerror=()=>a(r.error)})}async deleteFile(e){return this.db||await this.init(),new Promise((s,t)=>{let a=this.db.transaction([$],"readwrite").objectStore($).delete(e);a.onsuccess=()=>s(!0),a.onerror=()=>t(a.error)})}createBlobURL(e){let s=new Blob([e.data],{type:e.mimeType});return URL.createObjectURL(s)}async getAllFiles(e){return this.db||await this.init(),new Promise((s,t)=>{let a=this.db.transaction([$],"readonly").objectStore($).index("courseId").getAll(e);a.onsuccess=()=>{s(a.result.map(e=>({...e,url:this.createBlobURL(e),downloadUrl:this.createBlobURL(e)})))},a.onerror=()=>t(a.error)})}constructor(){this.db=null}}let es=new ee,et=(e,s,t)=>es.saveFile(e,s,t),ea=e=>es.getFile(e),er=()=>es.init(),el=e=>es.createBlobURL(e);var en=t(35153);let ei=e=>{var s;let{initialData:t,onSave:l,onCancel:n,isLoading:i,isEditing:o}=e,[c,m]=(0,r.useState)({id:null,title:"",description:"",category:"",level:"Beginner",duration:"",instructor:"",image:"",introMaterial:{title:"",content:[]},lessons:[]});(0,r.useEffect)(()=>{t&&Object.keys(t).length>0?(console.log("Loading initial data:",t),m(e=>{var s,a;return{id:t.id||Date.now(),title:t.title||"",description:t.description||"",category:t.category||"",level:t.level||"Beginner",duration:t.duration||"",instructor:t.instructor||"",image:t.image||"",introMaterial:{title:(null==(s=t.introMaterial)?void 0:s.title)||"",content:Array.isArray(null==(a=t.introMaterial)?void 0:a.content)?t.introMaterial.content.map(e=>({id:e.id||Date.now()+Math.random(),type:e.type||"text",content:e.content||"",title:e.title||"",description:e.description||"",uploadMethod:e.uploadMethod||"link",downloadUrl:e.downloadUrl||"",embedUrl:e.embedUrl||"",src:e.src||"",duration:e.duration||"",url:e.url||"",fileId:e.fileId||"",filename:e.filename||""})):[]},lessons:Array.isArray(t.lessons)?t.lessons:[]}})):o||m({id:Date.now(),title:"",description:"",category:"",level:"Beginner",duration:"",instructor:"",image:"",introMaterial:{title:"",content:[]},lessons:[]})},[t,o]);let[u,g]=(0,r.useState)(!1),[p,b]=(0,r.useState)(null),[j,f]=(0,r.useState)(!1),[y,N]=(0,r.useState)({}),[v,w]=(0,r.useState)(new Set),[k,A]=(0,r.useState)({});(0,r.useEffect)(()=>()=>{v.forEach(e=>{e.startsWith("blob:")&&URL.revokeObjectURL(e)})},[v]);let C=e=>{let{name:s,value:t}=e.target;m(e=>({...e,[s]:t}))},D=(e,s)=>{m(t=>({...t,introMaterial:{...t.introMaterial,[e]:s}}))},P=e=>{let s={id:Date.now().toString(),type:e};switch(e){case"text":s.content="";break;case"pdf":s.title="",s.description="",s.filename="",s.embedUrl="",s.downloadUrl="",s.uploadMethod="link",s.fileId="";break;case"video":s.title="",s.description="",s.src="",s.duration="",s.uploadMethod="link",s.fileId="";break;case"external_link":s.title="",s.description="",s.url=""}m(e=>({...e,introMaterial:{...e.introMaterial,content:[...e.introMaterial.content||[],s]}}))},z=(e,s,t)=>{m(a=>{let r=[...a.introMaterial.content||[]];if(r[e]){let a={...r[e],[s]:t};"uploadMethod"===s&&("link"===t?(a.fileId="",a.filename=""):"upload"===t&&("pdf"===a.type?(a.downloadUrl="",a.embedUrl=""):"video"===a.type&&(a.src="",a.duration=""))),r[e]=a}return{...a,introMaterial:{...a.introMaterial,content:r}}})},I=e=>{m(s=>({...s,introMaterial:{...s.introMaterial,content:(s.introMaterial.content||[]).filter((s,t)=>t!==e)}}))},M=e=>{b(e),g(!0)},L=e=>{m(s=>({...s,lessons:s.lessons.filter((s,t)=>t!==e)}))},F=(e,s)=>!!e&&(!!e.startsWith("blob:")||("video"===s?e.includes("youtube.com")||e.includes("youtu.be")||e.includes("vimeo.com")||e.startsWith("http"):e.startsWith("http")||e.startsWith("https"))),U=(e,s)=>{if(!e||e.startsWith("blob:"))return"";if("video"===s){if(!e.includes("youtube.com")&&!e.includes("youtu.be")&&!e.includes("vimeo.com")&&!e.startsWith("http"))return"URL harus berupa link YouTube, Vimeo, atau URL video langsung"}else if(!e.startsWith("http")&&!e.startsWith("https"))return"URL harus dimulai dengan http:// atau https://";return""},R=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},q=(e,s)=>{let t=c.introMaterial[e];t.embedUrl&&t.embedUrl.startsWith("blob:")&&(URL.revokeObjectURL(t.embedUrl),w(e=>{let s=new Set(e);return s.delete(t.embedUrl),s})),t.downloadUrl&&t.downloadUrl.startsWith("blob:")&&(URL.revokeObjectURL(t.downloadUrl),w(e=>{let s=new Set(e);return s.delete(t.downloadUrl),s})),t.src&&t.src.startsWith("blob:")&&(URL.revokeObjectURL(t.src),w(e=>{let s=new Set(e);return s.delete(t.src),s})),z(e,"fileId",""),z(e,"filename",""),z(e,"fileSize",""),"pdf"===s?(z(e,"downloadUrl",""),z(e,"embedUrl","")):"video"===s&&z(e,"src","")},_=async(e,s,t)=>{try{let a="".concat(t,"_").concat(s);N(e=>({...e,[a]:!0})),A(e=>({...e,[a]:0}));let r=setInterval(()=>{A(e=>({...e,[a]:Math.min((e[a]||0)+30*Math.random(),90)}))},200),l=await et(e,c.id,t);clearInterval(r),A(e=>({...e,[a]:100})),w(e=>new Set([...e,l.url,l.downloadUrl])),z(s,"fileId",l.id),z(s,"filename",l.name),z(s,"fileSize",R(e.size)),"pdf"===t?(z(s,"downloadUrl",l.downloadUrl),z(s,"embedUrl",l.url)):"video"===t&&z(s,"src",l.url),setTimeout(()=>{A(e=>{let s={...e};return delete s[a],s})},2e3)}catch(s){console.error("Error uploading file:",s),alert("Gagal mengupload file ".concat(e.name,". Silakan coba lagi."))}finally{N(e=>({...e,["".concat(t,"_").concat(s)]:!1}))}},O=async e=>{if(e.preventDefault(),!c.title.trim())return void alert("Judul course harus diisi");if(!c.category.trim())return void alert("Kategori course harus diisi");try{await l(c)}catch(e){console.error("Error saving course:",e),alert("Terjadi error saat menyimpan course.")}},B=(e,s)=>{switch(e.type){case"text":return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.A,{className:"text-purple-600",size:16}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Teks"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>I(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:14})})]}),(0,a.jsx)("textarea",{value:e.content||"",onChange:e=>z(s,"content",e.target.value),placeholder:"Konten teks (mendukung Markdown)",className:"w-full p-2 border border-gray-300 rounded text-sm",rows:3}),e.content&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 rounded text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-1",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{className:"text-xs font-medium",children:"Preview:"})]}),(0,a.jsx)("div",{className:"whitespace-pre-wrap",children:e.content})]})]});case"pdf":return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(T.A,{className:"text-red-600",size:16}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"PDF"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>I(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:14})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>z(s,"title",e.target.value),placeholder:"Judul PDF",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsx)("input",{type:"text",value:e.description||"",onChange:e=>z(s,"description",e.target.value),placeholder:"Deskripsi",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(Q.A,{size:16,className:"text-gray-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Upload PDF atau Input Link"})]}),(0,a.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{let t=e.target.files[0];t&&_(t,s,"pdf")},className:"w-full p-2 border border-gray-300 rounded text-sm",disabled:y["pdf_".concat(s)]}),y["pdf_".concat(s)]&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-blue-600",children:"Mengupload PDF..."}),void 0!==k["pdf_".concat(s)]&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(k["pdf_".concat(s)],"%")}})})]}),e.filename&&(0,a.jsxs)("div",{className:"p-2 bg-green-50 border border-green-200 rounded",children:[(0,a.jsxs)("p",{className:"text-sm text-green-700 font-medium",children:["✓ File terupload: ",e.filename]}),e.fileSize&&(0,a.jsxs)("p",{className:"text-xs text-green-600",children:["Ukuran: ",e.fileSize]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-1",children:[e.embedUrl&&(0,a.jsxs)("button",{type:"button",onClick:()=>window.open(e.embedUrl,"_blank"),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{children:"Preview"})]}),e.downloadUrl&&(0,a.jsxs)("button",{type:"button",onClick:()=>window.open(e.downloadUrl,"_blank"),className:"text-xs text-green-600 hover:text-green-800 flex items-center space-x-1",children:[(0,a.jsx)(T.A,{size:12}),(0,a.jsx)("span",{children:"Download"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>q(s,"pdf"),className:"text-xs text-red-600 hover:text-red-800 flex items-center space-x-1",title:"Hapus file",children:[(0,a.jsx)(V.A,{size:12}),(0,a.jsx)("span",{children:"Hapus"})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Atau edit link manual:"}),(0,a.jsx)("input",{type:"url",value:e.downloadUrl||"",onChange:e=>z(s,"downloadUrl",e.target.value),placeholder:"URL Download PDF",className:"w-full p-2 border rounded text-sm ".concat(e.downloadUrl&&!F(e.downloadUrl,"pdf")?"border-red-300 bg-red-50":"border-gray-300")}),e.downloadUrl&&!F(e.downloadUrl,"pdf")&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-red-600 mt-1",children:[(0,a.jsx)(h.A,{size:12}),(0,a.jsx)("span",{children:U(e.downloadUrl,"pdf")||"URL tidak valid"})]}),(e.embedUrl||e.downloadUrl)&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 rounded text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-2",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{className:"font-medium text-xs",children:"Preview PDF:"})]}),e.embedUrl?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("iframe",{src:e.embedUrl,className:"w-full h-64 border border-gray-300 rounded",title:"PDF Preview"}),e.downloadUrl&&(0,a.jsxs)("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-xs text-blue-600 hover:text-blue-800",children:[(0,a.jsx)(T.A,{size:12}),(0,a.jsx)("span",{children:"Download PDF"})]})]}):(0,a.jsxs)("a",{href:e.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-600 hover:text-blue-800",children:[(0,a.jsx)(T.A,{size:12}),(0,a.jsx)("span",{children:"Download PDF"})]})]}),(0,a.jsx)("input",{type:"url",value:e.embedUrl||"",onChange:e=>z(s,"embedUrl",e.target.value),placeholder:"URL Embed PDF (opsional)",className:"w-full p-2 border rounded text-sm ".concat(e.embedUrl&&!F(e.embedUrl,"pdf")?"border-red-300 bg-red-50":"border-gray-300")}),e.embedUrl&&!F(e.embedUrl,"pdf")&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-red-600 mt-1",children:[(0,a.jsx)(h.A,{size:12}),(0,a.jsx)("span",{children:U(e.embedUrl,"pdf")||"URL tidak valid"})]})]})]}),e.src&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 rounded text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-2",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{className:"font-medium text-xs",children:"Preview Video:"}),e.duration&&(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:["(",e.duration,")"]})]}),e.src.includes("youtube.com")||e.src.includes("youtu.be")?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("iframe",{width:"100%",height:"200",src:e.src.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"rounded"}),(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-red-600 text-white text-xs px-1 rounded",children:"YouTube"})]}):e.src.includes("vimeo.com")?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("iframe",{src:e.src.replace("vimeo.com/","player.vimeo.com/video/"),width:"100%",height:"200",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,className:"rounded"}),(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-blue-600 text-white text-xs px-1 rounded",children:"Vimeo"})]}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("video",{controls:!0,className:"w-full h-48 rounded",src:e.src,children:"Browser Anda tidak mendukung tag video."}),(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-gray-600 text-white text-xs px-1 rounded",children:e.src.startsWith("blob:")?"Upload":"Direct"})]})]})]})]});case"video":return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Y.A,{className:"text-blue-600",size:16}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Video"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>I(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:14})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>z(s,"title",e.target.value),placeholder:"Judul Video",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsx)("input",{type:"text",value:e.description||"",onChange:e=>z(s,"description",e.target.value),placeholder:"Deskripsi Video",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(Q.A,{size:16,className:"text-gray-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Upload Video atau Input Link"})]}),(0,a.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{let t=e.target.files[0];t&&_(t,s,"video")},className:"w-full p-2 border border-gray-300 rounded text-sm",disabled:y["video_".concat(s)]}),y["video_".concat(s)]&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-blue-600",children:"Mengupload Video..."}),void 0!==k["video_".concat(s)]&&(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(k["video_".concat(s)],"%")}})})]}),e.filename&&(0,a.jsxs)("div",{className:"p-2 bg-green-50 border border-green-200 rounded",children:[(0,a.jsxs)("p",{className:"text-sm text-green-700 font-medium",children:["✓ File terupload: ",e.filename]}),e.fileSize&&(0,a.jsxs)("p",{className:"text-xs text-green-600",children:["Ukuran: ",e.fileSize]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-1",children:[e.src&&(0,a.jsxs)("button",{type:"button",onClick:()=>window.open(e.src,"_blank"),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{children:"Preview"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>q(s,"video"),className:"text-xs text-red-600 hover:text-red-800 flex items-center space-x-1",title:"Hapus file",children:[(0,a.jsx)(V.A,{size:12}),(0,a.jsx)("span",{children:"Hapus"})]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Atau edit link manual:"}),(0,a.jsx)("input",{type:"url",value:e.src||"",onChange:e=>z(s,"src",e.target.value),placeholder:"URL Video (YouTube, Vimeo, atau link langsung)",className:"w-full p-2 border rounded text-sm ".concat(e.src&&!F(e.src,"video")?"border-red-300 bg-red-50":"border-gray-300")}),e.src&&!F(e.src,"video")&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-red-600 mt-1",children:[(0,a.jsx)(h.A,{size:12}),(0,a.jsx)("span",{children:U(e.src,"video")||"URL video tidak valid"})]}),(0,a.jsx)("input",{type:"text",value:e.duration||"",onChange:e=>z(s,"duration",e.target.value),placeholder:"Durasi (contoh: 5:30)",className:"w-full p-2 border border-gray-300 rounded text-sm"})]})]})]})]});case"external_link":return(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(H.A,{className:"text-green-600",size:16}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Link"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>I(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:14})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("input",{type:"text",value:e.title||"",onChange:e=>z(s,"title",e.target.value),placeholder:"Judul Link",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsx)("input",{type:"text",value:e.description||"",onChange:e=>z(s,"description",e.target.value),placeholder:"Deskripsi",className:"w-full p-2 border border-gray-300 rounded text-sm"}),(0,a.jsx)("input",{type:"url",value:e.url||"",onChange:e=>z(s,"url",e.target.value),placeholder:"URL",className:"w-full p-2 border rounded text-sm ".concat(e.url&&!F(e.url,"link")?"border-red-300 bg-red-50":"border-gray-300")}),e.url&&!F(e.url,"link")&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-red-600",children:[(0,a.jsx)(h.A,{size:12}),(0,a.jsx)("span",{children:U(e.url,"link")||"URL tidak valid"})]}),e.url&&F(e.url,"link")&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-100 rounded text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-2",children:[(0,a.jsx)(d.A,{size:12}),(0,a.jsx)("span",{className:"font-medium text-xs",children:"Preview Link:"})]}),(0,a.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center space-x-1 text-blue-600 hover:text-blue-800 break-all",children:[(0,a.jsx)(H.A,{size:12}),(0,a.jsx)("span",{className:"text-xs",children:e.url})]})]})]})]});default:return null}};return u?(0,a.jsx)(Z,{lesson:null!==p?c.lessons[p]:null,onSave:e=>{if(null!==p){let s=[...c.lessons];s[p]=e,m(e=>({...e,lessons:s}))}else m(s=>({...s,lessons:[...s.lessons,e]}));g(!1),b(null)},onCancel:()=>{g(!1),b(null)}}):(0,a.jsx)("div",{className:"max-w-6xl mx-auto p-6 max-h-screen overflow-y-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Course":"Tambah Course Baru"})}),(0,a.jsxs)("form",{onSubmit:O,className:"p-6 text-gray-900 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Course"}),(0,a.jsx)("input",{type:"text",name:"title",value:c.title||"",onChange:C,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategori"}),(0,a.jsx)("input",{type:"text",name:"category",value:c.category||"",onChange:C,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level"}),(0,a.jsxs)("select",{name:"level",value:c.level||"Beginner",onChange:C,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"Beginner",children:"Beginner"}),(0,a.jsx)("option",{value:"Intermediate",children:"Intermediate"}),(0,a.jsx)("option",{value:"Advanced",children:"Advanced"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Durasi"}),(0,a.jsx)("input",{type:"text",name:"duration",value:c.duration||"",onChange:C,placeholder:"contoh: 4 weeks",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instructor"}),(0,a.jsx)("input",{type:"text",name:"instructor",value:c.instructor||"",onChange:C,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Gambar"}),(0,a.jsx)("input",{type:"url",name:"image",value:c.image||"",onChange:C,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Course"}),(0,a.jsx)("textarea",{name:"description",value:c.description||"",onChange:C,rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Materi Pengantar"}),(0,a.jsx)("button",{type:"button",onClick:()=>f(!j),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:j?"Sembunyikan":"Kelola Materi Pengantar"})]}),j&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Materi Pengantar"}),(0,a.jsx)("input",{type:"text",value:(null==(s=c.introMaterial)?void 0:s.title)||"",onChange:e=>D("title",e.target.value),className:"w-full p-2 border border-gray-300 rounded text-sm",placeholder:"Selamat Datang di Course..."})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Konten Pengantar"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>P("text"),className:"px-2 py-1 text-xs bg-white border border-gray-300 rounded hover:bg-gray-50",children:[(0,a.jsx)(S.A,{size:12,className:"inline mr-1"}),"Teks"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>P("pdf"),className:"px-2 py-1 text-xs bg-white border border-gray-300 rounded hover:bg-gray-50",children:[(0,a.jsx)(T.A,{size:12,className:"inline mr-1"}),"PDF"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>P("video"),className:"px-2 py-1 text-xs bg-white border border-gray-300 rounded hover:bg-gray-50",children:[(0,a.jsx)(Y.A,{size:12,className:"inline mr-1"}),"Video"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>P("external_link"),className:"px-2 py-1 text-xs bg-white border border-gray-300 rounded hover:bg-gray-50",children:[(0,a.jsx)(H.A,{size:12,className:"inline mr-1"}),"Link"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(c.introMaterial.content||[]).map((e,s)=>(0,a.jsx)("div",{children:B(e,s)},e.id||"intro-".concat(s))),(!c.introMaterial.content||0===c.introMaterial.content.length)&&(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Belum ada konten pengantar"})]})]})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Lessons (",c.lessons.length,")"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(J.A,{className:"mr-2 h-4 w-4"}),"Tambah Lesson"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[c.lessons.map((e,s)=>{var t;return(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Type: ",e.type," • Content items: ",(null==(t=e.content)?void 0:t.length)||0]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>M(s),className:"text-blue-600 hover:text-blue-800",children:(0,a.jsx)(E.A,{size:16})}),(0,a.jsx)("button",{type:"button",onClick:()=>L(s),className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(V.A,{size:16})})]})]})},e.id)}),0===c.lessons.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:'Belum ada lesson. Klik "Tambah Lesson" untuk memulai.'})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,a.jsxs)("button",{type:"button",onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Batal"]}),(0,a.jsxs)("button",{type:"submit",disabled:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 ".concat(i?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),i?"Menyimpan...":o?"Update Course":"Simpan Course"]})]})]})]})})};var eo=t(54954);let ed=e=>{let{courseId:s=null,onSave:t,onCancel:l}=e,[n,i]=(0,r.useState)({title:"",description:"",category:"",level:"Beginner",duration:"",instructor:"",image:"",introMaterial:{title:"",content:[]},lessons:[]}),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{await er();let l=(0,en.OM)();if(0===l.length&&eo.coursesData.length>0&&eo.coursesData.forEach(e=>{(0,en.bX)(e)}),s){var e,t,a,r;try{let a=await y.GS.getCourseById(s);if(a&&a.success&&a.data){let e=a.data,s=e.introMaterial,t=e.lessons;if("string"==typeof s)try{s=JSON.parse(s)}catch(e){console.warn("Failed to parse introMaterial:",e),s={title:"",content:[]}}if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.warn("Failed to parse lessons:",e),t=[]}i({...e,introMaterial:{title:(null==s?void 0:s.title)||"",content:Array.isArray(null==s?void 0:s.content)?s.content:[]},lessons:Array.isArray(t)?t:[]})}else{let a=await (0,en.TX)(parseInt(s));a&&i({...a,introMaterial:{title:(null==(e=a.introMaterial)?void 0:e.title)||"",content:Array.isArray(null==(t=a.introMaterial)?void 0:t.content)?a.introMaterial.content:[]},lessons:a.lessons||[]})}}catch(t){console.error("Error loading course from backend, trying localStorage:",t);let e=await (0,en.TX)(parseInt(s));e&&i({...e,introMaterial:{title:(null==(a=e.introMaterial)?void 0:a.title)||"",content:Array.isArray(null==(r=e.introMaterial)?void 0:r.content)?e.introMaterial.content:[]},lessons:e.lessons||[]})}}}catch(e){console.error("Error initializing data:",e)}})()},[s]);let c=async e=>{d(!0);try{if(await (0,en.AV)(e))alert(s?"Kursus berhasil diperbarui!":"Kursus berhasil dibuat!"),t&&t(e);else throw Error("Gagal menyimpan kursus")}catch(e){console.error("Error saving course:",e),alert("Terjadi kesalahan saat menyimpan kursus")}finally{d(!1)}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[l&&(0,a.jsxs)("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:[(0,a.jsx)(K.A,{size:20}),"Kembali"]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:s?"Edit Kursus":"Buat Kursus Baru"})]})}),(0,a.jsx)(ei,{initialData:n,onSave:c,onCancel:l,isLoading:o,isEditing:!!s})]})},ec=e=>{let{course:s,onSave:t,onCancel:r}=e;return(0,a.jsx)(ed,{courseId:null==s?void 0:s.id,onSave:t,onCancel:r})},em=e=>{let{courses:s,onEdit:t,onDelete:r}=e;return 0===s.length?(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-gray-200 text-center",children:[(0,a.jsx)(S.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No courses yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Create your first course to get started."})]}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>{var s;return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[e.image&&(0,a.jsx)("img",{src:e.image,alt:e.title,className:"w-16 h-16 object-cover rounded-lg flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(null==(s=e.lessons)?void 0:s.length)||0," lessons"]})]}),e.lessons&&e.lessons.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[e.lessons.filter(e=>"video"===e.type).length," videos, "," ",e.lessons.filter(e=>"reading"===e.type).length," readings"]})]})]})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>t(e),className:"inline-flex items-center px-3 py-2 text-sm text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:"Edit course",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>r(e.id),className:"inline-flex items-center px-3 py-2 text-sm text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",title:"Delete course",children:[(0,a.jsx)(V.A,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),e.lessons&&e.lessons.length>0&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Lessons:"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:[e.lessons.slice(0,6).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0 ".concat("video"===e.type?"bg-red-400":"bg-green-400")}),(0,a.jsx)("span",{className:"truncate",children:e.title||"Lesson ".concat(s+1)})]},e.id||s)),e.lessons.length>6&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["+",e.lessons.length-6," more lessons"]})]})]})]},e.id)})})};var ex=t(47863),eu=t(66474);let eg=()=>{let{courses:e,user:s}=(0,l.A)(),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)("pretest"),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{let e=s;if(!e)try{let s=localStorage.getItem("currentUser");s&&(e=JSON.parse(s))}catch(e){console.error("Error parsing stored user:",e)}if(t&&i&&e&&"admin"===e.role)try{let e=null;if((e="pretest"===i?await y.adminAPI.getCoursePreTestAdmin(t):await y.adminAPI.getCoursePostTestAdmin(t))&&e.success&&e.data&&e.data.questions){let s="string"==typeof e.data.questions?JSON.parse(e.data.questions):e.data.questions;x(s)}else x([])}catch(e){console.error("Error loading quiz:",e),x([])}else t&&i&&x([])})()},[t,i,s]);let u=e=>{o(e),c(null)},g=e=>{window.confirm("Apakah Anda yakin ingin menghapus pertanyaan ini?")&&(x(m.filter(s=>s.id!==e)),d===e&&c(null))},h=(e,s,t)=>{x(m.map(a=>a.id===e?{...a,[s]:t}:a))},p=async()=>{if(!t||0===m.length)return void alert("Please select a course and add at least one question.");let a=s;if(!a)try{let e=localStorage.getItem("currentUser");e&&(a=JSON.parse(e))}catch(e){console.error("Error parsing stored user:",e)}if(!a||"admin"!==a.role)return void alert("Only administrators can save quizzes.");let r=e.find(e=>e.id===t);if(!r)return void alert("Course not found.");let l={title:"".concat(r.title," ").concat("pretest"===i?"Pre-Test":"Post-Test"),description:"".concat("pretest"===i?"Pre-test":"Post-test"," for ").concat(r.title),courseId:t,quizType:i,questions:JSON.stringify(m),timeLimit:30,maxAttempts:3,passingScore:70,isActive:!0};try{let e=null;try{e="pretest"===i?await y.adminAPI.getCoursePreTestAdmin(t):await y.adminAPI.getCoursePostTestAdmin(t)}catch(e){console.log("No existing quiz found, creating new one")}let s=null;e&&e.success&&e.data&&e.data.id&&(s=e.data.id),s?(await y.adminAPI.updateQuiz(s,l),alert("Quiz updated successfully!")):(await y.adminAPI.createQuiz(l),alert("Quiz created successfully!")),x([])}catch(e){console.error("Error saving quiz:",e),alert("Failed to save quiz. Please try again.")}},b=(e,s)=>{let t=m.findIndex(s=>s.id===e);if(-1===t)return;let a=[...m];"up"===s&&t>0?[a[t],a[t-1]]=[a[t-1],a[t]]:"down"===s&&t<m.length-1&&([a[t],a[t+1]]=[a[t+1],a[t]]),x(a)},j=s;if(!j)try{let e=localStorage.getItem("currentUser");e&&(j=JSON.parse(e))}catch(e){console.error("Error parsing stored user:",e)}return j&&"admin"===j.role?(0,a.jsxs)("div",{className:"space-y-6 text-gray-900",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Quiz Manager"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Kelola pre-test dan post-test untuk setiap kursus"})]})}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Kursus"}),(0,a.jsxs)("select",{value:t||"",onChange:e=>{n(Number(e.target.value)),c(null)},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"-- Pilih Kursus --"}),e.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Quiz"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{onClick:()=>u("pretest"),className:"px-4 py-2 rounded-md ".concat("pretest"===i?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:"Pre-Test"}),(0,a.jsx)("button",{onClick:()=>u("posttest"),className:"px-4 py-2 rounded-md ".concat("posttest"===i?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:"Post-Test"})]})]})]}),t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["pretest"===i?"Pre-Test":"Post-Test"," Questions"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{let e={id:Date.now(),question:"",options:["","","",""],correct:0};x([...m,e]),c(e.id)},className:"flex items-center px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,a.jsx)(J.A,{size:16,className:"mr-1"}),"Add Question"]}),(0,a.jsxs)("button",{onClick:p,className:"flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(X.A,{size:16,className:"mr-1"}),"Save Quiz"]})]})]}),0===m.length?(0,a.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-gray-500",children:'No questions yet. Click "Add Question" to create one.'})}):(0,a.jsx)("div",{className:"space-y-4",children:m.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"font-medium mr-2",children:["Question ",s+1]}),d!==e.id&&(0,a.jsx)("span",{className:"text-gray-600 truncate max-w-md",children:e.question||"No question text"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>b(e.id,"up"),disabled:0===s,className:"p-1 rounded ".concat(0===s?"text-gray-400":"text-gray-700 hover:bg-gray-200"),children:(0,a.jsx)(ex.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>b(e.id,"down"),disabled:s===m.length-1,className:"p-1 rounded ".concat(s===m.length-1?"text-gray-400":"text-gray-700 hover:bg-gray-200"),children:(0,a.jsx)(eu.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>c(d===e.id?null:e.id),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:(0,a.jsx)(E.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>g(e.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:(0,a.jsx)(V.A,{size:16})})]})]}),d===e.id&&(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text"}),(0,a.jsx)("textarea",{value:e.question,onChange:s=>h(e.id,"question",s.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Enter your question here"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Options (select one correct answer)"}),(0,a.jsx)("div",{className:"space-y-3",children:e.options.map((s,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"radio",checked:e.correct===t,onChange:()=>h(e.id,"correct",t),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("input",{type:"text",value:s,onChange:s=>{let a=[...e.options];a[t]=s.target.value,h(e.id,"options",a)},className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Option ".concat(t+1)})]},t))})]})]})]},e.id))})]})]})]}):(0,a.jsx)("div",{className:"space-y-6 text-gray-900",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-red-800 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-red-600",children:j?"Only administrators can access Quiz Manager.":"Please login to access Quiz Manager."}),(0,a.jsxs)("p",{className:"text-sm text-red-500 mt-2",children:["Current user role: ",(null==j?void 0:j.role)||"Not logged in"]})]})})};var eh=t(38564);let ep=()=>{let{courses:e,updateCourse:s}=(0,l.A)(),[t,n]=(0,r.useState)(null),[i,o]=(0,r.useState)([]),[d,c]=(0,r.useState)(null),m=[{id:1,type:"rating",text:"Bagaimana penilaian Anda terhadap kualitas materi pembelajaran?",required:!0},{id:2,type:"rating",text:"Seberapa mudah materi ini dipahami?",required:!0},{id:3,type:"rating",text:"Apakah materi ini relevan dengan kebutuhan Anda?",required:!0},{id:4,type:"text",text:"Apa yang paling Anda sukai dari kursus ini?",required:!1},{id:5,type:"text",text:"Saran untuk perbaikan kursus ini:",required:!1}];(0,r.useEffect)(()=>{if(t){let s=e.find(e=>e.id===t);s&&s.survey&&s.survey.questions?o(s.survey.questions):o(m)}else o([])},[t,e]);let x=e=>{window.confirm("Apakah Anda yakin ingin menghapus pertanyaan ini?")&&(o(i.filter(s=>s.id!==e)),d===e&&c(null))},u=(e,s,t)=>{o(i.map(a=>a.id===e?{...a,[s]:t}:a))};return(0,a.jsxs)("div",{className:"space-y-6 text-gray-900",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Survey Manager"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Kelola survei pengalaman belajar untuk setiap kursus"})]})}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Kursus"}),(0,a.jsxs)("select",{value:t||"",onChange:e=>{n(Number(e.target.value)),c(null)},className:"w-full md:w-1/2 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"-- Pilih Kursus --"}),e.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Survey Questions"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{window.confirm("Reset ke pertanyaan default? Semua perubahan akan hilang.")&&(o(m),c(null))},className:"px-3 py-1 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Reset to Default"}),(0,a.jsxs)("button",{onClick:()=>{let e={id:Date.now(),type:"rating",text:"",required:!1};o([...i,e]),c(e.id)},className:"flex items-center px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[(0,a.jsx)(J.A,{size:16,className:"mr-1"}),"Add Question"]}),(0,a.jsxs)("button",{onClick:()=>{if(!t)return;let a=e.find(e=>e.id===t);a&&(s(t,{...a,survey:{title:"Survei Pengalaman Belajar",description:"Berikan penilaian Anda terhadap kursus ini",questions:i}}),alert("Survei berhasil disimpan!"))},className:"flex items-center px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(X.A,{size:16,className:"mr-1"}),"Save Survey"]})]})]}),0===i.length?(0,a.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-gray-500",children:'No survey questions yet. Click "Add Question" to create one.'})}):(0,a.jsx)("div",{className:"space-y-4",children:i.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"font-medium mr-2",children:["Question ",s+1]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full mr-2 ".concat("rating"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:"rating"===e.type?"Rating":"Text"}),e.required&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full mr-2",children:"Required"}),d!==e.id&&(0,a.jsx)("span",{className:"text-gray-600 truncate max-w-md",children:e.text||"No question text"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>c(d===e.id?null:e.id),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",children:(0,a.jsx)(E.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>x(e.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:(0,a.jsx)(V.A,{size:16})})]})]}),d===e.id&&(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text"}),(0,a.jsx)("textarea",{value:e.text,onChange:s=>u(e.id,"text",s.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Enter your survey question here"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Type"}),(0,a.jsxs)("select",{value:e.type,onChange:s=>u(e.id,"type",s.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"rating",children:"Rating (1-5 stars)"}),(0,a.jsx)("option",{value:"text",children:"Text Response"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Required"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",checked:!0===e.required,onChange:()=>u(e.id,"required",!0),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:"Yes"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",checked:!1===e.required,onChange:()=>u(e.id,"required",!1),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:"No"})]})]})]})]}),"rating"===e.type&&(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Preview:"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(e=>(0,a.jsx)(eh.A,{size:20,className:"text-yellow-400 fill-current"},e)),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"(1-5 rating scale)"})]})]})]})]},e.id))})]})]})]})},eb=()=>{let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!1),[i,c]=(0,r.useState)(null),[m,x]=(0,r.useState)({username:"",password:"",role:"user",email:"",fullName:""}),[u,g]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[b,j]=(0,r.useState)("");(0,r.useEffect)(()=>{f()},[]);let f=async()=>{try{p(!0),j("");let e=await y.adminAPI.getAllUsers();e&&e.users&&s(e.users)}catch(e){console.error("Error loading users:",e),j("Failed to load users")}finally{p(!1)}},N=async e=>{if(e.preventDefault(),!m.username||!m.password)return void alert("Username dan password harus diisi!");try{p(!0),j(""),i?await y.adminAPI.updateUser(i.id,m):await y.adminAPI.createUser(m),await f(),x({username:"",fullName:"",email:"",role:"user",password:""}),l(!1),c(null)}catch(e){console.error("Error saving user:",e),j(e.message||"Failed to save user")}finally{p(!1)}},v=e=>{c(e),x({username:e.username,fullName:e.fullName||"",email:e.email||"",role:e.role,password:""}),l(!0)},w=async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus user ini?"))try{p(!0),j(""),await y.adminAPI.deleteUser(e),await f()}catch(e){console.error("Error deleting user:",e),j(e.message||"Failed to delete user")}finally{p(!1)}};return(0,a.jsxs)("div",{className:"space-y-6 text-gray-900",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Manajemen User"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Kelola user dan hak akses sistem"})]}),(0,a.jsxs)("button",{onClick:()=>l(!0),disabled:h,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[(0,a.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"Tambah User"]})]}),b&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:b}),h&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading..."})]}),t&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:i?"Edit User":"Tambah User Baru"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),(0,a.jsx)("input",{type:"text",value:m.username,onChange:e=>x({...m,username:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Lengkap"}),(0,a.jsx)("input",{type:"text",value:m.fullName,onChange:e=>x({...m,fullName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",value:m.email,onChange:e=>x({...m,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),(0,a.jsxs)("select",{value:m.role,onChange:e=>x({...m,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:u?"text":"password",value:m.password,onChange:e=>x({...m,password:e.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:u?(0,a.jsx)(o.A,{className:"h-4 w-4 text-gray-400"}):(0,a.jsx)(d.A,{className:"h-4 w-4 text-gray-400"})})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{l(!1),c(null),x({username:"",fullName:"",email:"",role:"user",password:""})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Batal"}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:h?"Menyimpan...":i?"Update":"Simpan"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Daftar User"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dibuat"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-8 w-8",children:(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"h-4 w-4 text-gray-500"})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.fullName||e.username}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["@",e.username]})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("admin"===e.role?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:["admin"===e.role?(0,a.jsx)(z.A,{className:"h-3 w-3 mr-1"}):(0,a.jsx)(n.A,{className:"h-3 w-3 mr-1"}),"admin"===e.role?"Admin":"User"]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("id-ID")}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Edit user",children:(0,a.jsx)(E.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>w(e.id),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Hapus user",children:(0,a.jsx)(V.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})]}),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(n.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Belum ada user"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Mulai dengan menambahkan user pertama."})]})]})};var ej=t(12486),ef=t(69074);let ey=()=>{let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)(null),[d,c]=(0,r.useState)({title:"",content:"",priority:"normal",targetAudience:"all"}),m=(0,r.useCallback)(async()=>{try{let e=await y.Ay.admin.getAllAnnouncements();e.success?s(e.announcements||[]):(console.error("Failed to load announcements:",e.message),s([]))}catch(e){console.error("Error loading announcements:",e),s([])}},[]);(0,r.useEffect)(()=>{m()},[m]);let x=async e=>{if(e.preventDefault(),!d.title.trim()||!d.content.trim())return void alert("Judul dan konten pengumuman harus diisi!");let s={title:d.title,content:d.content,priority:d.priority,target_audience:d.targetAudience};console.log("Sending announcement data:",s);try{let e;(e=i?await y.Ay.admin.updateAnnouncement(i,s):await y.Ay.admin.createAnnouncement(s)).success?(await m(),h(),alert(i?"Pengumuman berhasil diperbarui!":"Pengumuman berhasil dibuat!")):alert("Gagal menyimpan pengumuman: "+(e.message||"Unknown error"))}catch(e){console.error("Error saving announcement:",e),alert("Terjadi kesalahan saat menyimpan pengumuman")}},u=e=>{c({title:e.title,content:e.content,priority:e.priority,targetAudience:e.target_audience||e.targetAudience}),o(e.id),l(!0)},g=async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus pengumuman ini?"))try{let s=await y.Ay.admin.deleteAnnouncement(e);s.success?(await m(),alert("Pengumuman berhasil dihapus!")):alert("Gagal menghapus pengumuman: "+(s.message||"Unknown error"))}catch(e){console.error("Error deleting announcement:",e),alert("Terjadi kesalahan saat menghapus pengumuman")}},h=()=>{c({title:"",content:"",priority:"normal",targetAudience:"all"}),l(!1),o(null)},p=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=e=>{switch(e){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";default:return"text-blue-600 bg-blue-100"}},j=e=>{switch(e){case"high":return"Tinggi";case"medium":return"Sedang";default:return"Normal"}},f=e=>{switch(e){case"users":return"Pengguna";case"admins":return"Admin";default:return"Semua"}};return(0,a.jsxs)("div",{className:"p-6 text-gray-900",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Manajemen Pengumuman"}),(0,a.jsxs)("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,a.jsx)(J.A,{size:20}),"Buat Pengumuman"]})]}),t&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:i?"Edit Pengumuman":"Buat Pengumuman Baru"}),(0,a.jsxs)("form",{onSubmit:x,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Pengumuman"}),(0,a.jsx)("input",{type:"text",value:d.title,onChange:e=>c({...d,title:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan judul pengumuman",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioritas"}),(0,a.jsxs)("select",{value:d.priority,onChange:e=>c({...d,priority:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"normal",children:"Normal"}),(0,a.jsx)("option",{value:"medium",children:"Sedang"}),(0,a.jsx)("option",{value:"high",children:"Tinggi"})]})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Audiens"}),(0,a.jsxs)("select",{value:d.targetAudience,onChange:e=>c({...d,targetAudience:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"Semua Pengguna"}),(0,a.jsx)("option",{value:"users",children:"Pengguna"}),(0,a.jsx)("option",{value:"admins",children:"Admin"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konten Pengumuman"}),(0,a.jsx)("textarea",{value:d.content,onChange:e=>c({...d,content:e.target.value}),rows:6,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Masukkan konten pengumuman",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,a.jsx)(ej.A,{size:16}),i?"Update":"Publikasikan"]}),(0,a.jsx)("button",{type:"button",onClick:h,className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600",children:"Batal"})]})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(ef.A,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,a.jsx)("p",{children:"Belum ada pengumuman yang dibuat"})]}):e.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(b(e.priority)),children:j(e.priority)}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:f(e.target_audience||e.targetAudience)})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-3 whitespace-pre-wrap",children:e.content}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(n.A,{size:14}),(0,a.jsx)("span",{children:e.author||"Admin"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(ef.A,{size:14}),(0,a.jsx)("span",{children:p(e.created_at||e.createdAt)})]}),(e.updated_at||e.updatedAt)!==(e.created_at||e.createdAt)&&(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["(Diperbarui: ",p(e.updated_at||e.updatedAt),")"]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>u(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:(0,a.jsx)(E.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>g(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Hapus",children:(0,a.jsx)(V.A,{size:16})})]})]})},e.id))})]})};var eN=t(91788),ev=t(5196),ew=t(18186),ek=t(47924),eA=t(66932);let eS=()=>{let[e,s]=(0,r.useState)([]),[t,i]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[m,u]=(0,r.useState)(""),[g,h]=(0,r.useState)("all"),[p,b]=(0,r.useState)(null),[j,N]=(0,r.useState)("all"),[v,w]=(0,r.useState)(!1),{currentUser:k}=(0,l.A)(),A=(0,r.useCallback)(async()=>{try{let e;(e=(null==k?void 0:k.role)==="admin"?await y.adminAPI.getAllCertificates():await y.certificateAPI.getUserCertificates()).success?s(e.certificates||[]):C()}catch(e){console.error("Error loading certificates from backend:",e),C()}},[k]),S=(0,r.useCallback)(async()=>{if((null==k?void 0:k.role)==="admin")try{let e=await y.adminAPI.getPendingCertificates();e.success&&i(e.certificates||[])}catch(e){console.error("Error loading pending certificates:",e)}},[k]),C=()=>{let e=[];for(let s=0;s<localStorage.length;s++){let t=localStorage.key(s);if(t&&t.startsWith("certificates_"))try{let s=JSON.parse(localStorage.getItem(t)||"[]");e.push(...s)}catch(e){console.error("Error loading certificates from key:",t,e)}}console.log("CertificateManager: Loaded certificates:",e),s(e)},D=(0,r.useCallback)(()=>{let s=e;if(m&&(s=s.filter(e=>(e.studentName||e.userName||"").toLowerCase().includes(m.toLowerCase())||(e.courseName||"").toLowerCase().includes(m.toLowerCase())||(e.cert_number||e.certNumber||"").toLowerCase().includes(m.toLowerCase()))),"all"!==g){let e=new Date,t=new Date;switch(g){case"week":t.setDate(e.getDate()-7);break;case"month":t.setMonth(e.getMonth()-1);break;case"year":t.setFullYear(e.getFullYear()-1)}s=s.filter(e=>new Date(e.completionDate)>=t)}c(s.sort((e,s)=>new Date(s.completionDate)-new Date(e.completionDate)))},[e,m,g]);(0,r.useEffect)(()=>{A(),(null==k?void 0:k.role)==="admin"&&S()},[A,S,k]),(0,r.useEffect)(()=>{D()},[D]);let P=t=>{if(window.confirm("Apakah Anda yakin ingin menghapus sertifikat ini?")){let a=e.filter(e=>e.id!==t);s(a),localStorage.setItem("certificates",JSON.stringify(a))}},z=async e=>{if(window.confirm("Apakah Anda yakin ingin menyetujui sertifikat ini?")){w(!0);try{let s=await y.adminAPI.approveCertificate(e);s.success?(alert("Sertifikat berhasil disetujui!"),A(),S()):alert("Gagal menyetujui sertifikat: "+(s.message||"Unknown error"))}catch(e){console.error("Error approving certificate:",e),alert("Gagal menyetujui sertifikat")}finally{w(!1)}}},M=async e=>{let s=prompt("Masukkan alasan penolakan:");if(s){w(!0);try{let t=await y.adminAPI.rejectCertificate(e,s);t.success?(alert("Sertifikat berhasil ditolak!"),A(),S()):alert("Gagal menolak sertifikat: "+(t.message||"Unknown error"))}catch(e){console.error("Error rejecting certificate:",e),alert("Gagal menolak sertifikat")}finally{w(!1)}}},E=e=>{let s=e.studentName||e.userName||"Unknown Student",t=e.courseName||"Unknown Course",a=e.cert_number||e.certNumber||"N/A",r=e.completionDate||new Date().toISOString(),l=e.grade||"N/A",n=new Blob(["\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Sertifikat - ".concat(t,'</title>\n        <style>\n          body { \n            font-family: \'Georgia\', serif; \n            margin: 0; \n            padding: 40px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n          }\n          .certificate {\n            background: white;\n            padding: 60px;\n            border-radius: 20px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n            text-align: center;\n            max-width: 800px;\n            border: 8px solid #f8f9fa;\n            position: relative;\n          }\n          .certificate::before {\n            content: \'\';\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            right: 20px;\n            bottom: 20px;\n            border: 3px solid #667eea;\n            border-radius: 10px;\n          }\n          .header { color: #667eea; margin-bottom: 30px; }\n          .title { font-size: 48px; font-weight: bold; margin: 20px 0; color: #2d3748; }\n          .subtitle { font-size: 24px; margin: 20px 0; color: #4a5568; }\n          .name { font-size: 36px; font-weight: bold; color: #667eea; margin: 30px 0; text-decoration: underline; }\n          .course { font-size: 28px; font-weight: bold; color: #2d3748; margin: 20px 0; }\n          .details { margin: 30px 0; color: #718096; }\n          .signature { margin-top: 50px; display: flex; justify-content: space-between; }\n          .sig-line { border-top: 2px solid #e2e8f0; width: 200px; padding-top: 10px; }\n        </style>\n      </head>\n      <body>\n        <div class="certificate">\n          <div class="header">\n            <h1>\uD83C\uDFC6 SERTIFIKAT PENYELESAIAN \uD83C\uDFC6</h1>\n          </div>\n          <div class="title">CERTIFICATE OF COMPLETION</div>\n          <div class="subtitle">Dengan ini menyatakan bahwa</div>\n          <div class="name">').concat(s,'</div>\n          <div class="subtitle">telah berhasil menyelesaikan kursus</div>\n          <div class="course">').concat(t,'</div>\n          <div class="details">\n            <p><strong>Nomor Sertifikat:</strong> ').concat(a,"</p>\n            <p><strong>Tanggal Penyelesaian:</strong> ").concat(new Date(r).toLocaleDateString("id-ID"),"</p>\n            <p><strong>Grade:</strong> ").concat(l,"</p>\n          </div>\n        </div>\n      </body>\n      </html>\n    ")],{type:"text/html"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i;let d=t.replace(/[^a-zA-Z0-9]/g,"-"),c=s.replace(/[^a-zA-Z0-9]/g,"-");o.download="Sertifikat-".concat(d,"-").concat(c,".html"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},L=e=>new Date(e).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-6",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 text-white p-8",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-opacity-20 p-4 rounded-full",children:(0,a.jsx)(ew.A,{className:"text-white",size:32})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Manajemen Sertifikat"}),(0,a.jsx)("p",{className:"text-yellow-100 text-lg",children:"Kelola semua sertifikat yang telah diterbitkan"})]})]})}),(0,a.jsxs)("div",{className:"p-8",children:[(null==k?void 0:k.role)==="admin"&&(0,a.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,a.jsxs)("button",{onClick:()=>N("all"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("all"===j?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["Semua Sertifikat (",e.length,")"]}),(0,a.jsxs)("button",{onClick:()=>N("pending"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("pending"===j?"bg-yellow-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["Menunggu Persetujuan (",t.length,")"]})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(ek.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"text",placeholder:"Cari berdasarkan nama, kursus, atau nomor sertifikat...",value:m,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eA.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsxs)("select",{value:g,onChange:e=>h(e.target.value),className:"pl-10 pr-8 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white",children:[(0,a.jsx)("option",{value:"all",children:"Semua Waktu"}),(0,a.jsx)("option",{value:"week",children:"7 Hari Terakhir"}),(0,a.jsx)("option",{value:"month",children:"30 Hari Terakhir"}),(0,a.jsx)("option",{value:"year",children:"1 Tahun Terakhir"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-blue-100",children:"Total Sertifikat"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:e.length})]}),(0,a.jsx)(I.A,{size:40,className:"text-blue-200"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-100",children:"Bulan Ini"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:e.filter(e=>{let s=new Date(e.completionDate),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length})]}),(0,a.jsx)(ef.A,{size:40,className:"text-green-200"})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-purple-100",children:"Kursus Unik"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:new Set(e.map(e=>e.courseName)).size})]}),(0,a.jsx)(T.A,{size:40,className:"text-purple-200"})]})})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"pending"===j?"Sertifikat Menunggu Persetujuan":"Daftar Sertifikat"}),"pending"===j?0===t.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(f.A,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"Tidak ada sertifikat yang menunggu persetujuan"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Permintaan sertifikat akan muncul di sini"})]}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow border-l-4 border-yellow-400",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-yellow-100 p-3 rounded-full",children:(0,a.jsx)(f.A,{className:"text-yellow-600",size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:e.user_name||"Unknown Student"}),(0,a.jsx)("p",{className:"text-gray-600",children:e.course_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["No: ",e.cert_number||e.certNumber||"N/A"]}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-2",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full font-medium",children:"Menunggu Persetujuan"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Diajukan"}),(0,a.jsx)("p",{className:"font-medium text-gray-800",children:L(e.created_at)})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>b(e),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Lihat Detail",children:(0,a.jsx)(d.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>z(e.id),disabled:v,className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors disabled:opacity-50",title:"Setujui",children:(0,a.jsx)(ev.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>M(e.id),disabled:v,className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors disabled:opacity-50",title:"Tolak",children:(0,a.jsx)(x.A,{size:16})})]})]})]})},e.id))}):0===o.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(ew.A,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 text-lg",children:"Tidak ada sertifikat ditemukan"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Sertifikat akan muncul setelah peserta menyelesaikan kursus"})]}):(0,a.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,a.jsx)("div",{className:"bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-full ".concat("approved"===e.status?"bg-green-100":"rejected"===e.status?"bg-red-100":"bg-yellow-100"),children:"approved"===e.status?(0,a.jsx)(I.A,{className:"text-green-600",size:24}):"rejected"===e.status?(0,a.jsx)(x.A,{className:"text-red-600",size:24}):(0,a.jsx)(f.A,{className:"text-yellow-600",size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:e.user_name||e.studentName||e.userName||"Unknown Student"}),(0,a.jsx)("p",{className:"text-gray-600",children:e.course_name||e.courseName}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["No: ",e.cert_number||e.certNumber||"N/A"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full font-medium ".concat("approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"approved"===e.status?"Disetujui":"rejected"===e.status?"Ditolak":"Menunggu Persetujuan"}),"rejected"===e.status&&e.rejection_reason&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",title:e.rejection_reason,children:["(Alasan: ",e.rejection_reason.length>30?e.rejection_reason.substring(0,30)+"...":e.rejection_reason,")"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"approved"===e.status?"Disetujui":"Diajukan"}),(0,a.jsx)("p",{className:"font-medium text-gray-800",children:L(e.approved_at||e.completion_date||e.completionDate||e.created_at)})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>b(e),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Lihat Detail",children:(0,a.jsx)(d.A,{size:16})}),"approved"===e.status&&(0,a.jsx)("button",{onClick:()=>E(e),className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Download",children:(0,a.jsx)(eN.A,{size:16})}),(null==k?void 0:k.role)==="admin"&&(0,a.jsx)("button",{onClick:()=>P(e.id),className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",title:"Hapus",children:(0,a.jsx)(V.A,{size:16})})]})]})]})},e.id))})]})]})]})}),p&&(0,a.jsx)(e=>{let{certificate:s,onClose:t}=e;return(0,a.jsx)("div",{className:"fixed text-gray-900 inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-3xl w-full overflow-hidden shadow-2xl",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r text-white p-6 ".concat("approved"===s.status?"from-green-400 via-green-500 to-green-600":"rejected"===s.status?"from-red-400 via-red-500 to-red-600":"from-yellow-400 via-yellow-500 to-yellow-600"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["approved"===s.status?(0,a.jsx)(I.A,{size:28}):"rejected"===s.status?(0,a.jsx)(x.A,{size:28}):(0,a.jsx)(f.A,{size:28}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Detail Sertifikat"})]}),(0,a.jsx)("button",{onClick:t,className:"bg-opacity-20 hover:bg-opacity-30 p-2 rounded-lg transition-all duration-200",children:"✕"})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"p-6 rounded-xl border-2 ".concat("approved"===s.status?"bg-gradient-to-br from-green-50 to-blue-50 border-green-300":"rejected"===s.status?"bg-gradient-to-br from-red-50 to-pink-50 border-red-300":"bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-300"),children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:["approved"===s.status?(0,a.jsx)(I.A,{className:"mx-auto text-green-500 mb-3",size:40}):"rejected"===s.status?(0,a.jsx)(x.A,{className:"mx-auto text-red-500 mb-3",size:40}):(0,a.jsx)(f.A,{className:"mx-auto text-yellow-500 mb-3",size:40}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"SERTIFIKAT PENYELESAIAN"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Certificate of Completion"}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("approved"===s.status?"bg-green-100 text-green-800":"rejected"===s.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"approved"===s.status?"Disetujui":"rejected"===s.status?"Ditolak":"Menunggu Persetujuan"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(n.A,{className:"text-blue-500",size:16}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"Nama Peserta"})]}),(0,a.jsx)("p",{className:"text-gray-800 font-medium",children:s.user_name||s.studentName||s.userName||"Unknown Student"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(T.A,{className:"text-green-500",size:16}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"Nama Kursus"})]}),(0,a.jsx)("p",{className:"text-gray-800 font-medium",children:s.course_name||s.courseName})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(I.A,{className:"text-purple-500",size:16}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"Nomor Sertifikat"})]}),(0,a.jsx)("p",{className:"text-gray-800 font-mono text-sm",children:s.cert_number||s.certNumber||"N/A"})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(ef.A,{className:"text-red-500",size:16}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"approved"===s.status?"Tanggal Disetujui":"Tanggal Diajukan"})]}),(0,a.jsx)("p",{className:"text-gray-800 font-medium",children:L(s.approved_at||s.completion_date||s.completionDate||s.created_at)})]}),"rejected"===s.status&&s.rejection_reason&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg col-span-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(x.A,{className:"text-red-500",size:16}),(0,a.jsx)("span",{className:"font-semibold text-sm",children:"Alasan Penolakan"})]}),(0,a.jsx)("p",{className:"text-gray-800",children:s.rejection_reason})]})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-3",children:["approved"===s.status&&(0,a.jsxs)("button",{onClick:()=>E(s),className:"px-4 py-2 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-lg hover:from-green-700 hover:to-blue-700 transition-all duration-200 flex items-center gap-2",children:[(0,a.jsx)(eN.A,{size:16}),"Download"]}),(null==k?void 0:k.role)==="admin"&&"pending"===s.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{t(),z(s.id)},disabled:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[(0,a.jsx)(ev.A,{size:16}),"Setujui"]}),(0,a.jsxs)("button",{onClick:()=>{t(),M(s.id)},disabled:v,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[(0,a.jsx)(x.A,{size:16}),"Tolak"]})]}),(0,a.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Tutup"})]})]})})]})})},{certificate:p,onClose:()=>b(null)})]})};var eC=t(17576);let eD=()=>{let{currentUser:e}=(0,l.A)(),[s,t]=(0,r.useState)({postWork:{title:"Post Work Assignment",description:"Complete the assigned post-work tasks to reinforce your learning.",requirements:["Submit your work in PDF, DOCX, or image format","Maximum file size: 10MB","Include detailed explanations of your approach","Follow the provided guidelines and rubric"],guidelines:"Please ensure your submission is well-organized and clearly demonstrates your understanding of the concepts covered in this module."},finalProject:{title:"Final Project",description:"Create a comprehensive project that demonstrates your mastery of the course material.",requirements:["Create a complete web application using the technologies learned in this course","Include proper documentation and README file","Implement responsive design for mobile and desktop","Submit as a ZIP file or provide GitHub repository link","Maximum file size: 50MB"],guidelines:"Your final project should showcase your ability to apply the concepts and skills learned throughout the course. Focus on creating a functional, well-designed application that solves a real-world problem."}}),[n,i]=(0,r.useState)({postWork:!1,finalProject:!1}),[o,d]=(0,r.useState)({}),[c,m]=(0,r.useState)("postWork");(0,r.useEffect)(()=>{x()},[]);let x=()=>{let e=localStorage.getItem("projectInstructions");e&&t(JSON.parse(e))},u=e=>{d({...s[e]}),i({...n,[e]:!0})},g=e=>{i({...n,[e]:!1}),d({})},h=e=>{t({...s,[e]:o}),i({...n,[e]:!1}),d({})},p=(e,s)=>{d({...o,[e]:s})},b=()=>{p("requirements",[...o.requirements||[],""])},j=(e,s)=>{let t=[...o.requirements];t[e]=s,p("requirements",t)},f=e=>{p("requirements",o.requirements.filter((s,t)=>t!==e))};return(null==e?void 0:e.role)!=="admin"?(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-red-800 mb-2",children:"Akses Ditolak"}),(0,a.jsx)("p",{className:"text-red-600",children:"Anda tidak memiliki izin untuk mengakses halaman ini."})]})}):(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Kelola Instruksi Proyek"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Kelola instruksi dan persyaratan untuk Post Work dan Final Project"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg mb-6",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"flex space-x-8 px-6",children:[(0,a.jsx)("button",{onClick:()=>m("postWork"),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("postWork"===c?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eC.A,{size:16}),(0,a.jsx)("span",{children:"Post Work"})]})}),(0,a.jsx)("button",{onClick:()=>m("finalProject"),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("finalProject"===c?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(T.A,{size:16}),(0,a.jsx)("span",{children:"Final Project"})]})})]})}),(0,a.jsx)("div",{className:"p-6",children:n[c]?(e=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul"}),(0,a.jsx)("input",{type:"text",value:o.title||"",onChange:e=>p("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Masukkan judul"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),(0,a.jsx)("textarea",{value:o.description||"",onChange:e=>p("description",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:3,placeholder:"Masukkan deskripsi"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Persyaratan"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(o.requirements||[]).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>j(s,e.target.value),className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Masukkan persyaratan"}),(0,a.jsx)("button",{onClick:()=>f(s),className:"text-red-500 hover:text-red-700 p-1",children:(0,a.jsx)(V.A,{size:16})})]},s)),(0,a.jsxs)("button",{onClick:b,className:"flex items-center space-x-1 text-indigo-600 hover:text-indigo-700 text-sm",children:[(0,a.jsx)(J.A,{size:16}),(0,a.jsx)("span",{children:"Tambah Persyaratan"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Panduan"}),(0,a.jsx)("textarea",{value:o.guidelines||"",onChange:e=>p("guidelines",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:4,placeholder:"Masukkan panduan untuk siswa"})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("button",{onClick:()=>h(e),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)(X.A,{size:16}),(0,a.jsx)("span",{children:"Simpan"})]}),(0,a.jsx)("button",{onClick:()=>g(e),className:"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300 transition-colors",children:"Batal"})]})]}))(c):(e=>{let t=s[e];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:t.title}),(0,a.jsxs)("button",{onClick:()=>u(e),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,a.jsx)(E.A,{size:16}),(0,a.jsx)("span",{children:"Edit"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Deskripsi"}),(0,a.jsx)("p",{className:"text-gray-600",children:t.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Persyaratan"}),(0,a.jsx)("ul",{className:"space-y-2",children:t.requirements.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-gray-600",children:e})]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Panduan"}),(0,a.jsx)("p",{className:"text-gray-600",children:t.guidelines})]})]})})(c)})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("button",{onClick:()=>{localStorage.setItem("projectInstructions",JSON.stringify(s)),alert("Instruksi berhasil disimpan!")},className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-3 rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 font-semibold flex items-center space-x-2 mx-auto",children:[(0,a.jsx)(X.A,{size:20}),(0,a.jsx)("span",{children:"Simpan Semua Perubahan"})]})})]})};var eP=t(16785);let ez=()=>{let{currentUser:e,courses:s}=(0,l.A)(),[t,n]=(0,r.useState)(""),[i,o]=(0,r.useState)("postwork"),[d,c]=(0,r.useState)({postwork:{title:"",description:"",requirements:[],deliverables:[],timeline:"",resources:[]},finalproject:{title:"",description:"",requirements:[],deliverables:[],timeline:"",resources:[]}}),[m,x]=(0,r.useState)(!1),[u,g]=(0,r.useState)(""),h=(null==e?void 0:e.role)==="admin";(0,r.useEffect)(()=>{t&&p(t)},[t]);let p=e=>{try{let s=localStorage.getItem("course_instructions_".concat(e));s?c(JSON.parse(s)):c({postwork:{title:"Post Work Assignment",description:"Silakan kerjakan tugas post work berikut untuk mempraktikkan materi yang telah dipelajari.",requirements:["Menyelesaikan semua materi pembelajaran","Memahami konsep dasar yang telah diajarkan"],deliverables:["Dokumen laporan hasil praktik","Screenshot atau bukti implementasi"],timeline:"7 hari setelah menyelesaikan materi",resources:["Materi pembelajaran yang telah dipelajari","Template dokumen (jika tersedia)"]},finalproject:{title:"Final Project",description:"Proyek akhir untuk mendemonstrasikan pemahaman komprehensif terhadap seluruh materi kursus.",requirements:["Menyelesaikan semua tahap pembelajaran","Menyelesaikan post work assignment"],deliverables:["Proyek lengkap sesuai spesifikasi","Dokumentasi proyek","Presentasi atau demo (jika diperlukan)"],timeline:"14 hari setelah menyelesaikan post work",resources:["Seluruh materi kursus","Template proyek (jika tersedia)","Panduan teknis"]}})}catch(e){console.error("Error loading course instructions:",e)}},b=async()=>{if(!t)return void g("Pilih course terlebih dahulu");x(!0),g("");try{let e="course_instructions_".concat(t);localStorage.setItem(e,JSON.stringify(d)),g("✅ Instruksi berhasil disimpan!"),setTimeout(()=>g(""),3e3)}catch(e){console.error("Error saving instructions:",e),g("❌ Gagal menyimpan instruksi")}finally{x(!1)}},j=(e,s,t)=>{c(a=>({...a,[e]:{...a[e],[s]:t}}))},f=(e,s)=>{c(t=>({...t,[e]:{...t[e],[s]:[...t[e][s],""]}}))},y=(e,s,t,a)=>{c(r=>{let l=[...r[e][s]];return l[t]=a,{...r,[e]:{...r[e],[s]:l}}})},N=(e,s,t)=>{c(a=>{let r=a[e][s].filter((e,s)=>s!==t);return{...a,[e]:{...a[e],[s]:r}}})},v=(e,s,t,r)=>{let l=d[e][s]||[];return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:t}),(0,a.jsxs)("button",{onClick:()=>f(e,s),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[(0,a.jsx)(J.A,{className:"w-4 h-4"}),"Tambah"]})]}),l.map((t,l)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:t,onChange:t=>y(e,s,l,t.target.value),placeholder:r,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:()=>N(e,s,l),className:"text-red-600 hover:text-red-800 p-2",children:(0,a.jsx)(V.A,{className:"w-4 h-4"})})]},l)),0===l.length&&(0,a.jsxs)("p",{className:"text-gray-500 text-sm italic",children:["Belum ada ",t.toLowerCase()]})]})};if(!h)return(0,a.jsx)("div",{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Akses Ditolak"}),(0,a.jsx)("p",{className:"text-red-600",children:"Hanya admin yang dapat mengakses halaman ini."})]})});let w=d[i];return(0,a.jsx)("div",{className:"max-w-6xl mx-auto p-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Kelola Instruksi Course"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Course"}),(0,a.jsxs)("select",{value:t,onChange:e=>n(e.target.value),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"-- Pilih Course --"}),s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),u&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-md bg-blue-50 border border-blue-200",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:u})})]}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"flex space-x-8 px-6",children:[(0,a.jsx)("button",{onClick:()=>o("postwork"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("postwork"===i?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"w-4 h-4"}),"Post Work"]})}),(0,a.jsx)("button",{onClick:()=>o("finalproject"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("finalproject"===i?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eP.A,{className:"w-4 h-4"}),"Final Project"]})})]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Edit Instruksi ","postwork"===i?"Post Work":"Final Project"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul"}),(0,a.jsx)("input",{type:"text",value:w.title,onChange:e=>j(i,"title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Masukkan judul instruksi"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),(0,a.jsx)("textarea",{value:w.description,onChange:e=>j(i,"description",e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Masukkan deskripsi instruksi"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timeline"}),(0,a.jsx)("input",{type:"text",value:w.timeline,onChange:e=>j(i,"timeline",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contoh: 7 hari setelah menyelesaikan materi"})]}),v(i,"requirements","Persyaratan","Masukkan persyaratan"),v(i,"deliverables","Deliverables","Masukkan deliverable"),v(i,"resources","Resources","Masukkan resource")]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Preview"}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,a.jsx)("h4",{className:"text-xl font-bold text-gray-900 mb-3",children:w.title||"Judul Instruksi"}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:w.description||"Deskripsi instruksi akan muncul di sini."}),w.timeline&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"⏰ Timeline:"}),(0,a.jsx)("p",{className:"text-gray-700",children:w.timeline})]}),w.requirements.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDCCB Persyaratan:"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:w.requirements.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},s))})]}),w.deliverables.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDCE6 Deliverables:"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:w.deliverables.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},s))})]}),w.resources.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"\uD83D\uDCDA Resources:"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:w.resources.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},s))})]})]})]})]}),(0,a.jsx)("div",{className:"mt-8 flex justify-end",children:(0,a.jsxs)("button",{onClick:b,disabled:m||!t,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-semibold",children:[(0,a.jsx)(X.A,{className:"w-5 h-5"}),m?"Menyimpan...":"Simpan Instruksi"]})})]})]})]})})};var eI=t(62559),eT=t(52918),eM=t(14711);let eE=()=>{let{currentUser:e,courses:s}=(0,l.A)(),[t,n]=(0,r.useState)(""),[i,o]=(0,r.useState)({hasPostWork:!1,hasFinalProject:!1,stepWeights:{intro:10,pretest:15,lessons:40,posttest:35,postwork:0,finalproject:0}}),[d,c]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[u,g]=(0,r.useState)(!1),h=(null==e?void 0:e.role)==="admin";(0,r.useEffect)(()=>{t&&p(t)},[t]);let p=async e=>{g(!0);try{let s=await fetch("".concat("https://api.mindshiftlearning.id","/api/protected/admin/courses/").concat(e,"/config"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken")),"Content-Type":"application/json"}});if(s.ok){let e=await s.json();o({hasPostWork:e.hasPostWork||!1,hasFinalProject:e.hasFinalProject||!1,stepWeights:e.stepWeights||{intro:10,pretest:15,lessons:40,posttest:35,postwork:0,finalproject:0}})}else console.error("Failed to load course config"),o({hasPostWork:!1,hasFinalProject:!1,stepWeights:{intro:10,pretest:15,lessons:40,posttest:35,postwork:0,finalproject:0}})}catch(e){console.error("Error loading course config:",e)}finally{g(!1)}},b=async()=>{if(!t)return void x("Pilih course terlebih dahulu");c(!0),x("");try{(await fetch("".concat("https://api.mindshiftlearning.id","/api/protected/admin/courses/").concat(t,"/config"),{method:"PUT",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken")),"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?(x("✅ Konfigurasi berhasil disimpan!"),setTimeout(()=>x(""),3e3)):x("❌ Gagal menyimpan konfigurasi")}catch(e){console.error("Error saving config:",e),x("❌ Gagal menyimpan konfigurasi")}finally{c(!1)}},j=(e,s)=>{o(t=>({...t,stepWeights:{...t.stepWeights,[e]:parseInt(s)||0}}))},f=e=>{o(s=>{let t={...s,[e]:!s[e]};if("hasPostWork"===e||"hasFinalProject"===e){let a={...s.stepWeights};"hasPostWork"===e&&(s.hasPostWork?(a.postwork=0,a.posttest=35):(a.postwork=10,a.posttest=25)),"hasFinalProject"===e&&(s.hasFinalProject?(a.finalproject=0,a.lessons=40):(a.finalproject=15,a.lessons=25)),t.stepWeights=a}return t})},y=()=>Object.values(i.stepWeights).reduce((e,s)=>e+s,0),N=e=>({intro:"Intro",pretest:"Pre Test",lessons:"Lessons",posttest:"Post Test",postwork:"Post Work",finalproject:"Final Project"})[e]||e;return h?(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-6 text-gray-900",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 p-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(M.A,{className:"w-6 h-6"}),"Konfigurasi Course"]}),(0,a.jsxs)("div",{className:"mb-4 text-gray-900",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Course"}),(0,a.jsxs)("select",{value:t,onChange:e=>n(e.target.value),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"-- Pilih Course --"}),s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),m&&(0,a.jsx)("div",{className:"mb-4 p-3 rounded-md bg-blue-50 border border-blue-200",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:m})})]}),t&&(0,a.jsx)("div",{className:"p-6",children:u?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Memuat konfigurasi..."})]}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Fitur Course"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Post Work"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Aktifkan tugas post work setelah post test"})]}),(0,a.jsx)("button",{onClick:()=>f("hasPostWork"),className:"flex items-center ".concat(i.hasPostWork?"text-green-600":"text-gray-400"),children:i.hasPostWork?(0,a.jsx)(eI.A,{className:"w-8 h-8"}):(0,a.jsx)(eT.A,{className:"w-8 h-8"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Final Project"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Aktifkan final project sebagai tahap terakhir"})]}),(0,a.jsx)("button",{onClick:()=>f("hasFinalProject"),className:"flex items-center ".concat(i.hasFinalProject?"text-green-600":"text-gray-400"),children:i.hasFinalProject?(0,a.jsx)(eI.A,{className:"w-8 h-8"}):(0,a.jsx)(eT.A,{className:"w-8 h-8"})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(eM.A,{className:"w-5 h-5"}),"Bobot Progress (%)"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[Object.entries(i.stepWeights).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"font-medium text-gray-900",children:N(s)}),("postwork"===s&&!i.hasPostWork||"finalproject"===s&&!i.hasFinalProject)&&(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"(Tidak aktif)"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"range",min:"0",max:"100",value:t,onChange:e=>j(s,e.target.value),className:"w-32",disabled:"postwork"===s&&!i.hasPostWork||"finalproject"===s&&!i.hasFinalProject}),(0,a.jsx)("input",{type:"number",min:"0",max:"100",value:t,onChange:e=>j(s,e.target.value),className:"w-16 px-2 py-1 border border-gray-300 rounded text-center",disabled:"postwork"===s&&!i.hasPostWork||"finalproject"===s&&!i.hasFinalProject}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"%"})]})]},s)}),(0,a.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium text-blue-900",children:"Total Bobot:"}),(0,a.jsxs)("span",{className:"font-bold text-lg ".concat(100===y()?"text-green-600":"text-red-600"),children:[y(),"%"]})]}),100!==y()&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"⚠️ Total bobot harus 100% untuk perhitungan progress yang akurat"})]})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:(0,a.jsxs)("button",{onClick:b,disabled:d||!t,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-semibold",children:[(0,a.jsx)(X.A,{className:"w-5 h-5"}),d?"Menyimpan...":"Simpan Konfigurasi"]})})]})})]})}):(0,a.jsx)("div",{className:"p-8 text-center",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Akses Ditolak"}),(0,a.jsx)("p",{className:"text-red-600",children:"Hanya admin yang dapat mengakses halaman ini."})]})})},eL=()=>{let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(""),[c,m]=(0,r.useState)([]),[x,u]=(0,r.useState)(!0),[g,h]=(0,r.useState)(null),[p,b]=(0,r.useState)({grade:"",feedback:""});(0,r.useEffect)(()=>{j(),f()},[]),(0,r.useEffect)(()=>{i&&N(i)},[i]);let j=async()=>{try{let e=await y.adminAPI.getGrades();e.success&&s(e.grades||[])}catch(e){console.error("Error loading grades:",e)}},f=async()=>{try{m([{id:1,title:"JavaScript Fundamentals"},{id:2,title:"React Development"},{id:3,title:"Node.js Backend"}])}catch(e){console.error("Error loading courses:",e)}finally{u(!1)}},N=async e=>{try{let s=await y.adminAPI.getCourseSubmissions(e);s.success&&l(s.submissions||[])}catch(e){console.error("Error loading submissions:",e)}},v=async e=>{h(e),b({grade:"",feedback:""})},w=async()=>{if(!p.grade||p.grade<0||p.grade>100)return void alert("Please enter a valid grade (0-100)");try{let e={userId:g.userId,courseId:g.courseId,submissionId:g.id,grade:parseFloat(p.grade),feedback:p.feedback};(await y.adminAPI.createGrade(e)).success&&(alert("Grade submitted successfully!"),h(null),b({grade:"",feedback:""}),j(),i&&N(i))}catch(e){console.error("Error submitting grade:",e),alert("Failed to submit grade. Please try again.")}};return x?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Grading System"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Course to Review Submissions"}),(0,a.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose a course..."}),c.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),i&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Submissions to Grade"}),0===t.length?(0,a.jsx)("p",{className:"text-gray-500",children:"No submissions found for this course."}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium",children:e.userName}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.type,")"]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:new Date(e.submittedAt).toLocaleDateString()})]}),e.fileName&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.fileName})]})]}),e.grade&&(0,a.jsxs)("div",{className:"mt-2 text-sm",children:[(0,a.jsxs)("span",{className:"text-green-600 font-medium",children:["Grade: ",e.grade,"/100"]}),e.feedback&&(0,a.jsxs)("p",{className:"text-gray-600 mt-1",children:["Feedback: ",e.feedback]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[!e.grade&&(0,a.jsx)("button",{onClick:()=>v(e),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Grade"}),(0,a.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition-colors",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]})]})},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Grades"}),0===e.length?(0,a.jsx)("p",{className:"text-gray-500",children:"No grades submitted yet."}):(0,a.jsx)("div",{className:"space-y-4",children:e.slice(0,10).map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium",children:e.userName}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["- ",e.courseTitle]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(eh.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"font-medium text-green-600",children:[e.grade,"/100"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:new Date(e.gradedAt).toLocaleDateString()})]})]}),e.feedback&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mt-2",children:e.feedback})]})})},e.id))})]})]}),g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Grade Submission"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,a.jsx)("strong",{children:"Student:"})," ",g.userName]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,a.jsx)("strong",{children:"Type:"})," ",g.type]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Description:"})," ",g.description]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade (0-100)"}),(0,a.jsx)("input",{type:"number",min:"0",max:"100",value:p.grade,onChange:e=>b({...p,grade:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter grade"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Feedback (Optional)"}),(0,a.jsx)("textarea",{value:p.feedback,onChange:e=>b({...p,feedback:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Enter feedback for the student"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3 mt-6",children:[(0,a.jsxs)("button",{onClick:w,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[(0,a.jsx)(X.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Submit Grade"})]}),(0,a.jsx)("button",{onClick:()=>h(null),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})})]})};var eF=t(54861);let eU=()=>{let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(""),[c,m]=(0,r.useState)("all"),[x,u]=(0,r.useState)(!0),[g,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{p()},[]),(0,r.useEffect)(()=>{i&&j()},[i,c]);let p=async()=>{try{let e=await y.GS.getAllCourses();e.success&&l(e.courses||[])}catch(e){console.error("Error loading courses:",e)}finally{u(!1)}},j=async()=>{if(i)try{u(!0);let e=await y.adminAPI.getCourseSubmissions(i);if(e.success){let t=e.submissions||[];"all"!==c&&(t=t.filter(e=>e.type===c)),s(t)}}catch(e){console.error("Error loading submissions:",e)}finally{u(!1)}},f=e=>{h(e)},N=async e=>{if(!e.fileName)return void alert("No file available for download");try{alert("Downloading: ".concat(e.fileName))}catch(e){console.error("Error downloading file:",e),alert("Failed to download file")}},v=(()=>{let s=e.length,t=e.filter(e=>null!==e.grade&&void 0!==e.grade).length;return{total:s,graded:t,pending:s-t}})();return x&&!i?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Submission Review"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Course"}),(0,a.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose a course..."}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Submission Type"}),(0,a.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Types"}),(0,a.jsx)("option",{value:"postwork",children:"Postwork"}),(0,a.jsx)("option",{value:"final_project",children:"Final Project"})]})]})]}),i&&(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(T.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Submissions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:v.total})]})]})}),(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(b.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Graded"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-900",children:v.graded})]})]})}),(0,a.jsx)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(eF.A,{className:"h-8 w-8 text-yellow-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:v.pending})]})]})})]}),i&&(0,a.jsx)("div",{children:x?(0,a.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(T.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No submissions found for the selected criteria."})]}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(n.A,{className:"h-5 w-5 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.userName}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full   {submission.type === 'postwork'    ? 'bg-blue-100 text-blue-800'    : 'bg-purple-100 text-purple-800'   }",children:"postwork"===e.type?"Postwork":"Final Project"}),null!==e.grade&&void 0!==e.grade&&(0,a.jsxs)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:["Graded: ",e.grade,"/100"]})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(ef.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:new Date(e.submittedAt).toLocaleDateString()})]}),e.fileName&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.fileName})]})]}),e.feedback&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 mb-1",children:[(0,a.jsx)(P.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Feedback:"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:e.feedback})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 ml-4",children:[(0,a.jsx)("button",{onClick:()=>f(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"View Details",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})}),e.fileName&&(0,a.jsx)("button",{onClick:()=>N(e),className:"p-2 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Download File",children:(0,a.jsx)(eN.A,{className:"h-4 w-4"})})]})]})},e.id))})})]}),g&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Submission Details"}),(0,a.jsx)("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(eF.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Student"}),(0,a.jsx)("p",{className:"text-gray-900",children:g.userName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),(0,a.jsx)("p",{className:"text-gray-900",children:"postwork"===g.type?"Postwork":"Final Project"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted"}),(0,a.jsx)("p",{className:"text-gray-900",children:new Date(g.submittedAt).toLocaleString()})]}),null!==g.grade&&void 0!==g.grade&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Grade"}),(0,a.jsxs)("p",{className:"text-gray-900",children:[g.grade,"/100"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,a.jsx)("div",{className:"bg-gray-50 p-3 rounded border",children:(0,a.jsx)("p",{className:"text-gray-900",children:g.description})})]}),g.fileName&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"File"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded border",children:[(0,a.jsx)(T.A,{className:"h-5 w-5 text-gray-500"}),(0,a.jsx)("span",{className:"text-gray-900",children:g.fileName}),(0,a.jsx)("button",{onClick:()=>N(g),className:"ml-auto px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Download"})]})]}),g.feedback&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Feedback"}),(0,a.jsx)("div",{className:"bg-gray-50 p-3 rounded border",children:(0,a.jsx)("p",{className:"text-gray-900",children:g.feedback})})]})]}),(0,a.jsx)("div",{className:"flex justify-end mt-6",children:(0,a.jsx)("button",{onClick:()=>h(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors",children:"Close"})})]})})]})};var eR=t(53904),eq=t(50430);let e_=e=>{let{courseId:s,courseName:t}=e,{currentUser:n,getStageLocks:o,updateStageLock:c}=(0,l.A)(),[m,x]=(0,r.useState)([]),[u,g]=(0,r.useState)(!0),[p,j]=(0,r.useState)(!1),[f,y]=(0,r.useState)(""),[N,v]=(0,r.useState)(""),[w,k]=(0,r.useState)(0),A={intro:{label:"Materi Pengantar",description:"Pengenalan dan overview course"},pretest:{label:"Pre-Test",description:"Tes awal sebelum pembelajaran"},lessons:{label:"Materi Pembelajaran",description:"Konten utama pembelajaran"},posttest:{label:"Post-Test",description:"Tes akhir setelah pembelajaran"},postwork:{label:"Tugas Akhir",description:"Tugas praktik setelah pembelajaran"},finalproject:{label:"Proyek Final",description:"Proyek akhir untuk menyelesaikan course"}},S=()=>Object.keys(A).map(e=>({id:Math.random(),courseId:parseInt(s),stageName:e,isLocked:!1,lockMessage:"",lockedBy:null,lockedAt:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}));(0,r.useEffect)(()=>{s&&C()},[s]);let C=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(g(!0),y(""),e){let e=S();x(e),y("Menggunakan data default. Koneksi ke server bermasalah.");return}let t=await o(s);if(t.success&&t.data)x(t.data),k(0);else throw Error(t.error||"Failed to load stage locks")}catch(e){console.error("Error loading stage locks:",e),w<2?(k(e=>e+1),setTimeout(()=>C(),2e3),y("Mencoba ulang... (".concat(w+1,"/3)"))):(x(S()),y("Koneksi bermasalah. Menggunakan data default. Error: ".concat(e.message)))}finally{g(!1)}},D=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{j(!0),y(""),v(""),x(s=>s.map(s=>s.stageName===e?{...s,isLocked:t,lockMessage:a,updatedAt:new Date().toISOString()}:s));let l=await c(s,e,t,a);if(l.success){var r;v("Stage ".concat(null==(r=A[e])?void 0:r.label," berhasil ").concat(t?"dikunci":"dibuka","!"));try{await C()}catch(e){console.warn("Failed to reload from server, keeping local state:",e)}}else throw Error(l.error||"Failed to update stage lock")}catch(s){console.error("Error updating stage lock:",s),x(s=>s.map(s=>s.stageName===e?{...s,isLocked:!t,lockMessage:"",updatedAt:new Date().toISOString()}:s)),y("Gagal memperbarui stage lock: ".concat(s.message))}finally{j(!1)}},P=async(e,s)=>{let t=!s,a="";t&&(a=prompt("Masukkan pesan untuk tahap yang dikunci (opsional):")||"Tahap ini masih dikunci oleh admin."),await D(e,t,a)},z=async(e,s)=>{let t=prompt("Masukkan pesan baru untuk tahap yang dikunci:",s)||s,a=m.find(s=>s.stageName===e);a&&t!==s&&await D(e,a.isLocked,t)};return n&&"admin"===n.role?u?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Memuat data stage locks..."})]})}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Kelola Akses Tahap Course"}),(0,a.jsxs)("p",{className:"text-gray-600 mt-1",children:["Course: ",(0,a.jsx)("span",{className:"font-medium",children:t})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Anda dapat mengunci atau membuka akses ke setiap tahap dalam course ini."})]}),(0,a.jsxs)("div",{className:"p-6",children:[f&&(0,a.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(h.A,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:f}),f.includes("Koneksi bermasalah")&&(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{k(0),C()},disabled:u,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center gap-1",children:[(0,a.jsx)(eR.A,{size:14}),"Coba Lagi"]}),(0,a.jsx)("button",{onClick:()=>{C(!0)},disabled:u,className:"px-3 py-1 text-sm bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Gunakan Default"})]})]}),N&&(0,a.jsxs)("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,a.jsx)(b.A,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:"Berhasil"})]}),(0,a.jsx)("p",{className:"text-green-600 mt-1",children:N})]}),(0,a.jsx)("div",{className:"space-y-4",children:Object.keys(A).map(e=>{let s=m.find(s=>s.stageName===e)||{stageName:e,isLocked:!1,lockMessage:""},t=A[e];return(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg ".concat(s.isLocked?"bg-red-100 text-red-600":"bg-green-100 text-green-600"),children:s.isLocked?(0,a.jsx)(i.A,{size:20}):(0,a.jsx)(eq.A,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:t.label}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t.description})]})]}),s.isLocked&&s.lockMessage&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("strong",{children:"Pesan:"})," ",s.lockMessage]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[s.isLocked&&(0,a.jsx)("button",{onClick:()=>z(e,s.lockMessage),disabled:p,className:"px-3 py-1 text-sm bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition-colors disabled:opacity-50",title:"Edit pesan kunci",children:(0,a.jsx)(d.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>P(e,s.isLocked),disabled:p,className:"px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 ".concat(s.isLocked?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"),children:p?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Menyimpan..."})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.isLocked?(0,a.jsx)(eq.A,{size:16}):(0,a.jsx)(i.A,{size:16}),(0,a.jsx)("span",{children:s.isLocked?"Buka":"Kunci"})]})})]})]})},e)})}),f&&f.includes("data default")&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(h.A,{size:20,className:"text-yellow-600 mt-0.5"}),(0,a.jsxs)("div",{className:"text-yellow-800",children:[(0,a.jsx)("p",{className:"font-medium",children:"Mode Offline:"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Saat ini menggunakan data default karena koneksi ke server bermasalah. Perubahan akan disimpan secara lokal dan akan disinkronkan ketika koneksi pulih."})]})]})}),(0,a.jsx)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(h.A,{size:20,className:"text-blue-600 mt-0.5"}),(0,a.jsxs)("div",{className:"text-blue-800",children:[(0,a.jsx)("p",{className:"font-medium",children:"Informasi Penting:"}),(0,a.jsxs)("ul",{className:"text-sm mt-1 space-y-1",children:[(0,a.jsx)("li",{children:"• Tahap yang dikunci tidak dapat diakses oleh siswa"}),(0,a.jsx)("li",{children:"• Admin tetap dapat mengakses semua tahap meskipun dikunci"}),(0,a.jsx)("li",{children:"• Pesan kunci akan ditampilkan kepada siswa yang mencoba mengakses tahap yang dikunci"}),(0,a.jsx)("li",{children:"• Perubahan akan langsung berlaku untuk semua siswa"}),f&&f.includes("data default")&&(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Mode Offline:"})," Perubahan disimpan lokal, akan disinkronkan saat koneksi pulih"]})]})]})]})})]})]}):(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(h.A,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:"Akses Ditolak"})]}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:"Hanya admin yang dapat mengakses fitur ini."})]})};var eO=t(33109);let eB=()=>{let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(""),[m,x]=(0,r.useState)("all"),[u,g]=(0,r.useState)("all"),[h,p]=(0,r.useState)([]),[b,j]=(0,r.useState)({totalAttempts:0,averagePreTestScore:0,averagePostTestScore:0,passRate:0});(0,r.useEffect)(()=>{console.log("TestResultsManager: Component mounted, loading data..."),f()},[]);let f=async()=>{try{console.log("TestResultsManager: Starting to load data..."),l(!0),i(""),console.log("TestResultsManager: Calling adminAPI.getTestResults()...");let e=await y.adminAPI.getTestResults();console.log("TestResultsManager: getTestResults response:",e),e&&e.success?(console.log("TestResultsManager: Test results data:",e.data),s(e.data||[]),N(e.data||[])):(console.warn("TestResultsManager: getTestResults failed or returned no success flag:",e),s([]),i("Gagal memuat data hasil test dari server")),console.log("TestResultsManager: Calling adminAPI.getAllCourses()...");let t=await y.adminAPI.getAllCourses();console.log("TestResultsManager: getAllCourses response:",t),t&&t.success?(console.log("TestResultsManager: Courses data:",t.data),p(t.data||[])):(console.warn("TestResultsManager: getAllCourses failed or returned no success flag:",t),p([]))}catch(e){console.error("TestResultsManager: Error loading test results:",e),console.error("TestResultsManager: Error details:",{message:e.message,stack:e.stack,response:e.response}),i(e.message||"Gagal memuat data hasil test. Silakan coba lagi.")}finally{console.log("TestResultsManager: Data loading completed"),l(!1)}},N=e=>{if(console.log("TestResultsManager: Calculating stats for results:",e),!e||0===e.length){console.log("TestResultsManager: No results found, setting empty stats"),j({totalAttempts:0,averagePreTestScore:0,averagePostTestScore:0,passRate:0});return}let s=e.filter(e=>"pretest"===e.quiz_type),t=e.filter(e=>"posttest"===e.quiz_type);console.log("TestResultsManager: PreTest results:",s.length),console.log("TestResultsManager: PostTest results:",t.length);let a=s.length>0?s.reduce((e,s)=>e+s.score,0)/s.length:0,r=t.length>0?t.reduce((e,s)=>e+s.score,0)/t.length:0,l=e.filter(e=>e.passed),n=e.length>0?l.length/e.length*100:0,i={totalAttempts:e.length,averagePreTestScore:Math.round(a),averagePostTestScore:Math.round(r),passRate:Math.round(n)};console.log("TestResultsManager: Calculated stats:",i),j(i)},v=e.filter(e=>{let s=(e.user_name||"").toLowerCase().includes(o.toLowerCase())||(e.course_title||"").toLowerCase().includes(o.toLowerCase())||(e.quiz_title||"").toLowerCase().includes(o.toLowerCase()),t="all"===m||e.quiz_type===m,a="all"===u||e.course_id.toString()===u;return s&&t&&a});return console.log("TestResultsManager: About to render JSX"),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Hasil Pre Test & Post Test"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Monitor dan analisis hasil test pengguna"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([["Nama Pengguna,Course,Jenis Test,Skor,Status,Waktu Pengerjaan,Tanggal",...v.map(e=>[e.user_name||"N/A",e.course_title||"N/A","pretest"===e.quiz_type?"Pre Test":"Post Test",e.score,e.passed?"Lulus":"Tidak Lulus","".concat(Math.floor(e.time_spent/60),":").concat((e.time_spent%60).toString().padStart(2,"0")),new Date(e.submitted_at).toLocaleDateString("id-ID")].join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),t=URL.createObjectURL(e);s.setAttribute("href",t),s.setAttribute("download","hasil_test_".concat(new Date().toISOString().split("T")[0],".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},disabled:t,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[(0,a.jsx)(eN.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]}),n&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:n}),t&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(C.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Attempts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b.totalAttempts})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(eO.A,{className:"h-6 w-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Pre Test"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[b.averagePreTestScore,"%"]})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(I.A,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Post Test"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[b.averagePostTestScore,"%"]})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(F.A,{className:"h-6 w-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pass Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[b.passRate,"%"]})]})]})})]}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(ek.A,{className:"h-4 w-4 inline mr-1"}),"Cari"]}),(0,a.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"Nama pengguna, course, atau quiz...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(eA.A,{className:"h-4 w-4 inline mr-1"}),"Jenis Test"]}),(0,a.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"Semua"}),(0,a.jsx)("option",{value:"pretest",children:"Pre Test"}),(0,a.jsx)("option",{value:"posttest",children:"Post Test"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(eA.A,{className:"h-4 w-4 inline mr-1"}),"Course"]}),(0,a.jsxs)("select",{value:u,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"Semua Course"}),h.map(e=>(0,a.jsx)("option",{value:e.id.toString(),children:e.title},e.id))]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:f,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pengguna"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jenis Test"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Skor"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Waktu"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===v.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:o||"all"!==m||"all"!==u?"Tidak ada hasil yang sesuai dengan filter.":"Belum ada hasil test yang tersedia."})}):v.map((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.user_name||"N/A"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.user_id]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.course_title||"N/A"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("pretest"===e.quiz_type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:"pretest"===e.quiz_type?"Pre Test":"Post Test"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.score,"%"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.correct_count,"/",e.total_count," benar"]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.passed?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.passed?"Lulus":"Tidak Lulus"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[Math.floor(e.time_spent/60),":",(e.time_spent%60).toString().padStart(2,"0")]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.submitted_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>{alert("Detail akan ditampilkan di modal")},className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})})]},"".concat(e.user_id,"-").concat(e.quiz_id,"-").concat(e.attempt_number)))})]})})}),v.length>0&&(0,a.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Menampilkan ",v.length," dari ",e.length," hasil test"]})})]})},eW=e=>{let{activeTab:s="overview"}=e;console.log("AdminDashboard: activeTab =",s);let{currentUser:t}=(0,l.A)(),[n,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[u,g]=(0,r.useState)(!0),[h,p]=(0,r.useState)(null),[b,j]=(0,r.useState)({totalCourses:0,totalLessons:0,totalStudents:0,completionRate:0,activeStudents:0,totalEnrollments:0});(0,r.useEffect)(()=>{(async()=>{try{let e=await y.adminAPI.getAllCourses();console.log("Courses API Response:",e),e&&e.success&&Array.isArray(e.data)?i(e.data):Array.isArray(e)?i(e):e&&Array.isArray(e.courses)?i(e.courses):(console.warn("Unexpected courses response format:",e),i([]));let s=await y.adminAPI.getDashboardStats();console.log("Dashboard Stats API Response:",s),s&&s.success&&s.stats?j(s.stats):console.warn("Unexpected stats response format:",s)}catch(e){console.error("Error loading data:",e),i([])}finally{g(!1)}})()},[]);let f=async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus course ini?"))try{await y.adminAPI.deleteCourse(e),i(n.filter(s=>s.id!==e)),alert("Course berhasil dihapus!")}catch(e){console.error("Error deleting course:",e),alert("Gagal menghapus course. Silakan coba lagi.")}},N=async e=>{try{if(m){let s=await y.adminAPI.updateCourse(m.id,e);s.success&&(i(n.map(e=>e.id===m.id?s.course:e)),alert("Course berhasil diperbarui!"))}else{let s=await y.adminAPI.createCourse(e);s.success&&(i([...n,s.course]),alert("Course berhasil dibuat!"))}c(!1),x(null)}catch(e){console.error("Error saving course:",e),alert("Gagal menyimpan course. Silakan coba lagi.")}};return(Array.isArray(n)&&n.length,Array.isArray(n)&&n.reduce((e,s)=>s&&s.lessons&&Array.isArray(s.lessons)?e+s.lessons.length:e,0),u)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):o?(0,a.jsx)(ec,{course:m,onSave:N,onCancel:()=>{c(!1),x(null)}}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your courses and monitor progress"})]}),(0,a.jsxs)("button",{onClick:()=>{x(null),c(!0)},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"Add Course"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(G.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Courses"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b.totalCourses})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(d.A,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Lessons"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b.totalLessons})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(F.A,{className:"h-6 w-6 text-purple-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:b.totalStudents})]})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(C.A,{className:"h-6 w-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completion Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[b.completionRate,"%"]})]})]})})]}),(0,a.jsxs)("div",{className:"mt-6",children:[console.log("AdminDashboard: Rendering tab content, activeTab =",s),"overview"===s&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-3"}),'Course "JavaScript Fundamentals" was updated']}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-3"}),'New student enrolled in "React Development"']}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full mr-3"}),"Quiz completed by 5 students"]})]})]})}),"courses"===s&&(0,a.jsx)(em,{courses:n,onEdit:e=>{x(e),c(!0)},onDelete:f}),"quizzes"===s&&(0,a.jsx)(eg,{courses:n}),"surveys"===s&&(0,a.jsx)(ep,{courses:n}),"stage-management"===s&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Kelola Akses Tahap Course"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Pilih course untuk mengelola akses tahap-tahapnya:"}),(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-100 rounded text-sm",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Debug Info:"})}),(0,a.jsxs)("p",{children:["Courses Array: ",Array.isArray(n)?"Yes":"No"]}),(0,a.jsxs)("p",{children:["Courses Length: ",Array.isArray(n)?n.length:"N/A"]}),(0,a.jsxs)("p",{children:["Loading: ",u?"Yes":"No"]}),(0,a.jsxs)("p",{children:["Courses Data: ",JSON.stringify(n,null,2)]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:Array.isArray(n)&&n.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]}),(0,a.jsx)("button",{onClick:()=>p(e),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Kelola Tahap"})]})},e.id))}),Array.isArray(n)&&0===n.length&&(0,a.jsx)("p",{className:"text-gray-500 text-center py-8",children:"Belum ada course yang tersedia."})]}),h&&(0,a.jsx)(e_,{courseId:h.id,courseName:h.title})]}),"announcements"===s&&(0,a.jsx)(ey,{}),"certificates"===s&&(0,a.jsx)(eS,{}),"project-instructions"===s&&(0,a.jsx)(eD,{}),"course-instructions"===s&&(0,a.jsx)(ez,{}),"course-config"===s&&(0,a.jsx)(eE,{}),"users"===s&&(0,a.jsx)(eb,{}),"test-results"===s&&(0,a.jsxs)("div",{children:[console.log("AdminDashboard: Rendering TestResultsManager"),(0,a.jsx)(eB,{})]}),"grading"===s&&(0,a.jsx)(eL,{}),"submissions"===s&&(0,a.jsx)(eU,{}),"students"===s&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Student Management"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Student management features will be implemented here."})]})]})]})},eJ=e=>{let{currentUser:s}=(0,l.A)(),[t,a]=(0,r.useState)({currentStep:"intro",completedSteps:[],lessonProgress:{},quizScores:{},submissions:{},lastAccessed:null,totalTimeSpent:0,startedAt:null,completedAt:null,isCompleted:!1}),[n,i]=(0,r.useState)(null),[o,d]=(0,r.useState)(!0),[c,m]=(0,r.useState)("saved"),x=(0,r.useCallback)(async t=>{if(e&&s)try{m("saving"),new Date().toISOString(),await (0,y.rT)({courseId:parseInt(e),currentStep:t.currentStep,completedSteps:t.completedSteps,lessonProgress:t.lessonProgress,quizScores:t.quizScores,submissions:t.submissions,totalTimeSpent:t.totalTimeSpent,completedAt:t.completedAt}),m("saved"),setTimeout(()=>m("idle"),2e3)}catch(e){console.error("Error saving progress to backend:",e),m("error")}},[e,s]),u=(0,r.useCallback)(e=>{a(s=>{let t={...s,...e};return m("pending"),x(t),t})},[x]),g=(0,r.useCallback)(e=>{a(s=>{let t={...s,completedSteps:[...new Set([...s.completedSteps,e])]};return m("pending"),x(t),t})},[x]),h=(0,r.useCallback)(e=>{u({currentStep:e})},[u]),p=(0,r.useCallback)(async(e,s)=>{a(t=>{let a={...t,lessonProgress:{...t.lessonProgress,[e]:{...t.lessonProgress[e],...s,lastAccessed:new Date().toISOString()}}};return m("pending"),x(a),a})},[x]),b=(0,r.useCallback)(function(e,s){var a;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=r?"pretest_".concat(e):"posttest_".concat(e);console.log("Saving quiz score:",{quizId:e,score:s,isPreTest:r,quizKey:l,currentQuizScores:t.quizScores}),u({quizScores:{...t.quizScores,[l]:{score:s,completedAt:new Date().toISOString(),attempts:((null==(a=t.quizScores[l])?void 0:a.attempts)||0)+1}}})},[t.quizScores,u]),j=(0,r.useCallback)((e,s)=>{u({submissions:{...t.submissions,[e]:{...s,submittedAt:new Date().toISOString()}}})},[t.submissions,u]),f=(0,r.useCallback)(()=>{let e=["intro","pretest","lessons","posttest","postwork","finalproject"];e.every(e=>t.completedSteps.includes(e))?u({completedAt:new Date().toISOString(),isCompleted:!0}):console.warn("Cannot mark course as completed - not all steps are finished:",{completedSteps:t.completedSteps,missingSteps:e.filter(e=>!t.completedSteps.includes(e))})},[u,t.completedSteps]),N=(0,r.useCallback)(()=>{let e={intro:5,pretest:10,lessons:50,posttest:15,postwork:10,finalproject:10};n&&n.stepWeights&&(e={...e,...n.stepWeights});let s=0;return t.completedSteps.forEach(t=>{e[t]&&(s+=e[t])}),Math.min(s,100)},[t.completedSteps,n]),v=(0,r.useCallback)(()=>{let e=["intro","pretest","lessons","posttest"];return(null==n?void 0:n.hasPostWork)&&e.push("postwork"),(null==n?void 0:n.hasFinalProject)&&e.push("finalproject"),e.every(e=>t.completedSteps.includes(e))},[t.completedSteps,n]),w=(0,r.useCallback)(()=>{if(!t.startedAt)return 0;let e=new Date(t.startedAt);return Math.round(((t.completedAt?new Date(t.completedAt):new Date)-e)/6e4)},[t.startedAt,t.completedAt]),k=(0,r.useCallback)(async()=>{let t={currentStep:"intro",completedSteps:[],lessonProgress:{},quizScores:{},submissions:{},lastAccessed:new Date().toISOString(),totalTimeSpent:0,startedAt:new Date().toISOString(),completedAt:null,isCompleted:!1};if(a(t),e&&s)try{await (0,y.rT)({courseId:parseInt(e),currentStep:t.currentStep,completedSteps:t.completedSteps,lessonProgress:t.lessonProgress,quizScores:t.quizScores,submissions:t.submissions,totalTimeSpent:t.totalTimeSpent,completedAt:t.completedAt})}catch(e){console.error("Failed to reset progress in backend:",e)}},[e,s]);return(0,r.useEffect)(()=>{(async()=>{if(e&&(null==s?void 0:s.id))try{d(!0);let[s,t]=await Promise.all([(0,y.Hb)(e),fetch("".concat("https://api.mindshiftlearning.id","/api/public/courses/").concat(e)).then(e=>e.json())]);if(t&&t.success&&t.data){let e=t.data;i({hasPostWork:e.hasPostWork,hasFinalProject:e.hasFinalProject,certificateDelay:e.certificateDelay,stepWeights:e.stepWeights})}if(s&&s.success&&s.data){let e=s.data,t={currentStep:e.currentStep||"intro",completedSteps:e.completedSteps||[],lessonProgress:e.lessonProgress||{},quizScores:e.quizScores||{},submissions:e.submissions||{},lastAccessed:new Date().toISOString(),totalTimeSpent:e.totalTimeSpent||0,startedAt:e.startedAt||new Date().toISOString(),completedAt:e.completedAt||null,isCompleted:!!e.completedAt};a(t)}else{let e={currentStep:"intro",completedSteps:[],lessonProgress:{},quizScores:{},submissions:{},lastAccessed:new Date().toISOString(),totalTimeSpent:0,startedAt:new Date().toISOString(),completedAt:null,isCompleted:!1};a(e)}}catch(e){console.error("Failed to load course data from backend:",e),a({currentStep:"intro",completedSteps:[],lessonProgress:{},quizScores:{},submissions:{},lastAccessed:new Date().toISOString(),totalTimeSpent:0,startedAt:new Date().toISOString(),completedAt:null,isCompleted:!1})}finally{d(!1)}})()},[e,null==s?void 0:s.id]),(0,r.useEffect)(()=>{let e=setInterval(()=>{"pending"===c&&a(e=>(e.lastAccessed&&x(e),e))},3e4);return()=>clearInterval(e)},[x,c]),{progress:t,courseConfig:n,isLoading:o,autoSaveStatus:c,updateProgress:u,markStepCompleted:g,setCurrentStep:h,updateLessonProgress:p,saveQuizScore:b,saveSubmission:j,markCourseCompleted:f,getCompletionPercentage:N,isCourseCompleted:v,getTimeSpent:w,resetProgress:k}},eG=(e,s)=>{let{currentUser:t,getCourseById:a}=(0,l.A)(),[n,i]=(0,r.useState)(null),[o,d]=(0,r.useState)([]),[c,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),p=(0,r.useRef)(t),b=(0,r.useRef)(e),j=(0,r.useRef)(s);(0,r.useEffect)(()=>{p.current=t},[t]),(0,r.useEffect)(()=>{b.current=e},[e]),(0,r.useEffect)(()=>{j.current=s},[s]);let f=(0,r.useCallback)(async()=>{if(p.current){if(g)return void console.log("Already loading certificates, skipping...");h(!0);try{console.log("Loading certificates from backend...");let e=await (0,y.UV)();e.success&&e.certificates?(console.log("Certificates loaded:",e.certificates),d(e.certificates)):(console.log("No certificates found or invalid response:",e),d([]))}catch(e){console.error("Error loading certificates from backend:",e),d([])}finally{h(!1)}}},[]),N=(0,r.useCallback)(async()=>{if(b.current&&p.current){if(!j.current&&0!==j.current)return void console.log("User not enrolled or no progress data available, skipping backend progress load");try{let e=await (0,y.Hb)(b.current);e&&e.data?i(s=>JSON.stringify(s)!==JSON.stringify(e.data)?e.data:s):i(s=>JSON.stringify(s)!==JSON.stringify(e)?e:s)}catch(e){console.log("Backend progress not available (user may not be enrolled):",e.message),i(null)}}},[]),v=(0,r.useCallback)(()=>{let e=j.current;if(!e&&0!==e)return m(e=>!1===e&&e),!1;let s=e>=100;return console.log("Certificate eligibility check:",{userProgress:e,eligible:s,courseId:b.current,hasBackendProgress:!!n}),m(e=>e!==s?s:e),s},[]),w=(0,r.useCallback)(()=>n&&n.overall_progress?Math.round(n.overall_progress):j.current||0,[n]);(0,r.useCallback)(()=>{if(n&&n.time_spent){let e=Math.round(n.time_spent/60);return e<1?"< 1 jam":"".concat(e," jam")}return"0 jam"},[n]);let k=(0,r.useCallback)(async e=>{if(console.log("generateCertificateForCourse called with:",{targetCourseId:e,currentUser:!!p.current}),!p.current||!e)return void console.log("Cannot request certificate: missing data");u(!0);try{console.log("Requesting certificate via backend API for course:",e);let s=await (0,y.requestCertificate)(e);if(s.success)return console.log("Certificate request submitted successfully:",s.message),await f(),u(!1),s;return console.error("Failed to request certificate:",s),u(!1),null}catch(e){throw console.error("Error requesting certificate:",e),u(!1),e}},[f]),A=(0,r.useCallback)(e=>o.find(s=>s.courseId===parseInt(e)),[o]);return(0,r.useEffect)(()=>{(null==t?void 0:t.id)&&f()},[null==t?void 0:t.id]),(0,r.useEffect)(()=>{e&&(null==t?void 0:t.id)&&void 0!==s&&N()},[e,null==t?void 0:t.id,s]),(0,r.useEffect)(()=>{void 0!==s&&v()},[s]),(0,r.useEffect)(()=>{if(!c||!e||x||!(null==t?void 0:t.id)||o.find(s=>s.courseId===parseInt(e)))return;console.log("Auto-requesting certificate in 5 seconds...");let s=setTimeout(()=>{k(e).catch(console.error)},5e3);return()=>clearTimeout(s)},[c,e,x,null==t?void 0:t.id,o.length]),{certificates:o,isEligible:c,isGenerating:x,isLoading:g,generateCertificate:k,getCertificateForCourse:A,calculateFinalGrade:w,checkEligibility:v,loadCertificates:f}};var eK=t(89140),eV=t(15968),eQ=t(85690),eY=t(33786),eH=t(90792);let eX=e=>{let{item:s,fileUrls:t}=e;console.log("=== VideoPlayer RENDERED ==="),console.log("Item:",s),console.log("FileUrls:",t);let[l,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(0),m=(0,r.useRef)(null),x=e=>{var s,t,a;if(!e)return null;if(e.includes("youtube.com/embed/"))return e;if(e.includes("youtube.com/watch?v=")){let t=null==(s=e.split("v=")[1])?void 0:s.split("&")[0];return t?"https://www.youtube.com/embed/".concat(t):null}if(e.includes("youtu.be/")){let s=null==(t=e.split("youtu.be/")[1])?void 0:t.split("?")[0];return s?"https://www.youtube.com/embed/".concat(s):null}if(e.includes("vimeo.com/")){let s=null==(a=e.split("vimeo.com/")[1])?void 0:a.split("?")[0];return s?"https://player.vimeo.com/video/".concat(s):null}return e},u=(()=>{if("upload"===s.uploadMethod&&s.fileId&&t[s.fileId])return{type:"upload",url:t[s.fileId]};let e=s.src||s.url||s.videoUrl;return e?{type:"embed",url:x(e),originalUrl:e}:null})(),g=()=>{o(!1),n(!0)};return((0,r.useEffect)(()=>{n(!1),o(!0)},[s,t]),console.log("VideoPlayer Debug:",{item:s,videoSource:u,fileUrls:s.fileId?{[s.fileId]:t[s.fileId]}:{},isLoading:i,videoError:l,retryCount:d}),console.log("Video URL Details:",{"item.src":s.src,"item.url":s.url,"item.videoUrl":s.videoUrl,uploadMethod:s.uploadMethod,fileId:s.fileId,fileUrl:s.fileId?t[s.fileId]:null,normalizedUrl:null==u?void 0:u.url,originalUrl:null==u?void 0:u.originalUrl,videoType:null==u?void 0:u.type}),u)?(0,a.jsxs)("div",{className:"relative bg-black rounded-lg overflow-hidden shadow-lg",style:{paddingBottom:"56.25%"},children:[i&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-75 z-10",children:(0,a.jsxs)("div",{className:"text-center text-white",children:[(0,a.jsx)(eR.A,{className:"w-8 h-8 animate-spin mx-auto mb-2"}),(0,a.jsx)("p",{children:"Loading video..."})]})}),l&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-75 z-10",children:(0,a.jsxs)("div",{className:"text-center text-white p-6",children:[(0,a.jsx)(h.A,{className:"w-12 h-12 mx-auto mb-4 text-red-400"}),(0,a.jsx)("p",{className:"mb-4",children:"Gagal memuat video"}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(n(!1),o(!0),c(e=>e+1),m.current){let e=m.current.src;m.current.src="",setTimeout(()=>{m.current.src=e},100)}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(eR.A,{className:"w-4 h-4 inline mr-2"}),"Coba Lagi"]}),(u.originalUrl||u.url)&&(0,a.jsxs)("button",{onClick:()=>{((null==u?void 0:u.originalUrl)||(null==u?void 0:u.url))&&window.open(u.originalUrl||u.url,"_blank")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(eY.A,{className:"w-4 h-4 inline mr-2"}),"Buka di Tab Baru"]})]})]})}),"upload"===u.type?(0,a.jsx)("video",{src:u.url,className:"absolute top-0 left-0 w-full h-full",controls:!0,title:s.title,onLoadStart:()=>o(!0),onLoadedData:()=>o(!1),onError:g,children:"Your browser does not support the video tag."}):(0,a.jsx)("iframe",{ref:m,src:"".concat(u.url).concat(u.url.includes("?")?"&":"?","enablejsapi=1&origin=").concat(encodeURIComponent(window.location.origin)),className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,title:s.title,onLoad:()=>{o(!1),n(!1)},onError:g})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 bg-gray-100 rounded-lg",children:[(0,a.jsx)(h.A,{className:"w-12 h-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 text-center mb-2",children:"Video tidak tersedia"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["Debug: ",JSON.stringify({src:s.src,url:s.url,videoUrl:s.videoUrl,uploadMethod:s.uploadMethod,fileId:s.fileId},null,2)]})]})},eZ=e=>{let{item:s,fileUrls:t}=e,r="upload"===s.uploadMethod&&s.fileId?t[s.fileId]:s.embedUrl||s.downloadUrl||s.url,l=s.title||"PDF Document";return s.filename,(0,a.jsxs)("div",{style:{margin:"20px 0",padding:"20px",border:"2px dashed #ccc",borderRadius:"8px",background:"#f9f9f9",textAlign:"center"},children:[(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("span",{style:{fontSize:"24px",marginRight:"8px"},children:"\uD83D\uDCC4"}),(0,a.jsx)("strong",{style:{color:"#333"},children:l})]}),(0,a.jsx)("p",{style:{color:"#666",marginBottom:"20px",fontSize:"14px"}}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[(0,a.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{color:"#fff",background:"#3b82f6",padding:"10px 16px",borderRadius:"6px",textDecoration:"none",display:"inline-flex",alignItems:"center",fontSize:"14px",fontWeight:"500"},children:"\uD83D\uDD17 Buka PDF di Tab Baru"}),(0,a.jsx)("a",{href:r,download:!0,style:{color:"#fff",background:"#10b981",padding:"10px 16px",borderRadius:"6px",textDecoration:"none",display:"inline-flex",alignItems:"center",fontSize:"14px",fontWeight:"500"},children:"⬇️ Download PDF"})]})]})},e$=e=>{let{material:s,onComplete:t}=e,[l,n]=(0,r.useState)({});return(0,r.useEffect)(()=>{(async()=>{if(!s||!s.content||!Array.isArray(s.content))return;let e={};for(let t of s.content)if(t.fileId&&"upload"===t.uploadMethod)try{let s=await ea(t.fileId);s&&(e[t.fileId]=el(s))}catch(e){console.error("Error loading file:",e)}n(e)})()},[s]),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(S.A,{className:"text-white",size:32})}),(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Materi Pengantar"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm sm:text-base",children:"Pelajari konsep dasar sebelum memulai pembelajaran utama"})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8 mb-8",children:(0,a.jsx)("div",{className:"prose prose-lg max-w-none",children:s.content?"string"==typeof s.content?(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:s.content}}):(e=>Array.isArray(e)?e.map((e,s)=>{if(!e||"object"!=typeof e)return console.warn("Invalid content item:",e),null;switch(e.type){case"text":return(0,a.jsx)("div",{className:"text-gray-700 mb-4 leading-relaxed",children:(0,a.jsx)(eH.oz,{children:e.content})},s);case"image":return(0,a.jsxs)("div",{className:"my-6",children:[(0,a.jsx)("img",{src:e.src,alt:e.alt,className:"w-full max-w-2xl mx-auto rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",loading:"lazy"}),e.caption&&(0,a.jsx)("p",{className:"text-center text-sm text-gray-600 mt-2 italic",children:e.caption})]},s);case"list":return(0,a.jsxs)("div",{className:"mb-4",children:[e.ordered?(0,a.jsxs)("div",{className:"flex items-start space-x-2 mb-2",children:[(0,a.jsx)(eK.A,{className:"text-blue-600 mt-1 flex-shrink-0",size:18}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Langkah-langkah:"})]}):(0,a.jsxs)("div",{className:"flex items-start space-x-2 mb-2",children:[(0,a.jsx)(eV.A,{className:"text-blue-600 mt-1 flex-shrink-0",size:18}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Poin-poin penting:"})]}),e.ordered?(0,a.jsx)("ol",{className:"list-decimal list-inside mb-4 space-y-2 pl-2",children:e.items.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:(0,a.jsx)(eH.oz,{components:{p:e=>{let{node:s,...t}=e;return(0,a.jsx)("span",{...t})}},children:e})},s))}):(0,a.jsx)("ul",{className:"list-disc list-inside mb-4 space-y-2 pl-2",children:e.items.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:(0,a.jsx)(eH.oz,{components:{p:e=>{let{node:s,...t}=e;return(0,a.jsx)("span",{...t})}},children:e})},s))})]},s);case"video":return(0,a.jsx)("div",{className:"my-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-white/20 rounded-lg p-2",children:(0,a.jsx)(eQ.A,{className:"text-white",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-white",children:e.title||"Video Pembelajaran"}),e.description&&(0,a.jsx)("p",{className:"text-red-100 text-sm mt-1",children:e.description}),e.duration&&(0,a.jsxs)("p",{className:"text-red-100 text-sm mt-1",children:["Durasi: ",e.duration]})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eX,{item:e,fileUrls:l})})]})},s);case"pdf":return(0,a.jsx)("div",{className:"my-8",children:(0,a.jsx)(eZ,{item:e,fileUrls:l})},s);case"external_link":return(0,a.jsx)("div",{className:"my-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-white/20 rounded-lg p-2",children:(0,a.jsx)(eY.A,{className:"text-white",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-white",children:e.title||"Link Eksternal"}),e.description&&(0,a.jsx)("p",{className:"text-green-100 text-sm mt-1",children:e.description})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(eY.A,{className:"text-green-600",size:20}),(0,a.jsx)("span",{className:"font-medium text-gray-900 truncate",children:e.url})]}),(0,a.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium flex-shrink-0 ml-4",children:[(0,a.jsx)(eY.A,{className:"mr-2 h-4 w-4"}),"Kunjungi"]})]})})]})},s);default:return console.warn("Unknown content type:",e.type,e),(0,a.jsxs)("div",{className:"my-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-yellow-800",children:["Unsupported content type: ",e.type]}),(0,a.jsx)("pre",{className:"text-xs text-yellow-600 mt-2",children:JSON.stringify(e,null,2)})]},s)}}):"string"==typeof e?e.split("\n").map((e,s)=>{if(e.startsWith("# "))return(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-4 mt-6 first:mt-0",children:e.substring(2)},s);if(e.startsWith("## "))return(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-3 mt-6",children:e.substring(3)},s);if(e.startsWith("### "))return(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-2 mt-4",children:e.substring(4)},s);if(e.trim().startsWith("![")&&e.includes("](")&&e.includes(")")){let t=e.match(/!\[([^\]]*)\]\(([^\)]+)\)/);if(t){let[,e,r]=t;return(0,a.jsxs)("div",{className:"my-6",children:[(0,a.jsx)("img",{src:r,alt:e,className:"w-full max-w-2xl mx-auto rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",loading:"lazy"}),e&&(0,a.jsx)("p",{className:"text-center text-sm text-gray-600 mt-2 italic",children:e})]},s)}}if(e.trim().startsWith("[VIDEO:")&&e.includes("](")&&e.includes(")")){let t=e.match(/\[VIDEO:\s*([^\]]+)\]\(([^\)]+)\)/);if(t){let[,e,r]=t;return(0,a.jsxs)("div",{className:"my-8 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border border-purple-200",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center",children:[(0,a.jsx)(eQ.A,{className:"mr-2",size:20}),e]}),(0,a.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden",children:(0,a.jsx)("iframe",{src:r,title:e,className:"w-full h-full",allowFullScreen:!0})})]},s)}}return""===e.trim()?(0,a.jsx)("br",{},s):(0,a.jsx)("p",{className:"mb-3 text-sm sm:text-base leading-relaxed text-gray-700",children:e},s)}):null)(s.content):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(T.A,{className:"mx-auto text-gray-400 mb-4",size:48}),(0,a.jsx)("p",{className:"text-gray-500",children:"Materi pengantar belum tersedia"})]})})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{onClick:t,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl",children:"Lanjut ke Pre-Test"})})]})},e0=(window.location.hostname,"".concat("https://api.mindshiftlearning.id","/api/protected")),e2=()=>en.Ar.getItem("authToken"),e1=()=>{let e=e2();return{"Content-Type":"application/json",Authorization:e?"Bearer ".concat(e):""}},e6=async e=>{if(!e.ok)throw Error(await e.text()||"HTTP error! status: ".concat(e.status));return e.json()},e4={getQuiz:async(e,s)=>{try{let t=await fetch("".concat(e0,"/courses/").concat(e,"/quiz/").concat(s),{method:"GET",headers:e1()});return await e6(t)}catch(e){throw console.error("Error getting quiz:",e),e}},startQuizAttempt:async(e,s)=>{try{let t=await fetch("".concat(e0,"/courses/").concat(e,"/quiz/").concat(s,"/start"),{method:"POST",headers:e1()});return await e6(t)}catch(e){throw console.error("Error starting quiz attempt:",e),e}},submitQuizAttempt:async(e,s,t)=>{try{let a=await fetch("".concat(e0,"/quiz/attempts/").concat(e,"/submit"),{method:"POST",headers:e1(),body:JSON.stringify({answers:s,timeSpent:t})});return await e6(a)}catch(e){throw console.error("Error submitting quiz:",e),e}},getQuizAttempts:async(e,s)=>{try{let t=await fetch("".concat(e0,"/courses/").concat(e,"/quiz/").concat(s,"/attempts"),{method:"GET",headers:e1()});return await e6(t)}catch(e){throw console.error("Error getting quiz attempts:",e),e}},getQuizResult:async e=>{try{let s=await fetch("".concat(e0,"/quiz/attempts/").concat(e,"/result"),{method:"GET",headers:e1()});return await e6(s)}catch(e){throw console.error("Error getting quiz result:",e),e}}},e3=e=>{let{courseId:s,quizType:t,onComplete:l,onBack:n}=e,[i,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[m,x]=(0,r.useState)(0),[u,g]=(0,r.useState)({}),[h,p]=(0,r.useState)(0),[b,j]=(0,r.useState)(0),[f,y]=(0,r.useState)(!1),[N,v]=(0,r.useState)(null),[w,k]=(0,r.useState)(!0),[A,S]=(0,r.useState)(null),[C,D]=(0,r.useState)(null),[P,z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=async()=>{try{k(!0),S(null);let e=await e4.getQuiz(s,t);if(e.success){o(e.data);let a=await e4.getQuizAttempts(s,t);if(a.success&&a.data&&a.data.length>0){let s=a.data[0];if(s.completed){let e=await e4.getQuizResult(s.id);e.success&&(v(e.data),z(!0))}else{c(s),g(s.answers||{}),D(new Date(s.startedAt));let t=Math.floor((Date.now()-new Date(s.startedAt))/1e3),a=Math.max(0,60*e.data.timeLimit-t);p(a),j(t)}}}}catch(e){console.error("Error loading quiz:",e),S("Failed to load quiz. Please try again.")}finally{k(!1)}};s&&t&&e()},[s,t]),(0,r.useEffect)(()=>{if(d&&!P&&"pretest"!==t&&"posttest"!==t){if(h>0){let e=setInterval(()=>{p(e=>e<=1?(M(),0):e-1),j(e=>e+1)},1e3);return()=>clearInterval(e)}}else if(d&&!P){let e=setInterval(()=>{j(e=>e+1)},1e3);return()=>clearInterval(e)}},[d,h,P,t]);let I=async()=>{try{k(!0),S(null);let e=await e4.startQuizAttempt(s,t);e.success&&(c(e.data),g({}),x(0),p(60*i.timeLimit),j(0),D(new Date),z(!1))}catch(e){console.error("Error starting quiz:",e),S(e.message||"Failed to start quiz. Please try again.")}finally{k(!1)}},T=(e,s)=>{g(t=>({...t,[e]:s}))},M=(0,r.useCallback)(async()=>{if(!f&&d)try{y(!0),S(null);let e=await e4.submitQuizAttempt(d.id,u,b);e.success&&(v(e.data),z(!0),c(null),l&&l({type:t,result:e.data,passed:e.data.passed}))}catch(e){console.error("Error submitting quiz:",e),S(e.message||"Failed to submit quiz. Please try again.")}finally{y(!1)}},[d,u,b,f,t,l]),E=e=>{let s=Math.floor(e/60);return"".concat(s.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))};if(w)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"Loading quiz..."})]})});if(A)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,a.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Error"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:A}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105",children:"Retry"})]})});if(!i)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,a.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDCDD"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Quiz Not Found"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:["The ",t," for this course is not available."]}),(0,a.jsx)("button",{onClick:n,className:"bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105",children:"Go Back"})]})});if(P&&N)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:[i.title," - Results"]}),"pretest"!==t&&"posttest"!==t&&(0,a.jsx)("div",{className:"inline-flex items-center px-6 py-3 rounded-full text-lg font-semibold ".concat(N.passed?"bg-green-100 text-green-800 border-2 border-green-200":"bg-red-100 text-red-800 border-2 border-red-200"),children:N.passed?"✅ Passed":"❌ Failed"}),("pretest"===t||"posttest"===t)&&(0,a.jsx)("div",{className:"inline-flex items-center px-6 py-3 rounded-full text-lg font-semibold bg-blue-100 text-blue-800 border-2 border-blue-200",children:"✅ Completed"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:E(N.timeSpent)}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Time Spent"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-6 rounded-xl text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:N.attemptNumber}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Attempt"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[N.canRetake&&"pretest"!==t&&"posttest"!==t&&(0,a.jsx)("button",{onClick:()=>{v(null),z(!1),I()},className:"bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-8 rounded-lg transition duration-200 transform hover:scale-105 flex items-center justify-center",children:"\uD83D\uDD04 Retake Quiz"}),(0,a.jsx)("button",{onClick:()=>{l?"pretest"===t||"posttest"===t?l({type:t,result:N,passed:!0,shouldProceed:!0}):l({type:t,result:N,passed:N.passed,shouldProceed:N.passed}):n()},className:"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-bold py-4 px-8 rounded-xl transition duration-200 transform hover:scale-105 flex items-center justify-center shadow-lg",children:"pretest"===t||"posttest"===t||N.passed?"\uD83D\uDE80 Lanjut ke Materi Selanjutnya":"\uD83D\uDCDA Kembali ke Course"}),(0,a.jsx)("button",{onClick:n,className:"bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105 flex items-center justify-center",children:"← Kembali"})]})]})});if(!d)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"pretest"===t?"\uD83D\uDCDD":"\uD83C\uDFAF"}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:i.title}),(0,a.jsx)("p",{className:"text-gray-600 text-lg leading-relaxed",children:i.description})]}),(0,a.jsxs)("div",{className:"grid ".concat("grid-cols-2"," gap-4 mb-8"),children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:i.questions?i.questions.length:0}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Questions"})]}),"pretest"!==t&&"posttest"!==t&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-2",children:i.timeLimit}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Minutes"})]}),"pretest"!==t&&"posttest"!==t&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl text-center",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-600 mb-2",children:[i.passingScore,"%"]}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Passing Score"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 p-6 rounded-xl text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:i.maxAttempts}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Max Attempts"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)("button",{onClick:I,className:"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-bold py-4 px-8 rounded-xl transition duration-200 transform hover:scale-105 flex items-center justify-center text-lg shadow-lg",children:["\uD83D\uDE80 Start ","pretest"===t?"Pre-test":"Post-test"]}),(0,a.jsx)("button",{onClick:n,className:"bg-gray-500 hover:bg-gray-600 text-white font-semibold py-4 px-8 rounded-xl transition duration-200 transform hover:scale-105 flex items-center justify-center",children:"← Back"})]})]})});if(!i.questions||0===i.questions.length)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-orange-100 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center max-w-md w-full",children:[(0,a.jsx)("div",{className:"text-yellow-500 text-6xl mb-4",children:"\uD83D\uDCCB"}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No Questions Available"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"This quiz has no questions available."}),(0,a.jsx)("button",{onClick:n,className:"bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105",children:"Go Back"})]})});let L=i.questions[m];return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:i.title}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"bg-white bg-opacity-20 rounded-full h-3 mb-2",children:(0,a.jsx)("div",{className:"bg-white rounded-full h-3 transition-all duration-300 ease-out",style:{width:"".concat(i&&i.questions&&d?Math.round((m+1)/i.questions.length*100):0,"%")}})}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Question ",m+1," of ",i.questions?i.questions.length:0]})]}),"pretest"!==t&&"posttest"!==t&&(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-4 py-2 rounded-full font-semibold ".concat(h<300?"bg-red-100 text-red-800 animate-pulse":"bg-opacity-20 text-white"),children:["⏱️ ",E(h)]})})]})]}),(0,a.jsx)("div",{className:"p-8",children:(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 leading-relaxed mb-6",children:L.question}),(0,a.jsx)("div",{className:"space-y-4",children:L.options.map((e,s)=>(0,a.jsx)("div",{className:"group cursor-pointer p-4 rounded-xl border-2 transition-all duration-200 hover:shadow-md ".concat(u[L.id]===s?"border-indigo-500 bg-indigo-50 shadow-md transform scale-[1.02]":"border-gray-200 bg-gray-50 hover:border-indigo-300 hover:bg-indigo-25"),onClick:()=>T(L.id,s),children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"flex items-center justify-center w-8 h-8 rounded-full font-semibold text-sm ".concat(u[L.id]===s?"bg-indigo-500 text-white":"bg-gray-300 text-gray-700 group-hover:bg-indigo-400 group-hover:text-white"),children:String.fromCharCode(65+s)}),(0,a.jsx)("span",{className:"text-gray-700 font-medium flex-1",children:e}),u[L.id]===s&&(0,a.jsx)("span",{className:"text-indigo-500 text-xl",children:"✓"})]})},s))})]})}),(0,a.jsx)("div",{className:"bg-gray-50 px-8 py-6 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-6",children:[(0,a.jsx)("button",{onClick:()=>{m>0&&x(e=>e-1)},disabled:0===m,className:"px-6 py-3 rounded-lg font-semibold transition duration-200 ".concat(0===m?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 text-white transform hover:scale-105"),children:"← Previous"}),(0,a.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:i.questions&&i.questions.map((e,s)=>(0,a.jsx)("button",{className:"w-10 h-10 rounded-full font-semibold text-sm transition-all duration-200 ".concat(s===m?"bg-indigo-600 text-white ring-4 ring-indigo-200 transform scale-110":void 0!==u[i.questions[s].id]?"bg-green-500 text-white hover:bg-green-600":"bg-gray-200 text-gray-600 hover:bg-gray-300"),onClick:()=>x(s),children:s+1},s))}),i.questions&&m===i.questions.length-1?(0,a.jsx)("button",{onClick:M,disabled:f,className:"px-8 py-3 rounded-lg font-bold transition duration-200 ".concat(f?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white transform hover:scale-105 shadow-lg"),children:f?"⏳ Submitting...":"\uD83C\uDFAF Submit Quiz"}):(0,a.jsx)("button",{onClick:()=>{i&&i.questions&&m<i.questions.length-1&&x(e=>e+1)},className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-lg transition duration-200 transform hover:scale-105",children:"Next →"})]})})]})})})},e5=e=>{let{courseId:s,onComplete:t,onBack:r}=e;return(0,a.jsx)("div",{className:"pretest-enhanced",children:(0,a.jsx)(e3,{courseId:s,quizType:"pretest",onComplete:e=>{console.log("Pre-test completed:",e),t&&t({type:"pretest",passed:e.passed,score:e.result.score,canRetake:e.result.canRetake,result:e.result,shouldProceed:e.shouldProceed})},onBack:r})})};var e8=t(29621),e7=t(60132),e9=t(38391);let se=e=>{var s;let{lessons:t,onMarkComplete:l,courseId:n,currentLessonIndex:i=0,onLessonChange:o}=e;console.log("=== LessonContent RENDERED ==="),console.log("Lessons received:",t),console.log("Current lesson index:",i);let[d,c]=(0,r.useState)({}),{progress:m,updateLessonProgress:x,markStepCompleted:u}=eJ(n);if((0,r.useEffect)(()=>{(async()=>{if(!t||!Array.isArray(t))return;let e={};for(let s of t)if(s.content&&Array.isArray(s.content)){for(let t of s.content)if(t.fileId&&"upload"===t.uploadMethod)try{let s=await ea(t.fileId);s&&(e[t.fileId]=el(s))}catch(e){console.error("Error loading file:",e)}}c(e)})()},[t,i]),!t||!Array.isArray(t)||0===t.length)return(0,a.jsx)("div",{className:"px-4 py-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No lessons available."})});let g=t[i],h=e=>(console.log("=== renderContent CALLED ==="),console.log("Content received:",e),Array.isArray(e))?p(e):(0,a.jsx)(eH.oz,{components:{h1:e=>{let{node:s,...t}=e;return(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-4 mt-6 first:mt-0",...t})},h2:e=>{let{node:s,...t}=e;return(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-3 mt-6",...t})},h3:e=>{let{node:s,...t}=e;return(0,a.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-2 mt-4",...t})},p:e=>{let{node:s,...t}=e;return(0,a.jsx)("p",{className:"mb-3 text-sm sm:text-base leading-relaxed text-gray-700",...t})},ul:e=>{let{node:s,...t}=e;return(0,a.jsx)("ul",{className:"list-disc list-inside mb-4 space-y-2 pl-2",...t})},ol:e=>{let{node:s,...t}=e;return(0,a.jsx)("ol",{className:"list-decimal list-inside mb-4 space-y-2 pl-2",...t})},li:e=>{let{node:s,...t}=e;return(0,a.jsx)("li",{className:"text-gray-700",...t})},a:e=>{let{node:s,href:t,...r}=e;return(0,a.jsx)("a",{href:t,className:"text-blue-600 hover:text-blue-800 underline",target:t.startsWith("http")?"_blank":void 0,rel:t.startsWith("http")?"noopener noreferrer":void 0,...r})},img:e=>{let{node:s,src:t,alt:r,...l}=e;return(0,a.jsxs)("div",{className:"my-6",children:[(0,a.jsx)("img",{src:t,alt:r||"",className:"w-full max-w-2xl mx-auto rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",loading:"lazy",...l}),r&&(0,a.jsx)("p",{className:"text-center text-sm text-gray-600 mt-2 italic",children:r})]})},code:e=>{let{node:s,inline:t,className:r,children:l,...n}=e,i=/language-(\w+)/.exec(r||""),o=i?i[1]:"";return t?(0,a.jsx)("code",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded text-sm font-mono",...n,children:l}):(0,a.jsxs)("div",{className:"my-4 bg-gray-900 rounded-lg p-4 overflow-x-auto shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(e8.A,{size:16,className:"text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:o||"code"})]}),(0,a.jsx)(e7.A,{language:o||"javascript",style:e9.A,className:"rounded-md",...n,children:String(l).replace(/\n$/,"")})]})}},children:e}),p=e=>(console.log("=== renderMixedContent CALLED ==="),console.log("Content array:",e),e.map((e,s)=>{switch(console.log("Processing item ".concat(s,":"),e),e.type){case"text":return(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("div",{className:"text-gray-700 leading-relaxed",children:(0,a.jsx)(eH.oz,{children:e.content})})},s);case"image":return(0,a.jsxs)("div",{className:"my-6",children:[(0,a.jsx)("img",{src:e.src,alt:e.alt,className:"w-full max-w-2xl mx-auto rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",loading:"lazy"}),e.caption&&(0,a.jsx)("p",{className:"text-center text-sm text-gray-600 mt-2 italic",children:e.caption})]},s);case"list":return(0,a.jsxs)("div",{className:"mb-4",children:[e.ordered?(0,a.jsxs)("div",{className:"flex items-start space-x-2 mb-2",children:[(0,a.jsx)(eK.A,{className:"text-blue-600 mt-1 flex-shrink-0",size:18}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Langkah-langkah:"})]}):(0,a.jsxs)("div",{className:"flex items-start space-x-2 mb-2",children:[(0,a.jsx)(eV.A,{className:"text-blue-600 mt-1 flex-shrink-0",size:18}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"Poin-poin penting:"})]}),e.ordered?(0,a.jsx)("ol",{className:"list-decimal list-inside mb-4 space-y-2 pl-2",children:e.items.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:(0,a.jsx)(eH.oz,{components:{p:e=>{let{node:s,...t}=e;return(0,a.jsx)("span",{...t})}},children:e})},s))}):(0,a.jsx)("ul",{className:"list-disc list-inside mb-4 space-y-2 pl-2",children:e.items.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:(0,a.jsx)(eH.oz,{components:{p:e=>{let{node:s,...t}=e;return(0,a.jsx)("span",{...t})}},children:e})},s))})]},s);case"code":return(0,a.jsxs)("div",{className:"my-4 bg-gray-900 rounded-lg p-4 overflow-x-auto shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(e8.A,{size:16,className:"text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:e.language||"code"})]}),(0,a.jsx)(e7.A,{language:e.language||"javascript",style:e9.A,className:"rounded-md",children:e.content})]},s);case"pdf":return(0,a.jsx)("div",{className:"my-8",children:(0,a.jsx)(eZ,{item:e,fileUrls:d})},s);case"video":return console.log("=== RENDERING VIDEO CASE ==="),console.log("Video item:",e),console.log("FileUrls available:",d),(0,a.jsx)("div",{className:"my-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(Y.A,{className:"text-blue-600",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),e.duration&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,a.jsx)(eQ.A,{className:"mr-1",size:12}),e.duration]})]})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(eX,{item:e,fileUrls:d})})]})},s);case"external_link":return(0,a.jsx)("div",{className:"my-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(H.A,{className:"text-green-600",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:(0,a.jsx)(eY.A,{className:"text-gray-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"Link Eksternal"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.url})]})]}),(0,a.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,a.jsx)(eY.A,{className:"mr-2 h-4 w-4"}),"Kunjungi"]})]})})]})},s);default:return null}}));return g?(console.log("=== CURRENT LESSON ==="),console.log("Current lesson:",t[i]),console.log("Lesson content:",null==(s=t[i])?void 0:s.content),(0,a.jsxs)("div",{className:"px-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 space-y-4 sm:space-y-0",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:g.title}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{i>0&&o&&o(i-1)},disabled:0===i,className:"px-3 py-2 rounded-lg transition-colors flex items-center space-x-2 text-sm ".concat(0===i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,a.jsx)(K.A,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,a.jsxs)("button",{onClick:()=>{i<t.length-1&&o&&o(i+1)},disabled:i===t.length-1,className:"px-3 py-2 rounded-lg transition-colors flex items-center space-x-2 text-sm ".concat(i===t.length-1?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,a.jsx)(_.A,{size:16})]})]})]}),"reading"===g.type&&(0,a.jsx)("div",{className:"prose max-w-none",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,a.jsx)(S.A,{className:"text-purple-600",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Materi Bacaan"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Pelajari konsep-konsep penting dalam lesson ini"})]})]})}),(0,a.jsx)("div",{className:"p-6 sm:p-8",children:(0,a.jsx)("div",{className:"text-gray-700 leading-relaxed",children:(g.content,h(g.content))})})]})}),"video"===g.type&&(console.log("=== LESSON TYPE VIDEO DETECTED ==="),console.log("Lesson data:",g),(0,a.jsx)("div",{className:"prose max-w-none",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(Y.A,{className:"text-blue-600",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Video Tutorial"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Tonton video pembelajaran berikut"})]})]})}),(0,a.jsx)("div",{className:"p-6 sm:p-8",children:(0,a.jsx)("div",{className:"text-gray-700 leading-relaxed",children:(console.log("=== CALLING renderContent for lesson.content ==="),console.log("lesson.content:",g.content),h(g.content))})})]})})),"mixed"===g.type&&(0,a.jsx)("div",{className:"prose max-w-none",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-indigo-100 rounded-lg",children:(0,a.jsx)(S.A,{className:"text-indigo-600",size:24})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Materi Pembelajaran"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Konten interaktif dengan berbagai format media"})]})]})}),(0,a.jsx)("div",{className:"p-6 sm:p-8",children:Array.isArray(g.content)?p(g.content):(0,a.jsx)("div",{className:"text-gray-700 leading-relaxed",children:(console.log("=== CALLING renderContent for lesson.content ==="),console.log("lesson.content:",g.content),h(g.content))})})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-6 sm:mt-8 pt-6 border-t space-y-4 sm:space-y-0",children:[(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-gray-500",children:["Lesson ",i+1," of ",t.length]}),(0,a.jsx)("div",{className:"w-full max-w-md mx-4 order-first sm:order-none",children:(0,a.jsx)("div",{className:"bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat((i+1)/t.length*100,"%")}})})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{i>0&&o&&o(i-1)},disabled:0===i,className:"px-3 py-2 rounded-lg transition-colors flex items-center space-x-2 text-sm ".concat(0===i?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,a.jsx)(K.A,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,a.jsxs)("button",{onClick:()=>{i<t.length-1&&o&&o(i+1)},disabled:i===t.length-1,className:"px-3 py-2 rounded-lg transition-colors flex items-center space-x-2 text-sm ".concat(i===t.length-1?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,a.jsx)(_.A,{size:16})]}),(0,a.jsxs)("button",{onClick:()=>{let e=t[i];l&&e?(console.log("Marking lesson complete:",e.id),l(e.id)):console.log("Missing onMarkComplete or currentLesson:",{onMarkComplete:!!l,currentLesson:e})},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2 text-sm sm:text-base",children:[(0,a.jsx)(b.A,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Mark Complete"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Complete"})]})]})]})]})):(0,a.jsx)("div",{className:"px-4 py-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No lesson content available."})})},ss=e=>{var s,t;let{courseId:l,onComplete:n,onBack:i}=e,[o,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),[g,h]=(0,r.useState)({satisfaction:0,difficulty:0,usefulness:0,feedback:""}),[p,j]=(0,r.useState)(!1),f=async()=>{var e,s,t,a,r;console.log("Survey submitted:",g);try{let a={course_id:l,rating:g.satisfaction,difficulty:g.difficulty,clarity:g.usefulness,usefulness:g.usefulness,feedback:g.feedback||"",post_test_score:(null==x||null==(e=x.result)?void 0:e.score)||0,post_test_completed:!0};await (0,y.Qh)(a),console.log("Survey successfully submitted to backend"),j(!0),n&&n({type:"posttest",score:(null==x||null==(s=x.result)?void 0:s.score)||0,canRetake:(null==x||null==(t=x.result)?void 0:t.canRetake)||!0,result:(null==x?void 0:x.result)||{},surveyCompleted:!0})}catch(e){console.error("Error submitting survey:",e),j(!0),n&&n({type:"posttest",score:(null==x||null==(a=x.result)?void 0:a.score)||0,canRetake:(null==x||null==(r=x.result)?void 0:r.canRetake)||!0,result:(null==x?void 0:x.result)||{},surveyCompleted:!0})}},N=(e,s,t)=>{let{emoji:r,text:l,color:n}=(e=>{switch(e){case 0:default:return{emoji:"❓",text:"Belum dinilai",color:"text-gray-500"};case 1:return{emoji:"\uD83D\uDE1E",text:"Sangat Buruk",color:"text-red-500"};case 2:return{emoji:"\uD83D\uDE15",text:"Buruk",color:"text-orange-500"};case 3:return{emoji:"\uD83D\uDE10",text:"Cukup",color:"text-yellow-500"};case 4:return{emoji:"\uD83D\uDE0A",text:"Baik",color:"text-green-500"};case 5:return{emoji:"\uD83D\uDE0D",text:"Sangat Baik",color:"text-green-600"}}})(e);return(0,a.jsxs)("div",{className:"mb-6 text-gray-900",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:t}),(0,a.jsx)("div",{className:"flex items-center justify-center space-x-2 mb-3",children:[1,2,3,4,5].map(t=>(0,a.jsx)("button",{type:"button",onClick:()=>s(t),className:"p-2 transition-all duration-200 transform hover:scale-110 rounded-full ".concat(t<=e?"text-yellow-400 bg-yellow-50":"text-gray-300 hover:text-yellow-300 hover:bg-gray-50"),children:(0,a.jsx)(eh.A,{size:28,fill:t<=e?"currentColor":"none"})},t))}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-1",children:[(0,a.jsx)("span",{className:"text-2xl",children:r}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(n),children:l})]}),e>0&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-yellow-200 to-yellow-300 rounded-full px-3 py-1",children:(0,a.jsxs)("span",{className:"text-xs font-semibold text-yellow-800",children:[e,"/5 ⭐"]})})})]})]})};return p?(0,a.jsxs)("div",{className:"text-center space-y-6 px-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 rounded-full w-20 h-20 sm:w-24 sm:h-24 flex items-center justify-center mx-auto animate-pulse",children:(0,a.jsx)(b.A,{className:"text-white",size:32})}),(0,a.jsx)("div",{className:"absolute -top-2 -right-2 text-2xl animate-bounce",children:"\uD83C\uDF89"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Terima Kasih! \uD83D\uDE4F"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-1 text-2xl",children:[(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:"\uD83C\uDF1F"}),(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0.1s"},children:"✨"}),(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:"\uD83C\uDF1F"})]})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm sm:text-base",children:"Post-test dan survei telah selesai. Anda dapat melanjutkan ke tahap berikutnya."}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCCA"}),(0,a.jsxs)("p",{className:"text-blue-800 font-medium",children:["Skor Post-Test: ",(null==x||null==(s=x.result)?void 0:s.score)||0,"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"✅"}),(0,a.jsx)("p",{className:"text-blue-600 text-sm",children:"Status: Telah Disubmit"})]})]})]}):c&&x?(0,a.jsx)("div",{className:"max-w-2xl mx-auto px-4 text-gray-900",children:(0,a.jsxs)("div",{className:"text-center space-y-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-full w-20 h-20 sm:w-24 sm:h-24 flex items-center justify-center mx-auto animate-pulse",children:(0,a.jsx)(b.A,{className:"text-white",size:40})}),(0,a.jsx)("div",{className:"absolute -top-2 -right-2 text-2xl animate-bounce",children:"\uD83C\uDFAF"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Post-Test Selesai! \uD83C\uDF89"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-1 text-2xl",children:[(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0s"},children:"⭐"}),(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0.1s"},children:"✨"}),(0,a.jsx)("span",{className:"animate-bounce",style:{animationDelay:"0.2s"},children:"⭐"})]})]}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200 shadow-lg",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCCA"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-800",children:"Skor Anda"}),(0,a.jsxs)("p",{className:"text-4xl font-extrabold text-blue-600",children:[(null==(t=x.result)?void 0:t.score)||0,"%"]})]}),(0,a.jsx)("span",{className:"text-3xl",children:"\uD83C\uDFAF"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"✅"}),(0,a.jsx)("p",{className:"text-blue-600 font-medium",children:"Status: Telah Disubmit"})]})]})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCA1"}),(0,a.jsx)("p",{className:"text-green-700 text-sm sm:text-base",children:"Sekarang mari bantu kami meningkatkan kualitas pembelajaran dengan mengisi survei singkat"})]})}),(0,a.jsxs)("button",{onClick:()=>{m(!1),d(!0)},className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 font-semibold transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCDD"}),(0,a.jsx)("span",{children:"Lanjut ke Survei"}),(0,a.jsx)("span",{children:"\uD83D\uDE80"})]})]})}):o&&x?(0,a.jsxs)("div",{className:"max-w-2xl mx-auto px-4 text-gray-900",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-pink-600 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4 animate-pulse",children:(0,a.jsx)(P.A,{className:"text-white",size:32})}),(0,a.jsx)("div",{className:"absolute -top-1 -right-1 text-lg animate-spin",children:"\uD83D\uDCAB"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:"Survei Pengalaman Belajar \uD83D\uDCDD"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2 text-lg",children:[(0,a.jsx)("span",{children:"\uD83D\uDCAD"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Bantu kami meningkatkan kualitas pembelajaran"}),(0,a.jsx)("span",{children:"\uD83D\uDE80"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 sm:p-8 border border-purple-100",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDE0A"}),(0,a.jsx)("h4",{className:"font-semibold text-purple-800",children:"Kepuasan Pembelajaran"})]}),N(g.satisfaction,e=>h(s=>({...s,satisfaction:e})),"Seberapa puas Anda dengan materi pembelajaran ini?")]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83E\uDDE0"}),(0,a.jsx)("h4",{className:"font-semibold text-blue-800",children:"Tingkat Kesulitan"})]}),N(g.difficulty,e=>h(s=>({...s,difficulty:e})),"Seberapa mudah materi ini dipahami? (1=Sangat Sulit, 5=Sangat Mudah)")]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCA1"}),(0,a.jsx)("h4",{className:"font-semibold text-green-800",children:"Kegunaan Materi"})]}),N(g.usefulness,e=>h(s=>({...s,usefulness:e})),"Seberapa berguna materi ini untuk Anda?")]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg p-4 border border-orange-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCAC"}),(0,a.jsxs)("label",{className:"block text-sm font-medium text-orange-800",children:["Saran atau masukan tambahan ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]})]}),(0,a.jsx)("textarea",{value:g.feedback,onChange:e=>h(s=>({...s,feedback:e.target.value})),className:"w-full p-3 border border-orange-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200 bg-white",rows:4,placeholder:"\uD83D\uDCAD Bagikan pengalaman belajar Anda... Apa yang paling berkesan? Apa yang bisa diperbaiki?",required:!0}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsx)("span",{className:"text-xs text-orange-600",children:"\uD83D\uDCDD Masukan Anda sangat berharga untuk kami"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[g.feedback.length,"/500"]})]})]})]}),(0,a.jsxs)("button",{onClick:f,disabled:0===g.satisfaction||0===g.difficulty||0===g.usefulness||!g.feedback.trim(),className:"w-full mt-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 font-semibold disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDE80"}),(0,a.jsx)("span",{children:"Kirim Survei"}),(0,a.jsx)("span",{children:"✨"})]})]})]}):(0,a.jsx)("div",{className:"posttest-with-survey",children:(0,a.jsx)(e3,{courseId:l,quizType:"posttest",onComplete:e=>{console.log("Post-test completed:",e),u(e),m(!0)},onBack:i})})},st=e=>{let{courseId:s,onSubmit:t,stageAccess:n}=e,{currentUser:i,isEnrolledInCourse:o,enrollInCourse:d}=(0,l.A)(),[c,m]=(0,r.useState)("not_submitted"),[u,g]=(0,r.useState)(null),[p,j]=(0,r.useState)(""),[N,v]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[A,S]=(0,r.useState)(null),[C,D]=(0,r.useState)(!1),[P,z]=(0,r.useState)("saved"),[I,M]=(0,r.useState)(null),[E,L]=(0,r.useState)(null),[F,U]=(0,r.useState)(!1),[R,q]=(0,r.useState)(null),[_,O]=(0,r.useState)([]),[B,W]=(0,r.useState)(!1),J=(0,r.useCallback)(()=>{try{let e="course_instructions_".concat(s),t=localStorage.getItem(e);if(t){let e=JSON.parse(t);L(e.postwork)}else L({title:"Post Work Assignment",description:"Silakan kerjakan tugas post work berikut untuk mempraktikkan materi yang telah dipelajari.",requirements:["Menyelesaikan semua materi pembelajaran","Memahami konsep dasar yang telah diajarkan"],deliverables:["Dokumen laporan hasil praktik","Screenshot atau bukti implementasi"],timeline:"7 hari setelah menyelesaikan materi",resources:["Materi pembelajaran yang telah dipelajari","Template dokumen (jika tersedia)"]})}catch(e){console.error("Error loading instructions:",e),L({title:"Post Work Assignment",description:"Silakan kerjakan tugas post work berikut untuk mempraktikkan materi yang telah dipelajari.",requirements:["Menyelesaikan semua materi pembelajaran"],deliverables:["Dokumen laporan hasil praktik"],timeline:"7 hari setelah menyelesaikan materi",resources:["Materi pembelajaran yang telah dipelajari"]})}},[s]),G=(0,r.useCallback)(async()=>{let e=localStorage.getItem("postWork_".concat(s,"_").concat(null==i?void 0:i.id));if(e){let s=JSON.parse(e);j(s.description||""),m(s.status||"not_submitted"),v(s.submissionDate),k(s.feedback||""),S(s.grade),M(s.lastSaved)}W(!0);try{if(!await o(parseInt(s)))try{await d(parseInt(s))}catch(e){throw console.error("Failed to auto-enroll user:",e),Error("User not enrolled in course")}let e=await y.hJ.getPostWorkSubmissions(parseInt(s));if(e.success&&e.data&&e.data.length>0){O(e.data);let s=e.data[0];m("submitted"),j(s.content||""),v(new Date(s.submittedAt).toLocaleDateString("id-ID")),s.feedback&&(k(s.feedback),m("reviewed")),s.score&&S(s.score),s.fileId&&q(s.fileId)}}catch(e){console.error("Failed to load existing submissions:",e)}finally{W(!1)}},[s,null==i?void 0:i.id]);(0,r.useEffect)(()=>{i&&s&&(G(),J())},[G,J,i,s]);let K=(0,r.useCallback)(()=>{if(!i)return;z("saving");let e={description:p,status:c,submissionDate:N,feedback:w,grade:A,lastSaved:new Date().toISOString()};try{localStorage.setItem("postWork_".concat(s,"_").concat(i.id),JSON.stringify(e)),z("saved"),M(new Date().toISOString())}catch(e){z("error")}},[i,s,p,c,N,w,A]);(0,r.useEffect)(()=>{let e=setTimeout(()=>{(p||u)&&K()},2e3);return()=>clearTimeout(e)},[p,u,K]);let V=async e=>{let s=e.target.files[0];if(s){g(s),U(!0);try{let e=await y.hJ.uploadFile(s);q(e.data.id),alert("File berhasil diupload!")}catch(e){console.error("Upload error:",e),alert("Upload gagal: "+e.message),g(null)}finally{U(!1)}}},Y=async e=>{if(e){g(e),U(!0),z("saving");try{let s=await y.hJ.uploadFile(e);q(s.data.id),z("saved"),M(new Date),alert("File berhasil diupload!")}catch(e){console.error("File upload failed:",e),z("error"),g(null),alert("Upload gagal: "+e.message)}finally{U(!1)}}},H=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?D(!0):"dragleave"===e.type&&D(!1)},Z=async()=>{if(!R||!p.trim())return void alert("Silakan upload file dan berikan deskripsi tugas.");if(n&&n.finalproject&&!n.finalproject.canAccess)return void alert("Tahap selanjutnya dikunci oleh admin: ".concat(n.finalproject.lockMessage||"Silakan hubungi admin untuk informasi lebih lanjut."));try{z("saving");let e={courseId:parseInt(s),lessonId:null,title:"PostWork Submission",content:p,attachments:JSON.stringify([R])},a=await y.hJ.createPostWorkSubmission(e);a.success&&(m("submitted"),v(new Date().toLocaleDateString("id-ID")),z("saved"),t&&t({fileId:R,description:p,submissionDate:new Date().toISOString(),submissionId:a.data.id}),alert("Tugas berhasil dikumpulkan!"))}catch(e){console.error("Submission failed:",e),z("error"),alert("Gagal mengumpulkan tugas. Silakan coba lagi.")}},$=async()=>{if(!R||!p.trim())return void alert("Silakan upload file dan berikan deskripsi tugas.");if(n&&n.finalproject&&!n.finalproject.canAccess)return void alert("Tahap selanjutnya dikunci oleh admin: ".concat(n.finalproject.lockMessage||"Silakan hubungi admin untuk informasi lebih lanjut."));try{z("saving");let e={courseId:parseInt(s),lessonId:null,title:"PostWork Update",content:p,attachments:JSON.stringify([R])},a=await y.hJ.createPostWorkSubmission(e);a.success&&(v(new Date().toLocaleDateString("id-ID")),z("saved"),t&&t({fileId:R,description:p,submissionDate:new Date().toISOString(),isUpdate:!0,submissionId:a.data.id}),alert("Tugas berhasil diperbarui!"))}catch(e){console.error("Update failed:",e),z("error"),alert("Gagal memperbarui tugas. Silakan coba lagi.")}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6 text-gray-900",children:[(0,a.jsx)("style",{children:"\n  .file-upload-section {\n    margin: 20px 0;\n    padding: 20px;\n    border: 2px dashed #ddd;\n    border-radius: 8px;\n    text-align: center;\n  }\n\n  .file-upload-label {\n    display: block;\n    cursor: pointer;\n    color: #666;\n    font-weight: 500;\n  }\n\n  .file-upload-input {\n    display: none;\n  }\n\n  .file-info {\n    margin-top: 10px;\n    padding: 10px;\n    background-color: #f0f8ff;\n    border-radius: 4px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .file-size {\n    color: #888;\n    font-size: 0.9em;\n  }\n\n  .upload-progress {\n    margin-top: 10px;\n    padding: 10px;\n    background-color: #fff3cd;\n    border-radius: 4px;\n    color: #856404;\n  }\n\n  .uploaded-file-info {\n    margin-top: 10px;\n    padding: 15px;\n    background-color: #d4edda;\n    border: 1px solid #c3e6cb;\n    border-radius: 4px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .download-btn {\n    background-color: #007bff;\n    color: white;\n    border: none;\n    padding: 8px 16px;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 0.9em;\n    transition: background-color 0.2s;\n  }\n\n  .download-btn:hover {\n    background-color: #0056b3;\n  }\n"}),(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-orange-500 to-red-600 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(Q.A,{className:"text-white",size:32})}),(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Post Work"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm sm:text-base",children:"Kumpulkan hasil pekerjaan atau tugas kecil Anda di sini"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-orange-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(()=>{switch(c){case"not_submitted":return(0,a.jsx)(f.A,{className:"text-yellow-500",size:24});case"submitted":return(0,a.jsx)(b.A,{className:"text-green-500",size:24});case"reviewed":return(0,a.jsx)(b.A,{className:"text-blue-500",size:24});default:return(0,a.jsx)(h.A,{className:"text-gray-500",size:24})}})(),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Status Tugas"}),(0,a.jsx)("p",{className:"text-gray-600",children:(()=>{switch(c){case"not_submitted":return"Belum Dikumpulkan";case"submitted":return"Sudah Dikumpulkan - Menunggu Review";case"reviewed":return"Sudah Dinilai";default:return"Status Tidak Diketahui"}})()}),N&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Terakhir diperbarui: ",N]})]})]}),A&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-semibold text-green-800",children:["Nilai: ",A,"/100"]}),w&&(0,a.jsx)("p",{className:"text-green-700 mt-2",children:w})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Upload Tugas"}),(0,a.jsx)("div",{className:"border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ".concat(C?"border-orange-500 bg-orange-50":"border-gray-300 hover:border-orange-400 hover:bg-gray-50"),onDragEnter:H,onDragLeave:H,onDragOver:H,onDrop:e=>{e.preventDefault(),e.stopPropagation(),D(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&Y(e.dataTransfer.files[0])},children:u?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)(T.A,{className:"text-orange-500",size:24}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:u.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]})(u.size)})]}),(0,a.jsx)("button",{onClick:()=>{g(null)},className:"text-red-500 hover:text-red-700 p-1",children:(0,a.jsx)(x.A,{size:20})})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"File siap untuk diunggah"})]}):R?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-3 p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)(b.A,{className:"text-green-500",size:24}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"File berhasil diupload"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"File siap untuk dikumpulkan"})]}),(0,a.jsx)("button",{onClick:async()=>{try{let e=await y.hJ.getFile(R);if(e.success){let s=window.URL.createObjectURL(e.data),t=document.createElement("a");t.href=s,t.download=e.filename||"download",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(s),document.body.removeChild(t)}}catch(e){console.error("Failed to download file:",e)}},className:"text-blue-500 hover:text-blue-700 p-1",children:(0,a.jsx)(eN.A,{size:20})})]}),(0,a.jsxs)("label",{className:"inline-block bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 cursor-pointer transition-colors",children:["Ganti File",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:V,accept:".pdf,.docx,.doc,.jpg,.jpeg,.png,.gif"})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Q.A,{className:"mx-auto text-gray-400",size:48}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag & drop file di sini atau"}),(0,a.jsxs)("label",{className:"inline-block bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 cursor-pointer transition-colors",children:["Pilih File",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:V,accept:".pdf,.docx,.doc,.jpg,.jpeg,.png,.gif"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsx)("p",{children:"Format yang didukung: PDF, DOCX, JPG, PNG, GIF"}),(0,a.jsx)("p",{children:"Maksimal ukuran file: 10MB"})]})]})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Tugas *"}),(0,a.jsx)("textarea",{value:p,onChange:e=>j(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",rows:4,placeholder:"Jelaskan tugas yang Anda kumpulkan, metodologi yang digunakan, atau hal-hal penting lainnya...",required:!0})]}),(0,a.jsx)("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:"not_submitted"===c?(0,a.jsx)("button",{onClick:Z,disabled:!u||!p.trim()||F||!R,className:"flex-1 bg-gradient-to-r from-orange-600 to-red-600 text-white py-3 px-6 rounded-lg hover:from-orange-700 hover:to-red-700 transition-all duration-300 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:F?"Mengupload...":"Kumpulkan Tugas"}):(0,a.jsx)("button",{onClick:$,disabled:!u||!p.trim()||F||!R,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:F?"Mengupload...":"Perbarui Tugas"})})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(X.A,{className:"".concat("saving"===P?"animate-spin text-blue-500":"saved"===P?"text-green-500":"text-red-500"),size:20}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["saving"===P&&"Menyimpan...","saved"===P&&I&&"Tersimpan otomatis ".concat(new Date(I).toLocaleTimeString("id-ID")),"error"===P&&"Gagal menyimpan"]})]})}),E&&(0,a.jsxs)("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-blue-800 mb-3",children:E.title}),E.description&&(0,a.jsx)("p",{className:"text-blue-700 mb-3 text-sm",children:E.description}),E.timeline&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-blue-100 rounded-lg",children:[(0,a.jsx)("h5",{className:"font-semibold text-blue-800 mb-1",children:"⏰ Timeline:"}),(0,a.jsx)("p",{className:"text-blue-700 text-sm",children:E.timeline})]}),E.requirements&&E.requirements.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDCCB Persyaratan:"}),(0,a.jsx)("ul",{className:"text-blue-700 space-y-1 text-sm",children:E.requirements.map((e,s)=>(0,a.jsxs)("li",{children:["• ",e]},s))})]}),E.deliverables&&E.deliverables.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDCE6 Deliverables:"}),(0,a.jsx)("ul",{className:"text-blue-700 space-y-1 text-sm",children:E.deliverables.map((e,s)=>(0,a.jsxs)("li",{children:["• ",e]},s))})]}),E.resources&&E.resources.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDCDA Resources:"}),(0,a.jsx)("ul",{className:"text-blue-700 space-y-1 text-sm",children:E.resources.map((e,s)=>(0,a.jsxs)("li",{children:["• ",e]},s))})]})]}),_.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB Riwayat Submission"}),B?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("span",{className:"text-gray-500",children:"⏳ Memuat riwayat submission..."})}):(0,a.jsx)("div",{className:"space-y-4",children:_.map((e,s)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Submission #",_.length-s]}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:new Date(e.submittedAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.score&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:["Score: ",e.score]})]}),e.content&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Deskripsi:"}),(0,a.jsxs)("p",{className:"text-gray-800 text-sm bg-gray-50 p-2 rounded",children:[e.content.substring(0,200),e.content.length>200&&"..."]})]}),e.fileId&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("button",{onClick:async()=>{try{let s=await y.hJ.getFile(e.fileId);if(s.success){let e=window.URL.createObjectURL(s.data),t=document.createElement("a");t.href=e,t.download=s.filename||"download",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(e),document.body.removeChild(t)}}catch(e){console.error("Failed to download file:",e)}},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800 text-sm",children:[(0,a.jsx)(eN.A,{size:16}),(0,a.jsx)("span",{children:"Download File"})]})}),e.feedback&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Feedback:"}),(0,a.jsx)("p",{className:"text-blue-800 text-sm",children:e.feedback})]})]},e.id||s))})]})]})};var sa=t(38164);let sr={project:{extensions:[".pdf",".docx",".doc",".zip",".rar",".7z"],mimeTypes:["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","application/zip","application/x-rar-compressed","application/x-7z-compressed"],maxSize:0x3200000},image:{extensions:[".jpg",".jpeg",".png",".gif",".webp"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp"],maxSize:0xa00000},document:{extensions:[".pdf",".docx",".doc",".txt"],mimeTypes:["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain"],maxSize:0x1900000}},sl=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"project",t=sr[s];if(!t)return{isValid:!1,error:"Invalid file type configuration"};if(e.size>t.maxSize)return{isValid:!1,error:"File size exceeds ".concat(sn(t.maxSize)," limit")};let a="."+e.name.split(".").pop().toLowerCase(),r=t.extensions.includes(a),l=t.mimeTypes.includes(e.type);return r||l?{isValid:!0,error:null}:{isValid:!1,error:"File type not supported. Allowed types: ".concat(t.extensions.join(", "))}},sn=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},si=e=>"application/pdf"===e.type?URL.createObjectURL(e):null,so=e=>{e&&URL.revokeObjectURL(e)},sd=e=>["application/pdf","image/jpeg","image/png","image/gif","image/webp","text/plain"].includes(e.type);class sc{startUpload(e,s){this.uploads.set(e,{fileName:s,progress:0,status:"uploading",startTime:Date.now()})}updateProgress(e,s){let t=this.uploads.get(e);t&&(t.progress=s,t.status=100===s?"completed":"uploading")}setError(e,s){let t=this.uploads.get(e);t&&(t.status="error",t.error=s)}getUpload(e){return this.uploads.get(e)}removeUpload(e){this.uploads.delete(e)}getAllUploads(){return Array.from(this.uploads.entries()).map(e=>{let[s,t]=e;return{id:s,...t}})}constructor(){this.uploads=new Map}}new sc;let sm=e=>{let{courseId:s,onSubmit:n,stageAccess:i}=e,{currentUser:o}=(0,l.A)(),[c,m]=(0,r.useState)("not_submitted"),[u,g]=(0,r.useState)(null),[p,j]=(0,r.useState)(""),[N,v]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[A,S]=(0,r.useState)(null),[C,D]=(0,r.useState)("file"),[P,z]=(0,r.useState)(""),[I,M]=(0,r.useState)(!1),[E,L]=(0,r.useState)(!1),[F,U]=(0,r.useState)(null),[R,q]=(0,r.useState)("saved"),[_,O]=(0,r.useState)(null),[B,W]=(0,r.useState)(null),[J,G]=(0,r.useState)(!1),[K,V]=(0,r.useState)(null),[Y,H]=(0,r.useState)(null),[Z,$]=(0,r.useState)(!1),ee=(0,r.useCallback)(()=>{let e=localStorage.getItem("finalProject_".concat(s,"_").concat(null==o?void 0:o.id));if(e){let s=JSON.parse(e);j(s.description||""),z(s.link||""),D(s.submissionType||"file"),m(s.status||"not_submitted"),v(s.submissionDate),k(s.feedback||""),S(s.grade),O(s.lastSaved)}},[s,null==o?void 0:o.id]),es=(0,r.useCallback)(()=>{try{let e="course_instructions_".concat(s),t=localStorage.getItem(e);if(t){let e=JSON.parse(t);W(e.finalproject)}else W({title:"Final Project",description:"Proyek akhir untuk mendemonstrasikan pemahaman komprehensif terhadap seluruh materi kursus.",requirements:["Menyelesaikan semua tahap pembelajaran","Menyelesaikan post work assignment"],deliverables:["Proyek lengkap sesuai spesifikasi","Dokumentasi proyek","Presentasi atau demo (jika diperlukan)"],timeline:"14 hari setelah menyelesaikan post work",resources:["Seluruh materi kursus","Template proyek (jika tersedia)","Panduan teknis"]})}catch(e){console.error("Error loading instructions:",e),W({title:"Final Project",description:"Proyek akhir untuk mendemonstrasikan pemahaman komprehensif terhadap seluruh materi kursus.",requirements:["Menyelesaikan semua tahap pembelajaran"],deliverables:["Proyek lengkap sesuai spesifikasi"],timeline:"14 hari setelah menyelesaikan post work",resources:["Seluruh materi kursus"]})}},[s]);(0,r.useEffect)(()=>{ee(),es();let e=async()=>{$(!0);try{let e=await y.hJ.getFinalProjectSubmission(parseInt(s));if(e.success&&e.data){let s=e.data;H(s),m("submitted"),j(s.content||""),v(new Date(s.submittedAt).toLocaleDateString("id-ID")),s.feedback&&(k(s.feedback),m("reviewed")),s.score&&S(s.score),s.fileId&&V(s.fileId),n&&n({type:s.githubUrl?"link":"file",link:s.githubUrl||s.liveUrl,description:s.content,submissionDate:s.submittedAt,submissionId:s.id,isExisting:!0})}}catch(e){console.error("Failed to load existing submission:",e)}finally{$(!1)}};o&&s&&e()},[ee,es,s,o]);let et=(0,r.useCallback)(()=>{if(!o)return;q("saving");let e={description:p,link:P,submissionType:C,status:c,submissionDate:N,feedback:w,grade:A,lastSaved:new Date().toISOString()};try{localStorage.setItem("finalProject_".concat(s,"_").concat(o.id),JSON.stringify(e)),q("saved"),O(new Date().toISOString())}catch(e){q("error")}},[o,s,p,P,C,c,N,w,A]);(0,r.useEffect)(()=>{let e=setTimeout(()=>{(p||u||P)&&et()},2e3);return()=>clearTimeout(e)},[p,u,P,C,et]);let ea=()=>{let e=localStorage.getItem("courseProgress_".concat(s,"_").concat(null==o?void 0:o.id));return!!e&&!0===JSON.parse(e).completed},er=async()=>{if(!ea())return void alert("Anda harus menyelesaikan semua materi kursus terlebih dahulu untuk mendapatkan sertifikat.");if("reviewed"!==c)return void alert("Proyek akhir harus dinilai terlebih dahulu untuk mendapatkan sertifikat.");try{let{certificateAPI:e}=await Promise.resolve().then(t.bind(t,39360)),a=await e.requestCertificate(parseInt(s));a.success?alert("Selamat! Anda berhasil mengerjakan course 100 persen. Sertifikat menunggu approval admin."):alert("Gagal mengajukan sertifikat: "+(a.message||"Terjadi kesalahan"))}catch(e){console.error("Error requesting certificate:",e),alert("Gagal mengajukan sertifikat. Silakan coba lagi.")}},el=async e=>{let s=e.target.files[0];if(s){let e=[".pdf",".doc",".docx",".txt",".zip",".rar",".jpg",".jpeg",".png"];if(!e.includes("."+s.name.split(".").pop().toLowerCase()))return void alert("File type not supported. Please upload: "+e.join(", "));if(s.size>0xa00000)return void alert("File size exceeds 10MB limit");g(s),G(!0);try{let e=await y.hJ.uploadFile(s);e.success?(V(e.data.id),g(null),alert("File project berhasil diupload!")):alert("Upload gagal: "+e.error)}catch(e){console.error("Upload error:",e),alert("Upload gagal: "+e.message)}finally{G(!1)}}},en=async e=>{let s=sl(e,"project");if(!s.isValid)return void alert(s.error);g(e),G(!0),q("saving");try{let s=await y.hJ.uploadFile(e);s.success&&(V(s.data.id),q("saved"),O(new Date().toISOString()))}catch(e){console.error("File upload failed:",e),q("error"),g(null)}finally{G(!1)}sd(e)&&"application/pdf"===e.type&&U(si(e))},ei=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?M(!0):"dragleave"===e.type&&M(!1)},[]),eo=(0,r.useCallback)(async e=>{M(!1);let s=e.dataTransfer.files;s.length>0&&await en(s[0])},[]),ed=async()=>{if("file"===C?p.trim()&&K:P.trim()&&p.trim()){if(i&&i.finalproject&&!i.finalproject.canAccess)return void alert("Tahap ini dikunci oleh admin: ".concat(i.finalproject.lockMessage||"Silakan hubungi admin untuk informasi lebih lanjut."));try{q("saving");let e={courseId:parseInt(s),title:"Final Project Submission",description:p,content:p,attachments:"file"===C?JSON.stringify([K]):null,githubUrl:"link"===C?P:null,liveUrl:"link"===C?P:null},t=await y.hJ.createFinalProjectSubmission(e);t.success&&(m("submitted"),v(new Date().toLocaleDateString("id-ID")),q("saved"),n&&n({type:C,file:u,link:P,description:p,submissionDate:new Date().toISOString(),submissionId:t.data.id}),alert("Proyek akhir berhasil dikumpulkan!"))}catch(e){console.error("Submission failed:",e),q("error"),alert("Gagal mengumpulkan proyek akhir. Silakan coba lagi.")}}else alert("file"===C?"Silakan upload file dan berikan deskripsi proyek.":"Silakan masukkan link dan berikan deskripsi proyek.")},ec=async()=>{if("file"===C?p.trim()&&K:P.trim()&&p.trim()){if(i&&i.finalproject&&!i.finalproject.canAccess)return void alert("Tahap ini dikunci oleh admin: ".concat(i.finalproject.lockMessage||"Silakan hubungi admin untuk informasi lebih lanjut."));try{q("saving");let e={courseId:parseInt(s),title:"Final Project Update",description:p,content:p,attachments:"file"===C?JSON.stringify([K]):null,githubUrl:"link"===C?P:null,liveUrl:"link"===C?P:null},t=await y.hJ.createFinalProjectSubmission(e);t.success&&(v(new Date().toLocaleDateString("id-ID")),q("saved"),n&&n({type:C,file:u,link:P,description:p,submissionDate:new Date().toISOString(),isUpdate:!0,submissionId:t.data.id}),alert("Proyek akhir berhasil diperbarui!"))}catch(e){console.error("Update failed:",e),q("error"),alert("Gagal memperbarui proyek akhir. Silakan coba lagi.")}}else alert("file"===C?"Silakan upload file dan berikan deskripsi proyek.":"Silakan masukkan link dan berikan deskripsi proyek.")},em=()=>{switch(c){case"not_submitted":return(0,a.jsx)(f.A,{className:"text-yellow-500",size:24});case"submitted":return(0,a.jsx)(b.A,{className:"text-green-500",size:24});case"reviewed":return(0,a.jsx)(b.A,{className:"text-blue-500",size:24});default:return(0,a.jsx)(h.A,{className:"text-gray-500",size:24})}},ex=()=>{switch(c){case"not_submitted":return"Belum Dikumpulkan";case"submitted":return"Sudah Dikumpulkan - Menunggu Review";case"reviewed":return"Sudah Dinilai";default:return"Status Tidak Diketahui"}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-gray-900",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Final Project"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Submit your final project for evaluation"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-1",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Project Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[em(),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:ex()})]})]}),A&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-semibold text-green-800",children:["Nilai: ",A,"/100"]}),w&&(0,a.jsx)("p",{className:"text-green-700 mt-2",children:w})]})]}),"not_submitted"!==c&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Submission History"}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:u?u.name:"Project Submission"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Submitted on ",N]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[em(),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:ex()})]})]})})]})]}),(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Jenis Pengumpulan"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,a.jsx)("button",{onClick:()=>D("file"),className:"p-4 rounded-lg border-2 transition-all ".concat("file"===C?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(T.A,{size:24}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Upload File"}),(0,a.jsx)("p",{className:"text-sm",children:"Upload file proyek (PDF, DOCX, ZIP)"})]})]})}),(0,a.jsx)("button",{onClick:()=>D("link"),className:"p-4 rounded-lg border-2 transition-all ".concat("link"===C?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 hover:border-gray-300 text-gray-600"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(eY.A,{size:24}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Link Eksternal"}),(0,a.jsx)("p",{className:"text-sm",children:"GitHub, Google Drive, dll."})]})]})})]}),"file"===C&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ".concat(I?"border-indigo-500 bg-indigo-50":"border-gray-300 hover:border-indigo-400 hover:bg-gray-50"),onDragEnter:ei,onDragLeave:ei,onDragOver:ei,onDrop:eo,children:u?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(T.A,{className:"text-indigo-500",size:24}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:u.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:sn(u.size)})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["application/pdf"===u.type&&(0,a.jsxs)("button",{onClick:()=>{F&&L(!0)},className:"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,a.jsx)(d.A,{size:16}),(0,a.jsx)("span",{className:"text-sm",children:"Preview"})]}),(0,a.jsx)("button",{onClick:()=>{F&&(so(F),U(null)),g(null)},className:"text-red-500 hover:text-red-700 p-1",children:(0,a.jsx)(x.A,{size:20})})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"File siap untuk diunggah"})]}):K?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center p-4 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(b.A,{className:"text-green-500",size:24}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-green-900",children:"File project berhasil diupload"}),(0,a.jsx)("p",{className:"text-sm text-green-700",children:"File siap untuk dikumpulkan"})]})]}),(0,a.jsxs)("button",{type:"button",onClick:async()=>{try{let e=await y.hJ.getFile(K);if(e.success){let s=window.URL.createObjectURL(e.data),t=document.createElement("a");t.href=s,t.download=e.filename||"download",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(s),document.body.removeChild(t)}}catch(e){console.error("Failed to download file:",e)}},className:"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,a.jsx)(eN.A,{size:16}),(0,a.jsx)("span",{className:"text-sm",children:"Download"})]})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Q.A,{className:"mx-auto text-gray-400",size:48}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag & drop file di sini atau"}),(0,a.jsxs)("label",{className:"inline-block bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 cursor-pointer transition-colors",children:["Pilih File",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:el,accept:".pdf,.docx,.doc,.zip"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsx)("p",{children:"Format yang didukung: PDF, DOCX, ZIP"}),(0,a.jsx)("p",{children:"Maksimal ukuran file: 50MB"})]})]})})}),"link"===C&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link Proyek *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(sa.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,a.jsx)("input",{type:"url",value:P,onChange:e=>z(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"https://github.com/username/project atau https://drive.google.com/...",required:!0})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Pastikan link dapat diakses oleh instruktur"})]})}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Proyek *"}),(0,a.jsx)("textarea",{value:p,onChange:e=>j(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:5,placeholder:"Jelaskan proyek Anda, teknologi yang digunakan, fitur utama, dan hal-hal penting lainnya...",required:!0})]}),(0,a.jsx)("div",{className:"mt-6 flex flex-col sm:flex-row gap-4",children:"not_submitted"===c?(0,a.jsx)("button",{onClick:ed,disabled:"file"===C?!p.trim()||J||!K:!P.trim()||!p.trim(),className:"flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 px-6 rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:"Kumpulkan Proyek Akhir"}):(0,a.jsx)("button",{onClick:ec,disabled:"file"===C?!p.trim()||J||!K:!P.trim()||!p.trim(),className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 px-6 rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:"Perbarui Proyek Akhir"})})]}),B&&(0,a.jsxs)("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-200",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-blue-800 mb-4",children:B.title}),(0,a.jsx)("p",{className:"text-blue-700 mb-4",children:B.description}),B.requirements&&B.requirements.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Requirements:"}),(0,a.jsx)("div",{className:"space-y-2 text-gray-700",children:B.requirements.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsx)("p",{children:e})]},s))})]}),B.deliverables&&B.deliverables.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Deliverables:"}),(0,a.jsx)("div",{className:"space-y-2 text-gray-700",children:B.deliverables.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsx)("p",{children:e})]},s))})]}),B.timeline&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-yellow-100 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Timeline:"}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm",children:B.timeline})]}),B.resources&&B.resources.length>0&&(0,a.jsxs)("div",{className:"p-4 bg-blue-100 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-800 mb-2",children:"Resources:"}),(0,a.jsx)("div",{className:"space-y-1 text-blue-700 text-sm",children:B.resources.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("p",{children:e})]},s))})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(X.A,{className:"".concat("saving"===R?"animate-spin text-blue-500":"saved"===R?"text-green-500":"text-red-500"),size:20}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["saving"===R&&"Menyimpan...","saved"===R&&_&&"Tersimpan otomatis ".concat(new Date(_).toLocaleTimeString("id-ID")),"error"===R&&"Gagal menyimpan"]})]}),"reviewed"===c&&(0,a.jsxs)("button",{onClick:er,className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-6 py-2 rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all duration-300 font-semibold flex items-center space-x-2",children:[(0,a.jsx)(b.A,{size:20}),(0,a.jsx)("span",{children:"Dapatkan Sertifikat"})]})]})})]})]}),Y&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB Submission Final Project"}),Z?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("span",{className:"text-gray-500",children:"⏳ Memuat submission..."})}):(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Final Project Submission"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:new Date(Y.submittedAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),Y.score&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:["Score: ",Y.score]})]}),Y.content&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Deskripsi Project:"}),(0,a.jsxs)("p",{className:"text-gray-800 text-sm bg-gray-50 p-2 rounded",children:[Y.content.substring(0,300),Y.content.length>300&&"..."]})]}),Y.fileId&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("button",{onClick:async()=>{try{let e=await y.hJ.getFile(Y.fileId);if(e.success){let s=window.URL.createObjectURL(e.data),t=document.createElement("a");t.href=s,t.download=e.filename||"download",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(s),document.body.removeChild(t)}}catch(e){console.error("Failed to download file:",e)}},className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800 text-sm",children:[(0,a.jsx)(eN.A,{size:16}),(0,a.jsx)("span",{children:"Download Project File"})]})}),Y.feedback&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Feedback:"}),(0,a.jsx)("p",{className:"text-blue-800 text-sm",children:Y.feedback})]})]})]}),E&&F&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl h-full max-h-[90vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF Preview"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("a",{href:F,download:null==u?void 0:u.name,className:"flex items-center space-x-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",children:[(0,a.jsx)(eN.A,{size:16}),(0,a.jsx)("span",{className:"text-sm",children:"Download"})]}),(0,a.jsx)("button",{onClick:()=>{L(!1)},className:"text-gray-500 hover:text-gray-700 p-1",children:(0,a.jsx)(x.A,{size:20})})]})]}),(0,a.jsx)("div",{className:"flex-1 p-4",children:(0,a.jsx)("iframe",{src:F,className:"w-full h-full border rounded-lg",title:"PDF Preview"})})]})})]})};var sx=t(55595);let su=e=>{let{courseId:s,courseName:r,onClose:n}=e,{currentUser:i,getUserProgress:o}=(0,l.A)(),d=o(s);console.log("Certificate component - userProgress:",d,"courseId:",s);let{certificates:c,isEligible:m,getCertificateForCourse:x,generateCertificate:u,isGenerating:g}=eG(s,d),h=x(s),p=async()=>{try{await u(),alert("Sertifikat berhasil dibuat!")}catch(e){console.error("Error generating certificate:",e),e.message.includes("already exists")?alert("Sertifikat untuk kursus ini sudah ada."):alert("Gagal membuat sertifikat. Silakan coba lagi.")}},j=async()=>{try{let e=(await Promise.all([t.e(930),t.e(628),t.e(316),t.e(260)]).then(t.t.bind(t,64227,23))).default,s='\n        <div style="\n          font-family: \'Georgia\', serif;\n          background: white;\n          padding: 60px;\n          text-align: center;\n          max-width: 800px;\n          margin: 0 auto;\n          border: 8px solid #f8f9fa;\n          position: relative;\n        ">\n          <div style="\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            right: 20px;\n            bottom: 20px;\n            border: 3px solid #667eea;\n            border-radius: 10px;\n          "></div>\n          <div style="color: #667eea; margin-bottom: 30px; position: relative; z-index: 1;">\n            <h1 style="font-size: 32px; margin: 0;">\uD83C\uDFC6 SERTIFIKAT PENYELESAIAN \uD83C\uDFC6</h1>\n          </div>\n          <div style="font-size: 36px; font-weight: bold; margin: 20px 0; color: #2d3748; position: relative; z-index: 1;">CERTIFICATE OF COMPLETION</div>\n          <div style="font-size: 18px; margin: 20px 0; color: #4a5568; position: relative; z-index: 1;">Dengan ini menyatakan bahwa</div>\n          <div style="font-size: 28px; font-weight: bold; color: #667eea; margin: 30px 0; text-decoration: underline; position: relative; z-index: 1;">'.concat(h.userName,'</div>\n          <div style="font-size: 18px; margin: 20px 0; color: #4a5568; position: relative; z-index: 1;">telah berhasil menyelesaikan kursus</div>\n          <div style="font-size: 22px; font-weight: bold; color: #2d3748; margin: 20px 0; position: relative; z-index: 1;">').concat(r,'</div>\n          <div style="margin: 30px 0; color: #718096; position: relative; z-index: 1;">\n            <p><strong>Nomor Sertifikat:</strong> ').concat(h.certificateNumber,"</p>\n            <p><strong>Tanggal Penyelesaian:</strong> ").concat(new Date(h.completionDate).toLocaleDateString("id-ID"),"</p>\n            <p><strong>Grade:</strong> ").concat(h.grade||"A","</p>\n          </div>\n        </div>\n      "),a=document.createElement("div");a.innerHTML=s,a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a);let l={margin:1,filename:"Sertifikat-".concat(r.replace(/\s+/g,"-"),"-").concat(h.userName.replace(/\s+/g,"-"),".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"landscape"}};await e().set(l).from(a).save(),document.body.removeChild(a)}catch(e){console.error("Error generating PDF:",e),alert("Gagal membuat PDF. Silakan coba lagi.")}};return h?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-4xl w-full overflow-hidden shadow-2xl",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 text-white p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,a.jsx)(ew.A,{size:32}),(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Sertifikat Penyelesaian"}),(0,a.jsx)(ew.A,{size:32})]})}),(0,a.jsx)("div",{className:"p-8",children:(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 p-8 rounded-xl border-4 border-yellow-300 relative",children:[(0,a.jsx)("div",{className:"absolute top-4 left-4 text-yellow-500",children:(0,a.jsx)(eh.A,{size:24})}),(0,a.jsx)("div",{className:"absolute top-4 right-4 text-yellow-500",children:(0,a.jsx)(eh.A,{size:24})}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4 text-yellow-500",children:(0,a.jsx)(eh.A,{size:24})}),(0,a.jsx)("div",{className:"absolute bottom-4 right-4 text-yellow-500",children:(0,a.jsx)(eh.A,{size:24})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(I.A,{className:"mx-auto text-yellow-500 mb-4",size:48}),(0,a.jsx)("h3",{className:"text-3xl font-bold text-gray-800 mb-2",children:"SERTIFIKAT PENYELESAIAN"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Certificate of Completion"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-lg text-gray-700 mb-2",children:"Dengan ini menyatakan bahwa"}),(0,a.jsx)("h4",{className:"text-2xl font-bold text-blue-600 mb-2",children:h.userName}),(0,a.jsx)("p",{className:"text-lg text-gray-700 mb-2",children:"telah berhasil menyelesaikan kursus"}),(0,a.jsx)("h5",{className:"text-xl font-bold text-gray-800",children:r})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6 text-sm",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(b.A,{className:"text-green-500",size:16}),(0,a.jsx)("span",{className:"font-semibold",children:"Nomor Sertifikat"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:h.certificateNumber})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(ef.A,{className:"text-blue-500",size:16}),(0,a.jsx)("span",{className:"font-semibold",children:"Tanggal Penyelesaian"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:new Date(h.completionDate).toLocaleDateString("id-ID")})]})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)("button",{onClick:n,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Tutup"}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob(["\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Sertifikat - ".concat(r,'</title>\n        <style>\n          body { \n            font-family: \'Georgia\', serif; \n            margin: 0; \n            padding: 40px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n          }\n          .certificate {\n            background: white;\n            padding: 60px;\n            border-radius: 20px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n            text-align: center;\n            max-width: 800px;\n            border: 8px solid #f8f9fa;\n            position: relative;\n          }\n          .certificate::before {\n            content: \'\';\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            right: 20px;\n            bottom: 20px;\n            border: 3px solid #667eea;\n            border-radius: 10px;\n          }\n          .header { color: #667eea; margin-bottom: 30px; }\n          .title { font-size: 48px; font-weight: bold; margin: 20px 0; color: #2d3748; }\n          .subtitle { font-size: 24px; margin: 20px 0; color: #4a5568; }\n          .name { font-size: 36px; font-weight: bold; color: #667eea; margin: 30px 0; text-decoration: underline; }\n          .course { font-size: 28px; font-weight: bold; color: #2d3748; margin: 20px 0; }\n          .details { margin: 30px 0; color: #718096; }\n          .signature { margin-top: 50px; display: flex; justify-content: space-between; }\n          .sig-line { border-top: 2px solid #e2e8f0; width: 200px; padding-top: 10px; }\n        </style>\n      </head>\n      <body>\n        <div class="certificate">\n          <div class="header">\n            <h1>\uD83C\uDFC6 SERTIFIKAT PENYELESAIAN \uD83C\uDFC6</h1>\n          </div>\n          <div class="title">CERTIFICATE OF COMPLETION</div>\n          <div class="subtitle">Dengan ini menyatakan bahwa</div>\n          <div class="name">').concat(h.userName,'</div>\n          <div class="subtitle">telah berhasil menyelesaikan kursus</div>\n          <div class="course">').concat(r,'</div>\n          <div class="details">\n            <p><strong>Nomor Sertifikat:</strong> ').concat(h.certificateNumber,"</p>\n            <p><strong>Tanggal Penyelesaian:</strong> ").concat(new Date(h.completionDate).toLocaleDateString("id-ID"),"</p>\n            <p><strong>Grade:</strong> ").concat(h.grade,"</p>\n          </div>\n        </div>\n      </body>\n      </html>\n    ")],{type:"text/html"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="Sertifikat-".concat(r.replace(/\s+/g,"-"),"-").concat(h.userName.replace(/\s+/g,"-"),".html"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center gap-2",children:[(0,a.jsx)(T.A,{size:20}),"Download HTML"]}),(0,a.jsxs)("button",{onClick:j,className:"px-6 py-3 bg-gradient-to-r from-red-600 to-pink-600 text-white rounded-lg hover:from-red-700 hover:to-pink-700 transition-all duration-200 flex items-center gap-2",children:[(0,a.jsx)(eN.A,{size:20}),"Download PDF"]})]})]})]})})]})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl max-w-2xl w-full p-8 text-center",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(ew.A,{className:"mx-auto text-yellow-500 mb-4",size:64}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:m?"Dapatkan Sertifikat Anda!":"Sertifikat Belum Tersedia"}),(0,a.jsx)("p",{className:"text-gray-600",children:m?"Selamat! Anda telah menyelesaikan kursus ".concat(r):"Selesaikan kursus ".concat(r," untuk mendapatkan sertifikat. Progress saat ini: ").concat(d||0,"%")})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4 mb-4",children:[(0,a.jsx)(sx.A,{className:"text-gold-500",size:32}),(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Sertifikat Resmi"}),(0,a.jsx)(sx.A,{className:"text-gold-500",size:32})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Sertifikat ini akan mencantumkan nama Anda, nama kursus, tanggal penyelesaian, dan nomor sertifikat unik yang dapat diverifikasi."})]}),(0,a.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,a.jsx)("button",{onClick:n,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Nanti Saja"}),(0,a.jsx)("button",{onClick:p,disabled:g||!m,className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center gap-2 disabled:opacity-50",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Membuat Sertifikat..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{size:20}),"Buat Sertifikat"]})})]})]})})};var sg=t(9428);let sh=e=>{let{currentStep:s,completedSteps:t,onStepClick:r,isCourseCompleted:l=!1,backendProgress:n=null,stageAccess:o={},courseConfig:d={}}=e,c=(e,s)=>{if("locked"===s||"admin-locked"===s)return void alert("admin-locked"===s?"Stage ini telah dikunci oleh admin. Silakan hubungi admin untuk membuka akses.":"Stage ini masih terkunci. Selesaikan stage sebelumnya terlebih dahulu.");r&&("available"===s||"current"===s||"completed"===s)&&r(e)},m=[{id:"intro",title:"Materi Pengantar",description:"Pelajari konsep dasar",icon:S.A,color:"blue"},{id:"pretest",title:"Pre-Test",description:"Tes pemahaman awal",icon:T.A,color:"purple"},{id:"lessons",title:"Materi Inti",description:"Pembelajaran utama",icon:S.A,color:"green"},{id:"posttest",title:"Post-Test & Survei",description:"Evaluasi & feedback",icon:I.A,color:"orange"},{id:"postwork",title:"Post Work",description:"Tugas praktik lanjutan",icon:Q.A,color:"orange"},{id:"finalproject",title:"Final Project",description:"Proyek akhir komprehensif",icon:eP.A,color:"red"}].filter(e=>"postwork"===e.id?!0===d.hasPostWork:"finalproject"!==e.id||!0===d.hasFinalProject),x=(e,a)=>{let r=o[e];if(r&&!r.canAccess)return"admin-locked";let n=m.every(e=>t.includes(e.id)),i=m.findIndex(e=>e.id===s);return t.includes(e)?"completed":e===s?"current":n||l?"available":0===a||t.includes(m[a-1].id)||a<=i?"available":"locked"},u=(e,s)=>{let t=e.icon;return"completed"===s?(0,a.jsx)(b.A,{className:"text-green-500",size:24}):"locked"===s||"admin-locked"===s?(0,a.jsx)(i.A,{className:"admin-locked"===s?"text-red-500":"text-gray-400",size:24}):(0,a.jsx)(t,{className:"text-".concat(e.color,"-500"),size:24})},g=(e,s)=>{let t="relative flex items-center p-4 rounded-xl transition-all duration-300 cursor-pointer";switch(e){case"completed":return"".concat(t," bg-green-50 border-2 border-green-200 hover:bg-green-100");case"current":return"".concat(t," bg-").concat(s,"-50 border-2 border-").concat(s,"-500 shadow-lg ring-2 ring-").concat(s,"-200");case"available":return"".concat(t," bg-gray-50 border-2 border-gray-200 hover:bg-gray-100 hover:border-").concat(s,"-300");case"admin-locked":return"".concat(t," bg-red-50 border-2 border-red-200 opacity-70 cursor-not-allowed");case"locked":return"".concat(t," bg-gray-50 border-2 border-gray-200 opacity-60 cursor-not-allowed");default:return t}},h=()=>null!==n?n:Math.round(t.length/m.length*100);return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Progress Pembelajaran"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-gray-600",children:l?"Kursus telah selesai! Anda dapat mengakses semua materi untuk review":"Ikuti setiap tahap untuk menyelesaikan kursus"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold ".concat(l?"text-green-600":"text-blue-600"),children:[h(),"%"]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Selesai"})]})]}),(0,a.jsx)("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(h(),"%")}})})]}),(0,a.jsx)("div",{className:"hidden lg:block",children:(0,a.jsx)("div",{className:"grid gap-4 ".concat(m.length<=3?"grid-cols-3":m.length<=4?"grid-cols-2":(m.length,"grid-cols-3")),children:m.map((e,s)=>{let t=x(e.id,s);return(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:g(t,e.color),onClick:()=>c(e.id,t),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:u(e,t)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:e.title})}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]})]}),(0,a.jsx)("div",{className:"absolute -top-2 -right-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ".concat("completed"===t?"bg-green-500 text-white":"current"===t?"bg-".concat(e.color,"-500 text-white"):"available"===t?"bg-gray-400 text-white":"bg-gray-300 text-gray-500"),children:s+1})]})},e.id)})})}),(0,a.jsx)("div",{className:"lg:hidden space-y-4",children:m.map((e,s)=>{let r=x(e.id,s);return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:g(r,e.color),onClick:()=>c(e.id,r),children:(0,a.jsxs)("div",{className:"flex items-center space-x-4 w-full",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:u(e,r)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:e.title})}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ".concat("completed"===r?"bg-green-500 text-white":"current"===r?"bg-".concat(e.color,"-500 text-white"):"available"===r?"bg-gray-400 text-white":"bg-gray-300 text-gray-500"),children:s+1})]})}),s<m.length-1&&(0,a.jsx)("div",{className:"flex justify-center py-2",children:(0,a.jsx)("div",{className:"w-1 h-8 ".concat(t.includes(e.id)?"bg-green-400":"bg-gray-300"," rounded-full")})})]},e.id)})}),(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-xs mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.A,{className:"text-green-500",size:16}),(0,a.jsx)("span",{className:"text-gray-600",children:"Selesai"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(sg.A,{className:"text-blue-500",size:16}),(0,a.jsx)("span",{className:"text-gray-600",children:"Sedang Aktif"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(sg.A,{className:"text-gray-400",size:16}),(0,a.jsx)("span",{className:"text-gray-600",children:"Tersedia"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.A,{className:"text-gray-400",size:16}),(0,a.jsx)("span",{className:"text-gray-600",children:"Terkunci"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.A,{className:"text-red-500",size:16}),(0,a.jsx)("span",{className:"text-gray-600",children:"Dikunci Admin"})]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:(0,a.jsxs)("p",{children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{children:"Catatan:"})," Setiap langkah memiliki bobot yang sama dalam menentukan progres pembelajaran Anda."]})})]})]})},sp=e=>{var s;let{currentLesson:t,onBack:n,preTestState:i,postTestState:o,onRetakeQuiz:d,onMarkComplete:c}=e,{getCourseById:m,currentUser:x,getUserProgress:u,getUserProgressSync:g,refreshUserProgress:h}=(0,l.A)(),[p,b]=(0,r.useState)(!1),[j,f]=(0,r.useState)(0),[N,v]=(0,r.useState)(t),[w,k]=(0,r.useState)(!1),[A,S]=(0,r.useState)({}),[C,D]=(0,r.useState)(!1),[P,z]=(0,r.useState)(null),[I,T]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(null==t?void 0:t.id){k(!0);try{let e=await m(t.id);e&&(e.id||e.title)?v(e):(console.error("Course data incomplete from backend:",e),v(t))}catch(e){console.error("Failed to load course from backend:",e),v(null)}finally{k(!1)}}})()},[null==t?void 0:t.id,m]),(0,r.useEffect)(()=>{(async()=>{if((null==N?void 0:N.id)&&x){T(!0);try{let e=await fetch("".concat("https://api.mindshiftlearning.id","/api/protected/courses/").concat(N.id,"/config"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken")),"Content-Type":"application/json"}});if(e.ok){let s=await e.json();z({hasPostWork:s.hasPostWork||!1,hasFinalProject:s.hasFinalProject||!1,certificateDelay:s.certificateDelay||0,stepWeights:s.stepWeights||{}})}else console.warn("Failed to load course config, using defaults"),z({hasPostWork:!1,hasFinalProject:!1,certificateDelay:0,stepWeights:{}})}catch(e){console.error("Error loading course config:",e),z({hasPostWork:!1,hasFinalProject:!1,certificateDelay:0,stepWeights:{}})}finally{T(!1)}}})()},[null==N?void 0:N.id,x]),(0,r.useEffect)(()=>{(async()=>{if(!(null==N?void 0:N.id)||!x)return;D(!0);let e={};try{for(let s of["intro","pretest","lessons","posttest","postwork","finalproject"])try{let t=await y.GS.checkStageAccess(N.id,s),a=t.data||t;e[s]={canAccess:a.canAccess,lockMessage:a.lockMessage||"Tahap ini masih dikunci oleh admin."}}catch(t){console.warn("Failed to check access for stage ".concat(s,":"),t),e[s]={canAccess:!0,lockMessage:null}}S(e)}catch(e){console.error("Error checking stage access:",e)}finally{D(!1)}})()},[null==N?void 0:N.id,x]);let{progress:M,isLoading:E,setCurrentStep:L,markStepCompleted:F,updateLessonProgress:U,saveQuizScore:R,saveSubmission:q,markCourseCompleted:_,getCompletionPercentage:O,isCourseCompleted:B}=eJ(null==N?void 0:N.id),W=g(null==N?void 0:N.id)||0,{certificates:J,isEligible:G,isGenerating:V,generateCertificate:Q,getCertificateForCourse:Y}=eG(null==N?void 0:N.id,W);if((0,r.useEffect)(()=>{M.currentStep&&"intro"!==M.currentStep&&!E&&console.log("Resuming to step:",M.currentStep)},[M.currentStep,E]),(0,r.useEffect)(()=>{var e;(null==(e=M.lessonProgress)?void 0:e.currentLessonIndex)!==void 0&&f(M.lessonProgress.currentLessonIndex)},[null==(s=M.lessonProgress)?void 0:s.currentLessonIndex]),!N||w||E||I)return(0,a.jsx)("div",{className:"max-w-6xl mx-auto p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:N?w?"Loading course details...":I?"Loading course configuration...":"Loading progress...":"Loading course..."})]})});let H=async e=>{F(e);try{await h()}catch(e){console.warn("Failed to refresh user progress:",e)}let s=(()=>{let e=["intro","pretest","lessons","posttest"];return(null==P?void 0:P.hasPostWork)&&e.push("postwork"),(null==P?void 0:P.hasFinalProject)&&e.push("finalproject"),e})(),t=s.indexOf(e);if(t<s.length-1){let e=s[t+1],a=A[e];if(a&&!a.canAccess)return void alert(a.lockMessage||"Tahap selanjutnya telah dikunci oleh admin. Silakan hubungi admin untuk membuka akses.");L(e)}},X=()=>{H("pretest")},Z=async e=>{var s,t;console.log("handleLessonComplete called with:",{lessonId:e,currentLessonIndex:j,courseId:N.id});let a=[...new Set([...(null==(s=M.lessonProgress)?void 0:s.completedLessons)||[],j])];console.log("Updating lesson progress:",{currentLessonIndex:j,completedLessons:a,totalLessons:N.lessons.length}),await U(j,{currentLessonIndex:j,completedLessons:a,timeSpent:((null==(t=M.lessonProgress)?void 0:t.timeSpent)||0)+1,lastCompletedLesson:j,lastCompletedAt:new Date().toISOString()});let r=a.length>=N.lessons.length,l=j===N.lessons.length-1;r||l?(console.log("Lessons completed! Marking lessons step as complete and navigating to post test."),await H("lessons")):(console.log("Lesson ".concat(j+1," completed. ").concat(a.length,"/").concat(N.lessons.length," lessons done.")),j<N.lessons.length-1&&f(j+1)),c&&(console.log("Calling parent onMarkComplete"),c())};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("button",{onClick:n,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-800 mb-4 px-4 lg:px-0",children:[(0,a.jsx)(K.A,{size:20}),(0,a.jsx)("span",{children:"Back to Dashboard"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 sm:p-8 text-white",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:N.title}),(0,a.jsx)("p",{className:"text-blue-100 text-sm sm:text-base",children:N.description}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg px-3 py-1",children:[(0,a.jsxs)("span",{className:"font-medium",children:[M.completedSteps.length,"/",(()=>{let e=["intro","pretest","lessons","posttest"];return(null==P?void 0:P.hasPostWork)&&e.push("postwork"),(null==P?void 0:P.hasFinalProject)&&e.push("finalproject"),e.length})()]})," Tahap Selesai"]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg px-3 py-1",children:[(0,a.jsxs)("span",{className:"font-medium",children:[O(),"%"]})," Progress"]})]})]}),(M.isCompleted||B())&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-blue-600 text-white p-6 sm:p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,a.jsx)(ew.A,{size:48,className:"text-yellow-300"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Selamat! \uD83C\uDF89"}),(0,a.jsx)("p",{className:"text-green-100 text-lg",children:"Anda telah menyelesaikan course ini!"})]}),(0,a.jsx)(ew.A,{size:48,className:"text-yellow-300"})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-xl p-4 sm:p-6 text-center",children:[(0,a.jsxs)("p",{className:"text-lg mb-2",children:["Course ",(0,a.jsx)("strong",{children:N.title})," telah selesai!"]}),(0,a.jsx)("p",{className:"text-green-100",children:"Untuk sertifikat, silakan cek menu Achievement."})]})]}),(0,a.jsx)("div",{className:"p-4 sm:p-6 bg-gray-50",children:(0,a.jsx)(sh,{currentStep:M.currentStep,completedSteps:M.completedSteps,onStepClick:e=>{let s=(()=>{let e=["intro","pretest","lessons","posttest"];return(null==P?void 0:P.hasPostWork)&&e.push("postwork"),(null==P?void 0:P.hasFinalProject)&&e.push("finalproject"),e})(),t=s.indexOf(e),a=s.indexOf(M.currentStep),r=A[e];if(r&&!r.canAccess)return void alert(r.lockMessage||"Tahap ini masih dikunci oleh admin.");let l=s.every(e=>M.completedSteps.includes(e));(0===t||M.completedSteps.includes(e)||e===M.currentStep||M.completedSteps.includes(s[t-1])||l||M.isCompleted||t<=a)&&L(e)},isCourseCompleted:B(),backendProgress:O(),stageAccess:A,courseConfig:P})}),(0,a.jsxs)("div",{className:"p-4 sm:p-8",children:["intro"===M.currentStep&&(0,a.jsx)(e$,{material:N.introMaterial||{content:N.description},onComplete:()=>H("intro")}),"pretest"===M.currentStep&&(0,a.jsx)(e5,{courseId:null==N?void 0:N.id,onComplete:e=>{console.log("Pre-test completed:",e),e.shouldProceed&&e.passed&&X()},onBack:n}),"lessons"===M.currentStep&&(0,a.jsx)(se,{lessons:N.lessons,onMarkComplete:Z,courseId:N.id,currentLessonIndex:j,onLessonChange:e=>{var s,t;f(e),U(N.id,{currentLessonIndex:e,completedLessons:(null==(s=M.lessonProgress)?void 0:s.completedLessons)||[],timeSpent:((null==(t=M.lessonProgress)?void 0:t.timeSpent)||0)+1})}}),"posttest"===M.currentStep&&(0,a.jsx)(ss,{courseId:null==N?void 0:N.id,onComplete:e=>{console.log("Post-test with survey completed:",e),H("posttest")},onBack:n}),"postwork"===M.currentStep&&(null==P?void 0:P.hasPostWork)&&(0,a.jsx)(st,{courseId:N.id,onSubmit:e=>{console.log("Post work submitted:",e),q("postwork",e),H("postwork")},stageAccess:A}),"finalproject"===M.currentStep&&(null==P?void 0:P.hasFinalProject)&&(0,a.jsx)(sm,{courseId:N.id,onSubmit:e=>{console.log("Final project submitted:",e),q("finalproject",e),H("finalproject"),_()},stageAccess:A})]})]}),p&&(0,a.jsx)(su,{courseId:N.id,courseName:N.title,onClose:()=>b(!1)})]})};var sb=t(84355),sj=t(28883),sf=t(19420),sy=t(4516);let sN=()=>{let{currentUser:e}=(0,l.A)(),[s,t]=(0,r.useState)({name:"",email:"",bio:"",phone:"",location:"",occupation:"",education:"",avatar:null}),[c,m]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[x,u]=(0,r.useState)({current:!1,new:!1,confirm:!1}),[g,h]=(0,r.useState)(""),[p,b]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&t({name:e.fullName||e.username||"",email:e.email||"",bio:e.bio||"Saya adalah peserta kursus yang bersemangat untuk belajar dan mengembangkan keterampilan baru.",phone:e.phone||"+62 812-3456-7890",location:e.location||"Jakarta, Indonesia",occupation:e.occupation||"Software Developer",education:e.education||"S1 Teknik Informatika",avatar:e.avatar||null})},[e]);let j=e=>{let{name:s,value:a}=e.target;t(e=>({...e,[s]:a}))},f=e=>{let{name:s,value:t}=e.target;m(e=>({...e,[s]:t})),g&&h(""),p&&b("")},N=e=>{u(s=>({...s,[e]:!s[e]}))},v=async()=>{if(h(""),b(""),!c.currentPassword)return void h("Password saat ini harus diisi");if(!c.newPassword)return void h("Password baru harus diisi");if(c.newPassword.length<3)return void h("Password baru minimal 3 karakter");if(c.newPassword!==c.confirmPassword)return void h("Konfirmasi password tidak cocok");if(c.currentPassword===c.newPassword)return void h("Password baru harus berbeda dari password saat ini");try{let e=await y.R2.changePassword(c.currentPassword,c.newPassword);e.success?(b(e.message||"Password berhasil diubah!"),m({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{b("")},3e3)):h(e.error||"Gagal mengubah password")}catch(e){h(e.message||"Gagal mengubah password. Pastikan password saat ini benar.")}};return(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 text-gray-700",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 sm:p-8 text-white",children:[(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"Profile Settings"}),(0,a.jsx)("p",{className:"text-blue-100",children:"Manage your account information and preferences"})]}),(0,a.jsxs)("div",{className:"p-6 sm:p-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-8",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-24 h-24 sm:w-32 sm:h-32 bg-gray-200 rounded-full flex items-center justify-center",children:s.avatar?(0,a.jsx)("img",{src:s.avatar,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):(0,a.jsx)(n.A,{size:40,className:"text-gray-400"})}),(0,a.jsx)("button",{className:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full hover:bg-blue-700 transition-colors",children:(0,a.jsx)(sb.A,{size:16})})]}),(0,a.jsxs)("div",{className:"text-center sm:text-left",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Profile Picture"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:"Upload a new profile picture"}),(0,a.jsx)("button",{className:"mt-2 text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Change Photo"})]})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("Profile updated:",s)},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(n.A,{size:16,className:"inline mr-2"}),"Full Name"]}),(0,a.jsx)("input",{type:"text",name:"name",value:s.name,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Your Full Name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(sj.A,{size:16,className:"inline mr-2"}),"Email Address"]}),(0,a.jsx)("input",{type:"email",name:"email",value:s.email,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"your@email.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(sf.A,{size:16,className:"inline mr-2"}),"Phone Number"]}),(0,a.jsx)("input",{type:"tel",name:"phone",value:s.phone,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"+62 812-3456-7890"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(sy.A,{size:16,className:"inline mr-2"}),"Location"]}),(0,a.jsx)("input",{type:"text",name:"location",value:s.location,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Jakarta, Indonesia"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(eC.A,{size:16,className:"inline mr-2"}),"Occupation"]}),(0,a.jsx)("input",{type:"text",name:"occupation",value:s.occupation,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Software Developer"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(U.A,{size:16,className:"inline mr-2"}),"Education"]}),(0,a.jsx)("input",{type:"text",name:"education",value:s.education,onChange:j,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"S1 Teknik Informatika"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"About You"}),(0,a.jsx)("textarea",{name:"bio",value:s.bio,onChange:j,rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Tell us about yourself..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Learning Preferences"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Learning Style"}),(0,a.jsxs)("select",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select your preference"}),(0,a.jsx)("option",{value:"visual",children:"Visual Learning"}),(0,a.jsx)("option",{value:"auditory",children:"Auditory Learning"}),(0,a.jsx)("option",{value:"kinesthetic",children:"Hands-on Learning"}),(0,a.jsx)("option",{value:"reading",children:"Reading/Writing"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skill Level"}),(0,a.jsxs)("select",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"",children:"Select your level"}),(0,a.jsx)("option",{value:"beginner",children:"Beginner"}),(0,a.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,a.jsx)("option",{value:"advanced",children:"Advanced"}),(0,a.jsx)("option",{value:"expert",children:"Expert"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(i.A,{size:16,className:"inline mr-2"}),"Password Saat Ini"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.current?"text":"password",name:"currentPassword",value:c.currentPassword,onChange:f,className:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Masukkan password saat ini"}),(0,a.jsx)("button",{type:"button",onClick:()=>N("current"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x.current?(0,a.jsx)(o.A,{size:20}):(0,a.jsx)(d.A,{size:20})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(i.A,{size:16,className:"inline mr-2"}),"Password Baru"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.new?"text":"password",name:"newPassword",value:c.newPassword,onChange:f,className:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Masukkan password baru (minimal 6 karakter)"}),(0,a.jsx)("button",{type:"button",onClick:()=>N("new"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x.new?(0,a.jsx)(o.A,{size:20}):(0,a.jsx)(d.A,{size:20})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,a.jsx)(i.A,{size:16,className:"inline mr-2"}),"Konfirmasi Password Baru"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:x.confirm?"text":"password",name:"confirmPassword",value:c.confirmPassword,onChange:f,className:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Konfirmasi password baru"}),(0,a.jsx)("button",{type:"button",onClick:()=>N("confirm"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x.confirm?(0,a.jsx)(o.A,{size:20}):(0,a.jsx)(d.A,{size:20})})]})]})]}),g&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:g}),p&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:p}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("button",{type:"button",onClick:v,className:"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center space-x-2",children:[(0,a.jsx)(i.A,{size:16}),(0,a.jsx)("span",{children:"Ubah Password"})]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notification Settings"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"Email notifications for new courses"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"Push notifications for course reminders"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:"Weekly progress reports"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4 pt-6 border-t",children:[(0,a.jsx)("button",{type:"button",className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[(0,a.jsx)(X.A,{size:16}),(0,a.jsx)("span",{children:"Update Profile"})]})]})]})]})]})})},sv=()=>{let{currentUser:e,getUserProgressSync:s}=(0,l.A)(),{certificates:n,loadCertificates:i}=eG(),[o,d]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{if(null==e?void 0:e.id)try{let e=await s();if(e&&Array.isArray(e)){let s=e.filter(e=>e.overall_progress>=100);for(let e of(d(s),s))if(!n.find(s=>s.courseId===e.course_id)){console.log("Auto-requesting certificate for completed course ".concat(e.course_id));try{let{requestCertificate:s}=await Promise.resolve().then(t.bind(t,39360));await s(e.course_id)}catch(s){console.error("Failed to auto-request certificate for course ".concat(e.course_id,":"),s)}}s.length>0&&setTimeout(()=>{i()},2e3)}}catch(e){console.error("Error checking completed courses:",e)}})()},[null==e?void 0:e.id,n.length]);let c=async e=>{try{let s=(await Promise.all([t.e(930),t.e(628),t.e(316),t.e(260)]).then(t.t.bind(t,64227,23))).default,a='\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="UTF-8">\n          <style>\n            body {\n              margin: 0;\n              padding: 40px;\n              font-family: \'Georgia\', serif;\n              background: white;\n              width: 1000px;\n              height: 700px;\n              box-sizing: border-box;\n            }\n            .certificate {\n              width: 100%;\n              height: 100%;\n              border: 8px solid #f8f9fa;\n              padding: 40px;\n              text-align: center;\n              position: relative;\n              background: white;\n              box-sizing: border-box;\n            }\n            .border-inner {\n              position: absolute;\n              top: 20px;\n              left: 20px;\n              right: 20px;\n              bottom: 20px;\n              border: 3px solid #667eea;\n              border-radius: 10px;\n            }\n            .content {\n              position: relative;\n              z-index: 1;\n              height: 100%;\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n            }\n            .title {\n              color: #667eea;\n              margin-bottom: 20px;\n            }\n            .title h1 {\n              font-size: 28px;\n              margin: 0;\n            }\n            .main-title {\n              font-size: 32px;\n              font-weight: bold;\n              margin: 15px 0;\n              color: #2d3748;\n            }\n            .subtitle {\n              font-size: 16px;\n              margin: 15px 0;\n              color: #4a5568;\n            }\n            .name {\n              font-size: 24px;\n              font-weight: bold;\n              color: #667eea;\n              margin: 20px 0;\n              text-decoration: underline;\n            }\n            .course {\n              font-size: 20px;\n              font-weight: bold;\n              color: #2d3748;\n              margin: 15px 0;\n            }\n            .details {\n              margin: 20px 0;\n              color: #718096;\n            }\n            .details p {\n              margin: 8px 0;\n              font-size: 14px;\n            }\n            .signatures {\n              margin-top: 40px;\n              display: flex;\n              justify-content: space-between;\n            }\n            .signature {\n              border-top: 2px solid #e2e8f0;\n              width: 180px;\n              padding-top: 10px;\n              font-size: 14px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="certificate">\n            <div class="border-inner"></div>\n            <div class="content">\n              <div class="title">\n                <h1>\uD83C\uDFC6 SERTIFIKAT PENYELESAIAN \uD83C\uDFC6</h1>\n              </div>\n              <div class="main-title">CERTIFICATE OF COMPLETION</div>\n              <div class="subtitle">Dengan ini menyatakan bahwa</div>\n              <div class="name">'.concat(e.userName||"Student",'</div>\n              <div class="subtitle">telah berhasil menyelesaikan kursus</div>\n              <div class="course">').concat(e.courseName||"Course",'</div>\n              <div class="details">\n                <p><strong>Nomor Sertifikat:</strong> ').concat(e.certNumber||"N/A","</p>\n                <p><strong>Tanggal Penyelesaian:</strong> ").concat(e.completionDate?new Date(e.completionDate).toLocaleDateString("id-ID"):"N/A","</p>\n              </div>\n            </div>\n          </div>\n        </body>\n        </html>\n      "),r={margin:.5,filename:"Sertifikat-".concat((e.courseName||"course").replace(/\s+/g,"-"),"-").concat((e.userName||"Student").replace(/\s+/g,"-"),".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,letterRendering:!0,allowTaint:!1,backgroundColor:"#ffffff"},jsPDF:{unit:"in",format:"a4",orientation:"landscape",compress:!0}};await s().set(r).from(a).save()}catch(e){console.error("Error generating PDF:",e),alert("Gagal membuat PDF. Silakan coba lagi.")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-4 flex items-center justify-center gap-3",children:[(0,a.jsx)(ew.A,{className:"w-8 h-8 text-yellow-500"}),"Your Achievements"]}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"View and download your course completion certificates"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===n.length?(0,a.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,a.jsx)(sx.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-500 mb-2",children:"No Certificates Yet"}),(0,a.jsx)("p",{className:"text-gray-400",children:"Complete courses to earn your first certificate!"})]}):n.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden hover:shadow-xl transition-shadow duration-300",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(I.A,{className:"w-8 h-8"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:[void 0,void 0,void 0,void 0,void 0].map((s,t)=>(0,a.jsx)(eh.A,{className:"w-4 h-4 ".concat(t<Math.floor(e.grade/20)?"text-yellow-300 fill-current":"text-white/50")},t))})]}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-2",children:e.courseName||"Course"}),(0,a.jsxs)("p",{className:"text-blue-100 text-sm",children:["Certificate #",e.certNumber||"N/A"]})]}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,a.jsx)(ef.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"text-sm",children:["Completed: ",e.completionDate?new Date(e.completionDate).toLocaleDateString():"N/A"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,a.jsx)(ew.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"text-sm",children:["Grade: ",e.grade||100,"%"]})]}),e.timeSpent&&(0,a.jsxs)("div",{className:"flex items-center gap-3 text-gray-600",children:[(0,a.jsx)(S.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"text-sm",children:["Time Spent: ",e.timeSpent]})]})]}),e.skills&&e.skills.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Skills Acquired:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.skills.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},s))})]}),"pending"===e.status?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-yellow-100 text-yellow-800 font-semibold py-3 px-4 rounded-lg text-center",children:"Menunggu Persetujuan Admin"}),(0,a.jsxs)("button",{disabled:!0,className:"w-full bg-gray-300 text-gray-500 font-semibold py-3 px-4 rounded-lg cursor-not-allowed flex items-center justify-center gap-2",children:[(0,a.jsx)(eN.A,{className:"w-4 h-4"}),"Download Certificate"]})]}):"approved"===e.status?(0,a.jsxs)("button",{onClick:()=>c(e),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,a.jsx)(eN.A,{className:"w-4 h-4"}),"Download Certificate"]}):"rejected"===e.status?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-red-100 text-red-800 font-semibold py-3 px-4 rounded-lg text-center",children:"Sertifikat Ditolak"}),e.rejectionReason&&(0,a.jsxs)("div",{className:"text-sm text-red-600 text-center",children:["Alasan: ",e.rejectionReason]}),(0,a.jsxs)("button",{disabled:!0,className:"w-full bg-gray-300 text-gray-500 font-semibold py-3 px-4 rounded-lg cursor-not-allowed flex items-center justify-center gap-2",children:[(0,a.jsx)(eN.A,{className:"w-4 h-4"}),"Download Certificate"]})]}):(0,a.jsxs)("button",{onClick:()=>c(e),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,a.jsx)(eN.A,{className:"w-4 h-4"}),"Download Certificate"]})]})]},e.id))}),n.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mt-8",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Achievement Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:n.length}),(0,a.jsx)("div",{className:"text-gray-600",children:"Certificates Earned"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-600 mb-2",children:[(()=>{let e=n.reduce((e,s)=>e+(s.grade||100),0);return n.length>0?Math.round(e/n.length):0})(),"%"]}),(0,a.jsx)("div",{className:"text-gray-600",children:"Average Grade"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:new Set(n.flatMap(e=>e.skills||[])).size}),(0,a.jsx)("div",{className:"text-gray-600",children:"Skills Acquired"})]})]})]})]})},sw=e=>{let{onStartLearning:s}=e,{courses:t,enrollments:n,currentUser:i}=(0,l.A)(),o=(0,r.useMemo)(()=>(Array.isArray(n)?n:[]).map(e=>({...e,id:e.id||e.course_id,isEnrolled:!0})),[n]),d=(0,r.useMemo)(()=>{let e=o.length,s=o.filter(e=>100===e.progress).length,t=o.filter(e=>e.progress>0&&e.progress<100).length,a=e>0?Math.round(o.reduce((e,s)=>e+(s.progress||0),0)/e):0;return{total:e,completed:s,inProgress:t,average:a}},[o]);return i?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"My Courses"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Track your learning progress and continue your courses"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(S.A,{className:"text-blue-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:d.total}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Enrolled"})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(f.A,{className:"text-yellow-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:d.inProgress}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"In Progress"})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(b.A,{className:"text-green-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:d.completed}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Completed"})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(eO.A,{className:"text-purple-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[d.average,"%"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Progress"})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Your Enrolled Courses"}),0===o.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(S.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Enrolled Courses"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"You haven't enrolled in any courses yet. Browse available courses to start learning!"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Browse Courses"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>(0,a.jsx)(B,{course:e,onStartLearning:s},e.id))})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(S.A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Please Login"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need to login to view your enrolled courses."})]})};var sk=t(11518),sA=t.n(sk),sS=t(71366);let sC=()=>{let[e,s]=(0,r.useState)(!1),t=[{id:"whatsapp",label:"WhatsApp",icon:sS.A,color:"bg-green-500 hover:bg-green-600",action:()=>{window.open("https://wa.me/6285255149256?text=Halo%20Admin%2C%20saya%20membutuhkan%20bantuan%20terkait%20kursus","_blank")}},{id:"email",label:"Email",icon:sj.A,color:"bg-blue-500 hover:bg-blue-600",action:()=>{window.location.href="mailto:ramdan.einstein@gmail.com?subject=Bantuan%20Kursus&body=Halo%20Admin%2C%0A%0ASaya%20membutuhkan%20bantuan%20terkait%3A%0A%0ATerima%20kasih."}},{id:"phone",label:"Telepon",icon:sf.A,color:"bg-purple-500 hover:bg-purple-600",action:()=>{window.location.href="tel:+6285255149256"}}];return(0,a.jsxs)(a.Fragment,{children:[e&&(0,a.jsx)("div",{onClick:()=>s(!1),className:"jsx-33581d6acf983a05 fixed inset-0 bg-black bg-opacity-20 z-40 lg:hidden"}),(0,a.jsx)("div",{className:"jsx-33581d6acf983a05 "+"fixed bottom-24 right-6 z-50 transition-all duration-300 ".concat(e?"opacity-100 translate-y-0":"opacity-0 translate-y-4 pointer-events-none"),children:(0,a.jsx)("div",{className:"jsx-33581d6acf983a05 flex flex-col gap-3",children:t.map((s,t)=>{let r=s.icon;return(0,a.jsxs)("button",{onClick:s.action,style:{animationDelay:"".concat(50*t,"ms"),animation:e?"slideInUp 0.3s ease-out forwards":"none"},title:s.label,className:"jsx-33581d6acf983a05 "+"".concat(s.color," text-white p-3 rounded-full shadow-lg transition-all duration-200 transform hover:scale-110 flex items-center gap-2 min-w-[48px] justify-center group"),children:[(0,a.jsx)(r,{size:20,className:"jsx-33581d6acf983a05"}),(0,a.jsx)("span",{className:"jsx-33581d6acf983a05 hidden group-hover:inline-block text-sm font-medium whitespace-nowrap",children:s.label}),(0,a.jsx)(eY.A,{size:12,className:"hidden group-hover:inline-block"})]},s.id)})})}),(0,a.jsx)("button",{onClick:()=>s(!e),title:"Hubungi Admin",className:"jsx-33581d6acf983a05 "+"fixed bottom-6 right-6 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-full shadow-lg transition-all duration-300 transform hover:scale-110 hover:shadow-xl ".concat(e?"rotate-45":"rotate-0"),children:e?(0,a.jsx)(x.A,{size:24,className:"transition-transform duration-300"}):(0,a.jsx)(sS.A,{size:24,className:"transition-transform duration-300"})}),!e&&(0,a.jsxs)("div",{className:"jsx-33581d6acf983a05 fixed bottom-6 right-20 z-40 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm font-medium opacity-0 hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:["Butuh Bantuan?",(0,a.jsx)("div",{className:"jsx-33581d6acf983a05 absolute top-1/2 -right-1 transform -translate-y-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),(0,a.jsx)(sA(),{id:"33581d6acf983a05",children:"@-webkit-keyframes slideInUp{from{opacity:0;-webkit-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideInUp{from{opacity:0;-moz-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideInUp{from{opacity:0;-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideInUp{from{opacity:0;-webkit-transform:translatey(20px);-moz-transform:translatey(20px);-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})};var sD=t(13052);let sP=()=>{let{currentUser:e,courses:s,isLoading:t}=(0,l.A)(),[n,i]=(0,r.useState)(null),[o,d]=(0,r.useState)("");(0,r.useEffect)(()=>{s&&s.length>0&&d("")},[s]);let c=e=>{i(e)};return e&&"admin"===e.role?t?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Memuat daftar courses..."})]})}):n?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>{i(null)},className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 transition-colors",children:[(0,a.jsx)(K.A,{size:20}),(0,a.jsx)("span",{children:"Kembali ke Daftar Courses"})]})}),(0,a.jsx)(e_,{courseId:n.id,courseName:n.title})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Stage Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Kelola akses tahap pembelajaran untuk setiap course"})]}),(0,a.jsxs)("div",{className:"p-6",children:[o&&(0,a.jsxs)("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(M.A,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:"Error"})]}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:o})]}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(M.A,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak Ada Courses"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Belum ada courses yang tersedia untuk dikelola."})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Pilih course untuk mengelola akses tahap pembelajaran:"}),s.map(e=>(0,a.jsx)("div",{onClick:()=>c(e),className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:bg-blue-50 cursor-pointer transition-all",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["ID: ",e.id]}),(0,a.jsxs)("span",{children:["Dibuat: ",new Date(e.createdAt).toLocaleDateString("id-ID")]})]})]}),(0,a.jsx)(sD.A,{size:20,className:"text-gray-400"})]})},e.id))]})]})]}):(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-700",children:[(0,a.jsx)(M.A,{size:20}),(0,a.jsx)("span",{className:"font-medium",children:"Akses Ditolak"})]}),(0,a.jsx)("p",{className:"text-red-600 mt-1",children:"Hanya admin yang dapat mengakses fitur ini."})]})},sz=()=>{let{currentUser:e,isLoading:s,courses:t,updateCourses:n}=(0,l.A)(),[i,o]=(0,r.useState)("dashboard"),[d,c]=(0,r.useState)(null),[x,u]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),[p,b]=(0,r.useState)({reading:{},video:{},preTest:{},postTest:{}}),[j,f]=(0,r.useState)({showResult:!1,score:0}),[y,N]=(0,r.useState)({showResult:!1,score:0}),[w,A]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(console.log("User changed:",e),e){let s="admin"===e.role?"overview":"dashboard";console.log("Setting view to:",s),o(s)}},[e]);let S=e=>{u(e),o("course"),window.innerWidth<1024&&h(!1)};return s?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 lg:flex",children:[(0,a.jsx)(k,{isSidebarOpen:g,setIsSidebarOpen:h}),(0,a.jsx)(q,{currentView:i,setCurrentView:o,isSidebarOpen:g,setIsSidebarOpen:h,userRole:e.role,onAnnouncementClick:()=>A(!0)}),(0,a.jsx)("div",{className:"w-full lg:flex-1 pt-16 lg:pt-0 pb-20 lg:pb-0",children:(0,a.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8",children:["dashboard"===i&&e&&"admin"!==e.role&&(0,a.jsx)(W,{onStartLearning:S}),"courses"===i&&e&&"admin"!==e.role&&(0,a.jsx)(sw,{onStartLearning:S}),("overview"===i||"courses"===i||"quizzes"===i||"surveys"===i||"announcements"===i||"certificates"===i||"project-instructions"===i||"course-instructions"===i||"course-config"===i||"users"===i||"test-results"===i||"students"===i)&&"admin"===e.role&&(0,a.jsx)(eW,{activeTab:i}),"stage-management"===i&&"admin"===e.role&&(0,a.jsx)(sP,{}),"course"===i&&(0,a.jsx)(sp,{currentLesson:x,onBack:()=>{o("dashboard"),u(null)},preTestState:j,postTestState:y,onRetakeQuiz:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?f(e=>({...e,showResult:!1})):N(e=>({...e,showResult:!1}))},onMarkComplete:e=>{b(s=>({...s,reading:{...s.reading,[e]:100}}))}}),"profile"===i&&(0,a.jsx)(sN,{}),"achievements"===i&&(0,a.jsx)(sv,{}),"announcements"===i&&(0,a.jsx)(v,{isModal:!1,onClose:()=>o("dashboard")})]})}),w&&(0,a.jsx)(v,{isModal:!0,onClose:()=>A(!1)}),e&&(0,a.jsx)(sC,{})]}):(0,a.jsx)(m,{})}}},e=>{var s=s=>e(e.s=s);e.O(0,[997,465,441,684,358],()=>s(4409)),_N_E=e.O()}]);